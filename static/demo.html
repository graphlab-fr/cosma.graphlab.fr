<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="generator" content="https://cosma.graphlab.fr/">
    
    <meta name="title" content="Démo de Cosma">
    
    <meta name="author" content="Arthur Perret">
    
    <meta name="keywords" content="">
    
    <meta name="description" content="Cosma est un logiciel de visualisation et de partage pour les travailleurs de la connaissance. À partir d’un répertoire de fichiers rédigés en Markdown, Cosma génère une collection de fiches au format HTML, rassemblées dans un fichier unique : le cosmoscope. Ce cosmoscope de démonstration a été exporté avec Cosma. La documentation complète est en ligne : https://cosma.graphlab.fr/docs/">
    
    <meta name="date" content="2021-09-03">
    <title>Cosma — Cosmoscope</title>

    <style>
        @charset "UTF-8";

/** Global
------------------------------------------------------------*/

:root {
	/* colors */
	--cosma-blue: #147899;
	--cosma-blue-dark: #02385c;
	--border-color: #d8d8d8;
	--border-light-color: #f3f3f3;
	--indicator-background-color: #fafafa;
	--lateral-background-color: white;
	/* typography */
	--sans: sans-serif;
	--serif: "Georgia", serif;
	--mono: "IBM Plex Mono", "Consolas", "Monaco", monospace;
	--condensed: "Avenir Next Condensed", 'Arial Condensed', sans-serif;
	/* global size */
	font-size: 62.5%;
	/* others */
	--shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
  --offblack: rgb(51, 51, 51);
  --offwhite: rgb(253, 252, 251);
  --gray: #d6d6d6;
  --background-gray: rgb(246, 246, 246);
}

* { box-sizing: border-box; }

/** Page
------------------------------------------------------------*/

body {
	overflow: hidden;
	width: 100%;
	margin: 0;
	padding: 0;
	font-family: var(--sans);
	font-size: 1.4rem;
}

/* ---
- Containers
--- */

article { padding: 0.8rem 0; }
article + article:not(.record) {
	border-top: 1px solid var(--border-light-color);
}

/** Elements
------------------------------------------------------------*/

/* ---
- Buttons
--- */

button {
	cursor: pointer;
	margin: 0.5rem 0.2rem;
	font-size: 1.3rem;
}

.btn {
	background-color: white;
	border: 1px solid var(--border-color);
	border-radius: 2px;
}
.btn.active, .btn[data-active="true"] { border: 1px solid black; }

[onclick] { cursor: pointer; }

/* ---
- Lists
--- */

details {
	padding: 0.5rem 0 1rem 0;
}

details[data-sort] .sort-box:not(.active) {
	display: none;
}

details>summary {
	cursor: pointer;
	text-transform: uppercase;
	font-size: 1.3rem;
	margin: 1rem 0 0.5rem 0;
	font-weight: bold;
	outline: none;
}

summary + button { margin: 1rem 0; }

.list-content-container ul {
	list-style: none;
	margin: 0;
	padding: 0;
}

.list-content-container ul li {
	display: flex;
    align-items: baseline;
	padding: 0.3rem 0 0.3rem 1rem;
}

.list-content-container .menu-controls-list {
	margin-top: 1.3rem;
}

.list-content-container ul li span:last-of-type:not(.badge) {
	line-height: 1.5;
}

.record-type-point { /* colored dot before links */
	font-size: 0.8em;
	padding-right: 0.8em;
}

.menu-controls-container p:first-child {
	font-weight: bold;
}

/* ---
- Inputs
--- */

.outline {
	outline: var(--cosma-blue) solid 1px;
}

label {
	cursor: pointer;
}

input { font-size: 1.3rem; }

input[type="checkbox"] {
	cursor: pointer;
	width: 1.2rem;
	height: 1.2rem;
	margin: 0 0.8rem 0 0;
}

input[type="range"] {
	cursor: pointer;
	width: 100%;
	margin-top: 0.3rem;
}

/* ---
- Texts
--- */

a { color: inherit; }

code { font-family: var(--mono); }

/* ---
- Tips
--- */

.badge {
	display: inline-block;
	background-color: var(--indicator-background-color);
	border: 1px solid var(--gray);
	border-radius: 1px;
	padding: 0 0.3rem;
	font-size: 1rem;
	margin-left: 0.2rem;
	text-align: center;
	line-height: 1.5rem;
	white-space: nowrap;
	font-family: var(--mono);
	color: black;
}

.tooltip {
	cursor: pointer;
    position: relative;
    display: inline-block;
    background-color: var(--cosma-blue);
    border-radius: 50%;
    color: white;
    width: 16px;
    text-align: center;
    height: 16px;
	font-weight: normal;
}

.tooltip .tooltiptext {
	visibility: hidden;
	width: 120px;
	line-height: 130%;
	background-color: var(--cosma-blue-dark);
	box-shadow: var(--shadow);
	text-align: center;
	padding: 5px;
	border-radius: 2px;
	position: absolute;
	z-index: 1;
	width: 160px;
	bottom: 130%;
	left: 50%;
	margin-left: -80px;
}

.tooltip:hover .tooltiptext { visibility: visible; }

/** Menu (left side board)
------------------------------------------------------------*/

aside.menu {
	position: relative;
	z-index: 100;
	overflow: auto;
	height: 100vh;
	width: 30rem;
	margin: 0;
	padding: 0 20px 50px 20px;
	background-color: var(--background-gray);
	color: var(--offblack);
	box-shadow: var(--shadow);
}

/* ---
- User title
--- */

.title {
	text-transform: uppercase;
	font-size: 1.8rem;
	color: var(--cosma-blue-dark);
	text-align: center;
}

/* ---
- Toolbar
--- */

#menu-electron {
	display: flex;
	flex-direction: row;
	justify-content: space-evenly;
	align-items: center;
	margin-top: 1.5rem;
}

#menu-electron button {
	padding: 0;
	margin: 0;
	background-color: transparent;
	border: none;
}

#menu-electron button + button {
	margin-left: 7px;
}

#menu-electron button svg {
	height: 25px;
	width: auto;
}

#menu-electron button.icon-chevron svg {
	height: 18px;
}

/* ---
- Spatialization load bar
--- */

.load-bar {
	height: .3em;
	padding: 0.1rem;
	display: flex;
	margin: 1rem 0;
	background-color: var(--indicator-background-color);
}
.load-bar #load-bar-value {
	background-color: var(--cosma-blue);
	flex-basis: 100%
}

/* ---
- Search input & list
--- */

.search-bar { width: 100%; margin: 0.8rem 0; }

#search-result-list { margin-bottom: 0.8rem; }
#search-result-list li { cursor: pointer; }

/* ---
- Controls from graph params
--- */

.menu-controls input[type="number"] {
	width: 7rem;
	margin-left: 1rem;
}

.menu-controls-title { font-weight: bold; }

/* ---
- Footer
--- */

aside.menu footer {
	position: fixed;
	bottom: 0px;
	left: 0px;
	width: inherit;
	margin-top: 1.8rem;
	background-color: inherit;
	padding: 0.8rem 0 0.8rem 0.8rem;
	text-transform: uppercase;
	border-top: solid 1px var(--border-color);
	font-size: 1.1rem;
	text-align: center;
}

aside.menu footer span:not(:first-of-type)::before {
	content: '—';
}

/** Record container (right side board)
------------------------------------------------------------*/

main.record-container {
	position: absolute;
	z-index: 100;
	top: 0;
	right: 0;
	padding: 1rem 2rem;
	width: 50rem;
	height: 100vh;
	overflow: auto;
	background-color: var(--offwhite);
	color: var(--offblack);
	box-shadow: var(--shadow);
	transition: transform .6s;
	transition-timing-function: cubic-bezier(.02,1.18,0,.98);
}

main.record-container:not(.active) {
	/* hide on right when class 'active' removed */
	transform: translate(100%);
}

.record:not(.active) { display: none; }

/* ---
- Record header
--- */

.record header {
	padding-bottom: 1.5rem;
	margin-bottom: 3rem;
	border-bottom: 1px solid var(--gray);
}

.record header div + div,
.record-focus-container {
	margin-top: 0.8rem;
}

.record header div span:first-of-type, 
.record-focus-container > span {
	font-size: 1.3rem;
	font-weight: bold;
	text-transform: uppercase;
	margin-right: 0.8rem;
}

.record-last-edit { display: none; }

.record-focus-lever { display: none; }

.record-focus-lever input { width: 80%; }

/* ---
- Record content
--- */

/* From Typesafe.css, by Bradley Taunt */

.record main {
	font-size: 1.6rem;
	line-height: 1.5;
	font-family: var(--serif);
}

.record main h1,h2,h3,h4,h5,h6 {
	font-family: var(--sans);
	margin: 3rem 0 0 0;
}
.record main h1 { font-size: 1.8rem; }
.record main h2 { font-size: 1.6rem; }
.record main h3 { font-size: 1.4rem; }

.record main a { word-wrap: break-word; }
.record main a.record-link { color: #337ab7; }

.record main ul, .record main ol {
	padding: 0;
	list-style-position: inside;
}
.record main ul ul, .record main ol ol { padding-left: 2rem; }
.record main ul li, .record ol li { margin: 0.5rem 0 0 0; }

.record main img {
	height: auto;
	max-width: 100%;
}

.record main pre {
	overflow: auto;
	font-size: 90%;
}

.record main blockquote {
	border-left: 5px solid var(--border-color);
	margin: 0;
	padding-left: 1rem;
}

.record main table{
	border-collapse: collapse;
	margin: 2rem 0;
	text-align: left;
	width: 100%;
}
.record main tr { border-bottom: 1px solid var(--border-color); }
.record main th, .record main td { padding: 0.5rem; }

.record main hr {
	background: var(--border-color);
	border: 0;
	height: 1px;
	margin: 2rem 0;
}

/* ---
- Record bibliography
--- */

.record .bibliography div + div {
	margin-top: 1rem;
}

.record div.csl-entry {
	width: inherit;
	text-indent: -2rem;
	padding-left: 2rem;
	margin: 0.75rem 0 0 0;
	line-height: 1.3;
	overflow-wrap: break-word;
	word-wrap: break-word;
	-ms-word-break: break-all;
	word-break: break-word;
}

/* ---
- Record footer
--- */

.record footer {
	margin-top: 3rem;
	border-top: 1px solid var(--gray);
}

.record footer li {
	/* links & backlinks */
	position: relative;
}

.record footer li .record-links-context {
	display: none;
	background: white;
	border: 1px black solid;
	padding: 0.8rem;
	border-radius: 2px;
	margin-top: 0.8rem;
	position: absolute;
	bottom: calc(100% + 10px);
	box-shadow: var(--shadow);
	text-indent: 0;
}

.record footer li .record-links-context li {
	display: block;
}

.record footer li:hover .record-links-context {
	display: block;
}

.record footer li .record-links-context li::before {
	content: '-';
	position: relative;
	left: -5px;
}

.record footer li .record-links-context p, .record footer li .record-links-context blockquote {
	margin: 0px;
}

.record footer li .record-links-context p + p {
	margin-top: 0.8rem;
}

/** Graph
------------------------------------------------------------*/

.graph-wrapper {
	position: absolute;
	top: 0;
	right: 0;
	height: 100vh;
	width: calc(100vw - 30rem);
}

#graph-canvas {
	cursor: move;
	width: 100%;
	height: 100%;
}

/* ---
- Graph elements
--- */

/* nodes */
circle, text { cursor: pointer; }
g.highlight circle, g.focus circle, g.hover circle {
	stroke: var(--highlight);
}
g.focus circle { stroke-width: 3 }
g.translucent circle { opacity: 0.5; }
/* links */
line.highlight, line.hover { stroke: var(--highlight); }
line.translucent { stroke-opacity: 0.2; }
/* labels */
text {
	font-family: var(--condensed);
	fill: gray;
}
text.highlight { fill: var(--highlight); }
g.highlight text, g.hover text {
	fill: black;
}
/* arrows */
marker {
	/* set into config.yml file by 'undefined' link type */
	stroke:var(--l_undefined);
	fill:var(--l_undefined);
}

.l_undefined { fill: var(--border-light-color); stroke: var(--border-light-color); }
.n_undefined { fill: var(--border-light-color); stroke: var(--border-light-color); }

/* ---
- Buttons
--- */

.graph-controls {
	position: absolute;
	display: flex;
	align-items: flex-start;
	flex-direction: column;
	left: 30px;
	bottom: 15px;
	flex-wrap: wrap;
	width: 20rem;
}

.graph-controls::before {
	content: '';
	position: absolute;
	backdrop-filter: blur(7px);
	width: 100%;
	height: 100%;
	border-radius: 5px;
}

.graph-controls button { margin: 2px, 0; }

.graph-controls div { position: relative; }

.graph-controls div.graph-controls-zoom {
	display: flex;
	justify-content: space-between;
	position: relative;
}

.graph-controls-focus {
	display: flex;
	justify-content: flex-start;
	flex-flow: row wrap;
}

.graph-controls-focus label {
	display: inline-block;
	margin: .8rem 0 0.8rem 0.4rem;
}

.graph-controls-focus input[type="range"]:not(.active) {
	visibility: hidden;
}

.graph-controls #reset-isolate { display: none; }
.graph-controls #reset-highlight { display: none; }


/** Credits
------------------------------------------------------------*/

article#credits {
	text-align: center;
}

article#credits ul {
	list-style-type: none;
	margin: 0;
	padding: 0;
}

article#credits dt {
	font-weight: bold;
}

article#credits dd, article#credits li {
	margin: 0;
	padding: 0 0 0.5rem 0;
}

article#credits h1.metas-title {
	font-size: 2rem;
}

/* ---
- Logo
--- */

.logo { cursor: pointer; }
.logo svg {
	display: block;
	margin: 0 auto;
	max-width: 300px;
}

@keyframes rotate-center {
	0% { transform: rotate(0deg); }
	50% { transform: rotate(270deg); }
	100% { transform: rotate(360deg); }
}

#cosma-roll {transform-origin : 96px 42px;}
#cosma-roll.anim {animation: 3s cubic-bezier(0.2, -0.20, 0.8, 1) 1 rotate-center;}

/** Help
------------------------------------------------------------*/

#help td:first-child {
	font-weight: bold;
	text-align: right;
}

#help td {
	vertical-align: top;
}

#help tr {
	border-top: 1px solid var(--border-color);
	border-bottom: 1px solid var(--border-color);
}

/** Bibliography references
------------------------------------------------------------*/

#citation-references button {
	margin-bottom: 2rem;
}

#citation-references code {
	display: block;
	word-wrap: break-word;
	font-size: 1.2rem;
	max-height: 75vh;
	overflow: scroll;
	border-top: 1px solid var(--border-color);
	border-bottom: 1px solid var(--border-color);
}



        
:root {
--n_undefined: #858585;
--n_documentation: #147899;
--n_important: #aa0000;
--l_undefined: #e1e1e1;
--highlight: #ff6a6a;
}

.n_undefined {color:var(--n_undefined); fill:var(--n_undefined); stroke:var(--n_undefined);}
.n_documentation {color:var(--n_documentation); fill:var(--n_documentation); stroke:var(--n_documentation);}
.n_important {color:var(--n_important); fill:var(--n_important); stroke:var(--n_important);}
.l_undefined {color:var(--l_undefined); fill:var(--l_undefined); stroke:var(--l_undefined);}
        @media print {

	/* ---
	- Global
	--- */

	:root {
		font-size: 52.5%;
	}

	@page {
		margin: 10mm 20mm;  
	}

	body {
		overflow: unset;
	}

	/* ---
	- Elements
	--- */

	p, tr, li {
		orphans: 3;
	}

	a[href]:not([onclick]):after {
		content: " (" attr(href) ")";
	}

	/* ---
	- Page containers
	--- */

    aside,
	.graph-wrapper {
		display: none;
	}

	/* ---
	- Record header
	--- */

	.record header {
		margin-bottom: 10mm;
	}

	.record-focus-container,
	.record-btn-close {
		display: none;
	}

	.record-last-edit {
		display: inline-block;
	}

	/* ---
	- Record main
	--- */

	main.record-container {
		position: unset;
		width: 100%;
		overflow: unset;
		box-shadow: unset;
	}

	/* ---
	- Record footer
	--- */

	main.record-container footer {
		break-before: page;
	}

	main.record-container footer .record-links-context {
		display: block;
		position: unset;
		box-shadow: unset;
	}

	main.record-container footer li {
		display: block;
		margin-top: 2mm;
	}

	mark {
		text-decoration: underline;
	}
}

        
    </style>

    

    <script>
        // https://d3js.org Version 4.13.0. Copyright 2018 Mike Bostock.
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})}(this,function(t){"use strict";function n(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function e(t){var e;return 1===t.length&&(e=t,t=function(t,r){return n(e(t),r)}),{left:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)<0?r=o+1:i=o}return r},right:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)>0?i=o:r=o+1}return r}}}var r=e(n),i=r.right,o=r.left;function u(t,n){return[t,n]}function a(t){return null===t?NaN:+t}function c(t,n){var e,r,i=t.length,o=0,u=-1,c=0,s=0;if(null==n)for(;++u<i;)isNaN(e=a(t[u]))||(s+=(r=e-c)*(e-(c+=r/++o)));else for(;++u<i;)isNaN(e=a(n(t[u],u,t)))||(s+=(r=e-c)*(e-(c+=r/++o)));if(o>1)return s/(o-1)}function s(t,n){var e=c(t,n);return e?Math.sqrt(e):e}function f(t,n){var e,r,i,o=t.length,u=-1;if(null==n){for(;++u<o;)if(null!=(e=t[u])&&e>=e)for(r=i=e;++u<o;)null!=(e=t[u])&&(r>e&&(r=e),i<e&&(i=e))}else for(;++u<o;)if(null!=(e=n(t[u],u,t))&&e>=e)for(r=i=e;++u<o;)null!=(e=n(t[u],u,t))&&(r>e&&(r=e),i<e&&(i=e));return[r,i]}var l=Array.prototype,h=l.slice,p=l.map;function d(t){return function(){return t}}function v(t){return t}function g(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(i);++r<i;)o[r]=t+r*e;return o}var _=Math.sqrt(50),y=Math.sqrt(10),m=Math.sqrt(2);function x(t,n,e){var r,i,o,u,a=-1;if(e=+e,(t=+t)===(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(u=b(t,n,e))||!isFinite(u))return[];if(u>0)for(t=Math.ceil(t/u),n=Math.floor(n/u),o=new Array(i=Math.ceil(n-t+1));++a<i;)o[a]=(t+a)*u;else for(t=Math.floor(t*u),n=Math.ceil(n*u),o=new Array(i=Math.ceil(t-n+1));++a<i;)o[a]=(t-a)/u;return r&&o.reverse(),o}function b(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=_?10:o>=y?5:o>=m?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=_?10:o>=y?5:o>=m?2:1)}function w(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=_?i*=10:o>=y?i*=5:o>=m&&(i*=2),n<t?-i:i}function M(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function T(t,n,e){if(null==e&&(e=a),r=t.length){if((n=+n)<=0||r<2)return+e(t[0],0,t);if(n>=1)return+e(t[r-1],r-1,t);var r,i=(r-1)*n,o=Math.floor(i),u=+e(t[o],o,t);return u+(+e(t[o+1],o+1,t)-u)*(i-o)}}function N(t){for(var n,e,r,i=t.length,o=-1,u=0;++o<i;)u+=t[o].length;for(e=new Array(u);--i>=0;)for(n=(r=t[i]).length;--n>=0;)e[--u]=r[n];return e}function k(t,n){var e,r,i=t.length,o=-1;if(null==n){for(;++o<i;)if(null!=(e=t[o])&&e>=e)for(r=e;++o<i;)null!=(e=t[o])&&r>e&&(r=e)}else for(;++o<i;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=e;++o<i;)null!=(e=n(t[o],o,t))&&r>e&&(r=e);return r}function S(t){if(!(i=t.length))return[];for(var n=-1,e=k(t,E),r=new Array(e);++n<e;)for(var i,o=-1,u=r[n]=new Array(i);++o<i;)u[o]=t[o][n];return r}function E(t){return t.length}var A=Array.prototype.slice;function C(t){return t}var z=1,P=2,R=3,L=4,q=1e-6;function D(t){return"translate("+(t+.5)+",0)"}function U(t){return"translate(0,"+(t+.5)+")"}function O(){return!this.__axis}function F(t,n){var e=[],r=null,i=null,o=6,u=6,a=3,c=t===z||t===L?-1:1,s=t===L||t===P?"x":"y",f=t===z||t===R?D:U;function l(l){var h=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,p=null==i?n.tickFormat?n.tickFormat.apply(n,e):C:i,d=Math.max(o,0)+a,v=n.range(),g=+v[0]+.5,_=+v[v.length-1]+.5,y=(n.bandwidth?function(t){var n=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}:function(t){return function(n){return+t(n)}})(n.copy()),m=l.selection?l.selection():l,x=m.selectAll(".domain").data([null]),b=m.selectAll(".tick").data(h,n).order(),w=b.exit(),M=b.enter().append("g").attr("class","tick"),T=b.select("line"),N=b.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),b=b.merge(M),T=T.merge(M.append("line").attr("stroke","#000").attr(s+"2",c*o)),N=N.merge(M.append("text").attr("fill","#000").attr(s,c*d).attr("dy",t===z?"0em":t===R?"0.71em":"0.32em")),l!==m&&(x=x.transition(l),b=b.transition(l),T=T.transition(l),N=N.transition(l),w=w.transition(l).attr("opacity",q).attr("transform",function(t){return isFinite(t=y(t))?f(t):this.getAttribute("transform")}),M.attr("opacity",q).attr("transform",function(t){var n=this.parentNode.__axis;return f(n&&isFinite(n=n(t))?n:y(t))})),w.remove(),x.attr("d",t===L||t==P?"M"+c*u+","+g+"H0.5V"+_+"H"+c*u:"M"+g+","+c*u+"V0.5H"+_+"V"+c*u),b.attr("opacity",1).attr("transform",function(t){return f(y(t))}),T.attr(s+"2",c*o),N.attr(s,c*d).text(p),m.filter(O).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===P?"start":t===L?"end":"middle"),m.each(function(){this.__axis=y})}return l.scale=function(t){return arguments.length?(n=t,l):n},l.ticks=function(){return e=A.call(arguments),l},l.tickArguments=function(t){return arguments.length?(e=null==t?[]:A.call(t),l):e.slice()},l.tickValues=function(t){return arguments.length?(r=null==t?null:A.call(t),l):r&&r.slice()},l.tickFormat=function(t){return arguments.length?(i=t,l):i},l.tickSize=function(t){return arguments.length?(o=u=+t,l):o},l.tickSizeInner=function(t){return arguments.length?(o=+t,l):o},l.tickSizeOuter=function(t){return arguments.length?(u=+t,l):u},l.tickPadding=function(t){return arguments.length?(a=+t,l):a},l}var I={value:function(){}};function Y(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new B(r)}function B(t){this._=t}function H(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function j(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=I,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}B.prototype=Y.prototype={constructor:B,on:function(t,n){var e,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");if(e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})),u=-1,a=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++u<a;)if(e=(t=o[u]).type)i[e]=j(i[e],t.name,n);else if(null==n)for(e in i)i[e]=j(i[e],t.name,null);return this}for(;++u<a;)if((e=(t=o[u]).type)&&(e=H(i[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new B(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};var X="http://www.w3.org/1999/xhtml",V={svg:"http://www.w3.org/2000/svg",xhtml:X,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),V.hasOwnProperty(n)?{space:V[n],local:t}:t}function W(t){var n=$(t);return(n.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===X&&n.documentElement.namespaceURI===X?n.createElement(t):n.createElementNS(e,t)}})(n)}function Z(){}function G(t){return null==t?Z:function(){return this.querySelector(t)}}function Q(){return[]}function J(t){return null==t?Q:function(){return this.querySelectorAll(t)}}var K=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var tt=document.documentElement;if(!tt.matches){var nt=tt.webkitMatchesSelector||tt.msMatchesSelector||tt.mozMatchesSelector||tt.oMatchesSelector;K=function(t){return function(){return nt.call(this,t)}}}}var et=K;function rt(t){return new Array(t.length)}function it(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}it.prototype={constructor:it,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var ot="$";function ut(t,n,e,r,i,o){for(var u,a=0,c=n.length,s=o.length;a<s;++a)(u=n[a])?(u.__data__=o[a],r[a]=u):e[a]=new it(t,o[a]);for(;a<c;++a)(u=n[a])&&(i[a]=u)}function at(t,n,e,r,i,o,u){var a,c,s,f={},l=n.length,h=o.length,p=new Array(l);for(a=0;a<l;++a)(c=n[a])&&(p[a]=s=ot+u.call(c,c.__data__,a,n),s in f?i[a]=c:f[s]=c);for(a=0;a<h;++a)(c=f[s=ot+u.call(t,o[a],a,o)])?(r[a]=c,c.__data__=o[a],f[s]=null):e[a]=new it(t,o[a]);for(a=0;a<l;++a)(c=n[a])&&f[p[a]]===c&&(i[a]=c)}function ct(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function st(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ft(t,n){return t.style.getPropertyValue(n)||st(t).getComputedStyle(t,null).getPropertyValue(n)}function lt(t){return t.trim().split(/^|\s+/)}function ht(t){return t.classList||new pt(t)}function pt(t){this._node=t,this._names=lt(t.getAttribute("class")||"")}function dt(t,n){for(var e=ht(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function vt(t,n){for(var e=ht(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function gt(){this.textContent=""}function _t(){this.innerHTML=""}function yt(){this.nextSibling&&this.parentNode.appendChild(this)}function mt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function xt(){return null}function bt(){var t=this.parentNode;t&&t.removeChild(this)}function wt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Mt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}pt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Tt={};(t.event=null,"undefined"!=typeof document)&&("onmouseenter"in document.documentElement||(Tt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Nt(t,n,e){return t=kt(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function kt(n,e,r){return function(i){var o=t.event;t.event=i;try{n.call(this,this.__data__,e,r)}finally{t.event=o}}}function St(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function Et(t,n,e){var r=Tt.hasOwnProperty(t.type)?Nt:kt;return function(i,o,u){var a,c=this.__on,s=r(n,o,u);if(c)for(var f=0,l=c.length;f<l;++f)if((a=c[f]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=s,a.capture=e),void(a.value=n);this.addEventListener(t.type,s,e),a={type:t.type,name:t.name,value:n,listener:s,capture:e},c?c.push(a):this.__on=[a]}}function At(n,e,r,i){var o=t.event;n.sourceEvent=t.event,t.event=n;try{return e.apply(r,i)}finally{t.event=o}}function Ct(t,n,e){var r=st(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}var zt=[null];function Pt(t,n){this._groups=t,this._parents=n}function Rt(){return new Pt([[document.documentElement]],zt)}function Lt(t){return"string"==typeof t?new Pt([[document.querySelector(t)]],[document.documentElement]):new Pt([[t]],zt)}Pt.prototype=Rt.prototype={constructor:Pt,select:function(t){"function"!=typeof t&&(t=G(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u,a=n[i],c=a.length,s=r[i]=new Array(c),f=0;f<c;++f)(o=a[f])&&(u=t.call(o,o.__data__,f,a))&&("__data__"in o&&(u.__data__=o.__data__),s[f]=u);return new Pt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=J(t));for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var u,a=n[o],c=a.length,s=0;s<c;++s)(u=a[s])&&(r.push(t.call(u,u.__data__,s,a)),i.push(u));return new Pt(r,i)},filter:function(t){"function"!=typeof t&&(t=et(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u=n[i],a=u.length,c=r[i]=[],s=0;s<a;++s)(o=u[s])&&t.call(o,o.__data__,s,u)&&c.push(o);return new Pt(r,this._parents)},data:function(t,n){if(!t)return d=new Array(this.size()),f=-1,this.each(function(t){d[++f]=t}),d;var e,r=n?at:ut,i=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var u=o.length,a=new Array(u),c=new Array(u),s=new Array(u),f=0;f<u;++f){var l=i[f],h=o[f],p=h.length,d=t.call(l,l&&l.__data__,f,i),v=d.length,g=c[f]=new Array(v),_=a[f]=new Array(v);r(l,h,g,_,s[f]=new Array(p),d,n);for(var y,m,x=0,b=0;x<v;++x)if(y=g[x]){for(x>=b&&(b=x+1);!(m=_[b])&&++b<v;);y._next=m||null}}return(a=new Pt(a,i))._enter=c,a._exit=s,a},enter:function(){return new Pt(this._enter||this._groups.map(rt),this._parents)},exit:function(){return new Pt(this._exit||this._groups.map(rt),this._parents)},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),u=new Array(r),a=0;a<o;++a)for(var c,s=n[a],f=e[a],l=s.length,h=u[a]=new Array(l),p=0;p<l;++p)(c=s[p]||f[p])&&(h[p]=c);for(;a<r;++a)u[a]=n[a];return new Pt(u,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,u=i[o];--o>=0;)(r=i[o])&&(u&&u!==r.nextSibling&&u.parentNode.insertBefore(r,u),u=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=ct);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var u,a=e[o],c=a.length,s=i[o]=new Array(c),f=0;f<c;++f)(u=a[f])&&(s[f]=u);s.sort(n)}return new Pt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each(function(){t[++n]=this}),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var u=r[i];if(u)return u}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],u=0,a=o.length;u<a;++u)(i=o[u])&&t.call(i,i.__data__,u,o);return this},attr:function(t,n){var e=$(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof n?e.local?function(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}:function(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}:e.local?function(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}:function(t,n){return function(){this.setAttribute(t,n)}})(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof n?function(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}:function(t,n,e){return function(){this.style.setProperty(t,n,e)}})(t,n,null==e?"":e)):ft(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?function(t){return function(){delete this[t]}}:"function"==typeof n?function(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}:function(t,n){return function(){this[t]=n}})(t,n)):this.node()[t]},classed:function(t,n){var e=lt(t+"");if(arguments.length<2){for(var r=ht(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?function(t,n){return function(){(n.apply(this,arguments)?dt:vt)(this,t)}}:n?function(t){return function(){dt(this,t)}}:function(t){return function(){vt(this,t)}})(e,n))},text:function(t){return arguments.length?this.each(null==t?gt:("function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?_t:("function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(yt)},lower:function(){return this.each(mt)},append:function(t){var n="function"==typeof t?t:W(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(t,n){var e="function"==typeof t?t:W(t),r=null==n?xt:"function"==typeof n?n:G(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(bt)},clone:function(t){return this.select(t?Mt:wt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}})}(t+""),u=o.length;if(!(arguments.length<2)){for(a=n?Et:St,null==e&&(e=!1),r=0;r<u;++r)this.each(a(o[r],n,e));return this}var a=this.node().__on;if(a)for(var c,s=0,f=a.length;s<f;++s)for(r=0,c=a[s];r<u;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,n){return this.each(("function"==typeof n?function(t,n){return function(){return Ct(this,t,n.apply(this,arguments))}}:function(t,n){return function(){return Ct(this,t,n)}})(t,n))}};var qt=0;function Dt(){return new Ut}function Ut(){this._="@"+(++qt).toString(36)}function Ot(){for(var n,e=t.event;n=e.sourceEvent;)e=n;return e}function Ft(t,n){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop]}function It(t){var n=Ot();return n.changedTouches&&(n=n.changedTouches[0]),Ft(t,n)}function Yt(t,n,e){arguments.length<3&&(e=n,n=Ot().changedTouches);for(var r,i=0,o=n?n.length:0;i<o;++i)if((r=n[i]).identifier===e)return Ft(t,r);return null}function Bt(){t.event.stopImmediatePropagation()}function Ht(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function jt(t){var n=t.document.documentElement,e=Lt(t).on("dragstart.drag",Ht,!0);"onselectstart"in n?e.on("selectstart.drag",Ht,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Xt(t,n){var e=t.document.documentElement,r=Lt(t).on("dragstart.drag",null);n&&(r.on("click.drag",Ht,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function Vt(t){return function(){return t}}function $t(t,n,e,r,i,o,u,a,c,s){this.target=t,this.type=n,this.subject=e,this.identifier=r,this.active=i,this.x=o,this.y=u,this.dx=a,this.dy=c,this._=s}function Wt(){return!t.event.button}function Zt(){return this.parentNode}function Gt(n){return null==n?{x:t.event.x,y:t.event.y}:n}function Qt(){return"ontouchstart"in this}function Jt(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Kt(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function tn(){}Ut.prototype=Dt.prototype={constructor:Ut,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}},$t.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var nn="\\s*([+-]?\\d+)\\s*",en="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",rn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",on=/^#([0-9a-f]{3})$/,un=/^#([0-9a-f]{6})$/,an=new RegExp("^rgb\\("+[nn,nn,nn]+"\\)$"),cn=new RegExp("^rgb\\("+[rn,rn,rn]+"\\)$"),sn=new RegExp("^rgba\\("+[nn,nn,nn,en]+"\\)$"),fn=new RegExp("^rgba\\("+[rn,rn,rn,en]+"\\)$"),ln=new RegExp("^hsl\\("+[en,rn,rn]+"\\)$"),hn=new RegExp("^hsla\\("+[en,rn,rn,en]+"\\)$"),pn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function dn(t){var n;return t=(t+"").trim().toLowerCase(),(n=on.exec(t))?new mn((n=parseInt(n[1],16))>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):(n=un.exec(t))?vn(parseInt(n[1],16)):(n=an.exec(t))?new mn(n[1],n[2],n[3],1):(n=cn.exec(t))?new mn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=sn.exec(t))?gn(n[1],n[2],n[3],n[4]):(n=fn.exec(t))?gn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=ln.exec(t))?xn(n[1],n[2]/100,n[3]/100,1):(n=hn.exec(t))?xn(n[1],n[2]/100,n[3]/100,n[4]):pn.hasOwnProperty(t)?vn(pn[t]):"transparent"===t?new mn(NaN,NaN,NaN,0):null}function vn(t){return new mn(t>>16&255,t>>8&255,255&t,1)}function gn(t,n,e,r){return r<=0&&(t=n=e=NaN),new mn(t,n,e,r)}function _n(t){return t instanceof tn||(t=dn(t)),t?new mn((t=t.rgb()).r,t.g,t.b,t.opacity):new mn}function yn(t,n,e,r){return 1===arguments.length?_n(t):new mn(t,n,e,null==r?1:r)}function mn(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function xn(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new wn(t,n,e,r)}function bn(t,n,e,r){return 1===arguments.length?function(t){if(t instanceof wn)return new wn(t.h,t.s,t.l,t.opacity);if(t instanceof tn||(t=dn(t)),!t)return new wn;if(t instanceof wn)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),u=NaN,a=o-i,c=(o+i)/2;return a?(u=n===o?(e-r)/a+6*(e<r):e===o?(r-n)/a+2:(n-e)/a+4,a/=c<.5?o+i:2-o-i,u*=60):a=c>0&&c<1?0:u,new wn(u,a,c,t.opacity)}(t):new wn(t,n,e,null==r?1:r)}function wn(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Mn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}Jt(tn,dn,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),Jt(mn,yn,Kt(tn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new mn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new mn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Jt(wn,bn,Kt(tn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new wn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new wn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new mn(Mn(t>=240?t-240:t+120,i,r),Mn(t,i,r),Mn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Tn=Math.PI/180,Nn=180/Math.PI,kn=.95047,Sn=1,En=1.08883,An=4/29,Cn=6/29,zn=3*Cn*Cn,Pn=Cn*Cn*Cn;function Rn(t){if(t instanceof qn)return new qn(t.l,t.a,t.b,t.opacity);if(t instanceof Yn){var n=t.h*Tn;return new qn(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}t instanceof mn||(t=_n(t));var e=Fn(t.r),r=Fn(t.g),i=Fn(t.b),o=Dn((.4124564*e+.3575761*r+.1804375*i)/kn),u=Dn((.2126729*e+.7151522*r+.072175*i)/Sn);return new qn(116*u-16,500*(o-u),200*(u-Dn((.0193339*e+.119192*r+.9503041*i)/En)),t.opacity)}function Ln(t,n,e,r){return 1===arguments.length?Rn(t):new qn(t,n,e,null==r?1:r)}function qn(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function Dn(t){return t>Pn?Math.pow(t,1/3):t/zn+An}function Un(t){return t>Cn?t*t*t:zn*(t-An)}function On(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function In(t,n,e,r){return 1===arguments.length?function(t){if(t instanceof Yn)return new Yn(t.h,t.c,t.l,t.opacity);t instanceof qn||(t=Rn(t));var n=Math.atan2(t.b,t.a)*Nn;return new Yn(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Yn(t,n,e,null==r?1:r)}function Yn(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}Jt(qn,Ln,Kt(tn,{brighter:function(t){return new qn(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new qn(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return t=Sn*Un(t),new mn(On(3.2404542*(n=kn*Un(n))-1.5371385*t-.4985314*(e=En*Un(e))),On(-.969266*n+1.8760108*t+.041556*e),On(.0556434*n-.2040259*t+1.0572252*e),this.opacity)}})),Jt(Yn,In,Kt(tn,{brighter:function(t){return new Yn(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Yn(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Rn(this).rgb()}}));var Bn=-.14861,Hn=1.78277,jn=-.29227,Xn=-.90649,Vn=1.97294,$n=Vn*Xn,Wn=Vn*Hn,Zn=Hn*jn-Xn*Bn;function Gn(t,n,e,r){return 1===arguments.length?function(t){if(t instanceof Qn)return new Qn(t.h,t.s,t.l,t.opacity);t instanceof mn||(t=_n(t));var n=t.r/255,e=t.g/255,r=t.b/255,i=(Zn*r+$n*n-Wn*e)/(Zn+$n-Wn),o=r-i,u=(Vn*(e-i)-jn*o)/Xn,a=Math.sqrt(u*u+o*o)/(Vn*i*(1-i)),c=a?Math.atan2(u,o)*Nn-120:NaN;return new Qn(c<0?c+360:c,a,i,t.opacity)}(t):new Qn(t,n,e,null==r?1:r)}function Qn(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Jn(t,n,e,r,i){var o=t*t,u=o*t;return((1-3*t+3*o-u)*n+(4-6*o+3*u)*e+(1+3*t+3*o-3*u)*r+u*i)/6}function Kn(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],o=t[r+1],u=r>0?t[r-1]:2*i-o,a=r<n-1?t[r+2]:2*o-i;return Jn((e-r/n)*n,u,i,o,a)}}function te(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],o=t[r%n],u=t[(r+1)%n],a=t[(r+2)%n];return Jn((e-r/n)*n,i,o,u,a)}}function ne(t){return function(){return t}}function ee(t,n){return function(e){return t+e*n}}function re(t,n){var e=n-t;return e?ee(t,e>180||e<-180?e-360*Math.round(e/360):e):ne(isNaN(t)?n:t)}function ie(t){return 1==(t=+t)?oe:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):ne(isNaN(n)?e:n)}}function oe(t,n){var e=n-t;return e?ee(t,e):ne(isNaN(t)?n:t)}Jt(Qn,Gn,Kt(tn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Qn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Qn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Tn,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t),i=Math.sin(t);return new mn(255*(n+e*(Bn*r+Hn*i)),255*(n+e*(jn*r+Xn*i)),255*(n+e*(Vn*r)),this.opacity)}}));var ue=function t(n){var e=ie(n);function r(t,n){var r=e((t=yn(t)).r,(n=yn(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),u=oe(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=u(n),t+""}}return r.gamma=t,r}(1);function ae(t){return function(n){var e,r,i=n.length,o=new Array(i),u=new Array(i),a=new Array(i);for(e=0;e<i;++e)r=yn(n[e]),o[e]=r.r||0,u[e]=r.g||0,a[e]=r.b||0;return o=t(o),u=t(u),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=u(t),r.b=a(t),r+""}}}var ce=ae(Kn),se=ae(te);function fe(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),u=new Array(r);for(e=0;e<i;++e)o[e]=_e(t[e],n[e]);for(;e<r;++e)u[e]=n[e];return function(t){for(e=0;e<i;++e)u[e]=o[e](t);return u}}function le(t,n){var e=new Date;return n-=t=+t,function(r){return e.setTime(t+n*r),e}}function he(t,n){return n-=t=+t,function(e){return t+n*e}}function pe(t,n){var e,r={},i={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?r[e]=_e(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}var de=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ve=new RegExp(de.source,"g");function ge(t,n){var e,r,i,o=de.lastIndex=ve.lastIndex=0,u=-1,a=[],c=[];for(t+="",n+="";(e=de.exec(t))&&(r=ve.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),a[u]?a[u]+=i:a[++u]=i),(e=e[0])===(r=r[0])?a[u]?a[u]+=r:a[++u]=r:(a[++u]=null,c.push({i:u,x:he(e,r)})),o=ve.lastIndex;return o<n.length&&(i=n.slice(o),a[u]?a[u]+=i:a[++u]=i),a.length<2?c[0]?function(t){return function(n){return t(n)+""}}(c[0].x):function(t){return function(){return t}}(n):(n=c.length,function(t){for(var e,r=0;r<n;++r)a[(e=c[r]).i]=e.x(t);return a.join("")})}function _e(t,n){var e,r=typeof n;return null==n||"boolean"===r?ne(n):("number"===r?he:"string"===r?(e=dn(n))?(n=e,ue):ge:n instanceof dn?ue:n instanceof Date?le:Array.isArray(n)?fe:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?pe:he)(t,n)}function ye(t,n){return n-=t=+t,function(e){return Math.round(t+n*e)}}var me,xe,be,we,Me=180/Math.PI,Te={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ne(t,n,e,r,i,o){var u,a,c;return(u=Math.sqrt(t*t+n*n))&&(t/=u,n/=u),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(a=Math.sqrt(e*e+r*r))&&(e/=a,r/=a,c/=a),t*r<n*e&&(t=-t,n=-n,c=-c,u=-u),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*Me,skewX:Math.atan(c)*Me,scaleX:u,scaleY:a}}function ke(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,u){var a=[],c=[];return o=t(o),u=t(u),function(t,r,i,o,u,a){if(t!==i||r!==o){var c=u.push("translate(",null,n,null,e);a.push({i:c-4,x:he(t,i)},{i:c-2,x:he(r,o)})}else(i||o)&&u.push("translate("+i+n+o+e)}(o.translateX,o.translateY,u.translateX,u.translateY,a,c),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:he(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,u.rotate,a,c),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:he(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,u.skewX,a,c),function(t,n,e,r,o,u){if(t!==e||n!==r){var a=o.push(i(o)+"scale(",null,",",null,")");u.push({i:a-4,x:he(t,e)},{i:a-2,x:he(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,u.scaleX,u.scaleY,a,c),o=u=null,function(t){for(var n,e=-1,r=c.length;++e<r;)a[(n=c[e]).i]=n.x(t);return a.join("")}}}var Se=ke(function(t){return"none"===t?Te:(me||(me=document.createElement("DIV"),xe=document.documentElement,be=document.defaultView),me.style.transform=t,t=be.getComputedStyle(xe.appendChild(me),null).getPropertyValue("transform"),xe.removeChild(me),Ne(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),Ee=ke(function(t){return null==t?Te:(we||(we=document.createElementNS("http://www.w3.org/2000/svg","g")),we.setAttribute("transform",t),(t=we.transform.baseVal.consolidate())?Ne((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Te)},", ",")",")"),Ae=Math.SQRT2,Ce=2,ze=4,Pe=1e-12;function Re(t){return((t=Math.exp(t))+1/t)/2}function Le(t,n){var e,r,i=t[0],o=t[1],u=t[2],a=n[0],c=n[1],s=n[2],f=a-i,l=c-o,h=f*f+l*l;if(h<Pe)r=Math.log(s/u)/Ae,e=function(t){return[i+t*f,o+t*l,u*Math.exp(Ae*t*r)]};else{var p=Math.sqrt(h),d=(s*s-u*u+ze*h)/(2*u*Ce*p),v=(s*s-u*u-ze*h)/(2*s*Ce*p),g=Math.log(Math.sqrt(d*d+1)-d),_=Math.log(Math.sqrt(v*v+1)-v);r=(_-g)/Ae,e=function(t){var n,e=t*r,a=Re(g),c=u/(Ce*p)*(a*(n=Ae*e+g,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+c*f,o+c*l,u*a/Re(Ae*e+g)]}}return e.duration=1e3*r,e}function qe(t){return function(n,e){var r=t((n=bn(n)).h,(e=bn(e)).h),i=oe(n.s,e.s),o=oe(n.l,e.l),u=oe(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=o(t),n.opacity=u(t),n+""}}}var De=qe(re),Ue=qe(oe);function Oe(t){return function(n,e){var r=t((n=In(n)).h,(e=In(e)).h),i=oe(n.c,e.c),o=oe(n.l,e.l),u=oe(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=o(t),n.opacity=u(t),n+""}}}var Fe=Oe(re),Ie=Oe(oe);function Ye(t){return function n(e){function r(n,r){var i=t((n=Gn(n)).h,(r=Gn(r)).h),o=oe(n.s,r.s),u=oe(n.l,r.l),a=oe(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=o(t),n.l=u(Math.pow(t,e)),n.opacity=a(t),n+""}}return e=+e,r.gamma=n,r}(1)}var Be=Ye(re),He=Ye(oe);var je,Xe,Ve=0,$e=0,We=0,Ze=1e3,Ge=0,Qe=0,Je=0,Ke="object"==typeof performance&&performance.now?performance:Date,tr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function nr(){return Qe||(tr(er),Qe=Ke.now()+Je)}function er(){Qe=0}function rr(){this._call=this._time=this._next=null}function ir(t,n,e){var r=new rr;return r.restart(t,n,e),r}function or(){nr(),++Ve;for(var t,n=je;n;)(t=Qe-n._time)>=0&&n._call.call(null,t),n=n._next;--Ve}function ur(){Qe=(Ge=Ke.now())+Je,Ve=$e=0;try{or()}finally{Ve=0,function(){var t,n,e=je,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:je=n);Xe=t,cr(r)}(),Qe=0}}function ar(){var t=Ke.now(),n=t-Ge;n>Ze&&(Je-=n,Ge=t)}function cr(t){Ve||($e&&($e=clearTimeout($e)),t-Qe>24?(t<1/0&&($e=setTimeout(ur,t-Ke.now()-Je)),We&&(We=clearInterval(We))):(We||(Ge=Ke.now(),We=setInterval(ar,Ze)),Ve=1,tr(ur)))}function sr(t,n,e){var r=new rr;return n=null==n?0:+n,r.restart(function(e){r.stop(),t(e+n)},n,e),r}rr.prototype=ir.prototype={constructor:rr,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?nr():+e)+(null==n?0:+n),this._next||Xe===this||(Xe?Xe._next=this:je=this,Xe=this),this._call=t,this._time=e,cr()},stop:function(){this._call&&(this._call=null,this._time=1/0,cr())}};var fr=Y("start","end","interrupt"),lr=[],hr=0,pr=1,dr=2,vr=3,gr=4,_r=5,yr=6;function mr(t,n,e,r,i,o){var u=t.__transition;if(u){if(e in u)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(c){var s,f,l,h;if(e.state!==pr)return a();for(s in i)if((h=i[s]).name===e.name){if(h.state===vr)return sr(o);h.state===gr?(h.state=yr,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[s]):+s<n&&(h.state=yr,h.timer.stop(),delete i[s])}if(sr(function(){e.state===vr&&(e.state=gr,e.timer.restart(u,e.delay,e.time),u(c))}),e.state=dr,e.on.call("start",t,t.__data__,e.index,e.group),e.state===dr){for(e.state=vr,r=new Array(l=e.tween.length),s=0,f=-1;s<l;++s)(h=e.tween[s].value.call(t,t.__data__,e.index,e.group))&&(r[++f]=h);r.length=f+1}}function u(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(a),e.state=_r,1),o=-1,u=r.length;++o<u;)r[o].call(null,i);e.state===_r&&(e.on.call("end",t,t.__data__,e.index,e.group),a())}function a(){for(var r in e.state=yr,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=ir(function(t){e.state=pr,e.timer.restart(o,e.delay,e.time),e.delay<=t&&o(t-e.delay)},0,e.time)}(t,e,{name:n,index:r,group:i,on:fr,tween:lr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:hr})}function xr(t,n){var e=wr(t,n);if(e.state>hr)throw new Error("too late; already scheduled");return e}function br(t,n){var e=wr(t,n);if(e.state>dr)throw new Error("too late; already started");return e}function wr(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Mr(t,n){var e,r,i,o=t.__transition,u=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>dr&&e.state<_r,e.state=yr,e.timer.stop(),r&&e.on.call("interrupt",t,t.__data__,e.index,e.group),delete o[i]):u=!1;u&&delete t.__transition}}function Tr(t,n,e){var r=t._id;return t.each(function(){var t=br(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)}),function(t){return wr(t,r).value[n]}}function Nr(t,n){var e;return("number"==typeof n?he:n instanceof dn?ue:(e=dn(n))?(n=e,ue):ge)(t,n)}var kr=Rt.prototype.constructor;var Sr=0;function Er(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Ar(t){return Rt().transition(t)}function Cr(){return++Sr}var zr=Rt.prototype;function Pr(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function Rr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Er.prototype=Ar.prototype={constructor:Er,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=G(t));for(var r=this._groups,i=r.length,o=new Array(i),u=0;u<i;++u)for(var a,c,s=r[u],f=s.length,l=o[u]=new Array(f),h=0;h<f;++h)(a=s[h])&&(c=t.call(a,a.__data__,h,s))&&("__data__"in a&&(c.__data__=a.__data__),l[h]=c,mr(l[h],n,e,h,l,wr(a,e)));return new Er(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=J(t));for(var r=this._groups,i=r.length,o=[],u=[],a=0;a<i;++a)for(var c,s=r[a],f=s.length,l=0;l<f;++l)if(c=s[l]){for(var h,p=t.call(c,c.__data__,l,s),d=wr(c,e),v=0,g=p.length;v<g;++v)(h=p[v])&&mr(h,n,e,v,p,d);o.push(p),u.push(c)}return new Er(o,u,n,e)},filter:function(t){"function"!=typeof t&&(t=et(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u=n[i],a=u.length,c=r[i]=[],s=0;s<a;++s)(o=u[s])&&t.call(o,o.__data__,s,u)&&c.push(o);return new Er(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),u=new Array(r),a=0;a<o;++a)for(var c,s=n[a],f=e[a],l=s.length,h=u[a]=new Array(l),p=0;p<l;++p)(c=s[p]||f[p])&&(h[p]=c);for(;a<r;++a)u[a]=n[a];return new Er(u,this._parents,this._name,this._id)},selection:function(){return new kr(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Cr(),r=this._groups,i=r.length,o=0;o<i;++o)for(var u,a=r[o],c=a.length,s=0;s<c;++s)if(u=a[s]){var f=wr(u,n);mr(u,t,e,s,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Er(r,this._parents,t,e)},call:zr.call,nodes:zr.nodes,node:zr.node,size:zr.size,empty:zr.empty,each:zr.each,on:function(t,n){var e=this._id;return arguments.length<2?wr(this.node(),e).on.on(t):this.each(function(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t})}(n)?xr:br;return function(){var u=o(this,t),a=u.on;a!==r&&(i=(r=a).copy()).on(n,e),u.on=i}}(e,t,n))},attr:function(t,n){var e=$(t),r="transform"===e?Ee:Nr;return this.attrTween(t,"function"==typeof n?(e.local?function(t,n,e){var r,i,o;return function(){var u,a=e(this);if(null!=a)return(u=this.getAttributeNS(t.space,t.local))===a?null:u===r&&a===i?o:o=n(r=u,i=a);this.removeAttributeNS(t.space,t.local)}}:function(t,n,e){var r,i,o;return function(){var u,a=e(this);if(null!=a)return(u=this.getAttribute(t))===a?null:u===r&&a===i?o:o=n(r=u,i=a);this.removeAttribute(t)}})(e,r,Tr(this,"attr."+t,n)):null==n?(e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(e):(e.local?function(t,n,e){var r,i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===e?null:o===r?i:i=n(r=o,e)}}:function(t,n,e){var r,i;return function(){var o=this.getAttribute(t);return o===e?null:o===r?i:i=n(r=o,e)}})(e,r,n+""))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=$(t);return this.tween(e,(r.local?function(t,n){function e(){var e=this,r=n.apply(e,arguments);return r&&function(n){e.setAttributeNS(t.space,t.local,r(n))}}return e._value=n,e}:function(t,n){function e(){var e=this,r=n.apply(e,arguments);return r&&function(n){e.setAttribute(t,r(n))}}return e._value=n,e})(r,n))},style:function(t,n,e){var r="transform"==(t+="")?Se:Nr;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=ft(this,t),u=(this.style.removeProperty(t),ft(this,t));return o===u?null:o===e&&u===r?i:i=n(e=o,r=u)}}(t,r)).on("end.style."+t,function(t){return function(){this.style.removeProperty(t)}}(t)):this.styleTween(t,"function"==typeof n?function(t,n,e){var r,i,o;return function(){var u=ft(this,t),a=e(this);return null==a&&(this.style.removeProperty(t),a=ft(this,t)),u===a?null:u===r&&a===i?o:o=n(r=u,i=a)}}(t,r,Tr(this,"style."+t,n)):function(t,n,e){var r,i;return function(){var o=ft(this,t);return o===e?null:o===r?i:i=n(r=o,e)}}(t,r,n+""),e)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,function(t,n,e){function r(){var r=this,i=n.apply(r,arguments);return i&&function(n){r.style.setProperty(t,i(n),e)}}return r._value=n,r}(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(Tr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",(t=this._id,function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}));var t},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=wr(this.node(),e).tween,o=0,u=i.length;o<u;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?function(t,n){var e,r;return function(){var i=br(this,t),o=i.tween;if(o!==e)for(var u=0,a=(r=e=o).length;u<a;++u)if(r[u].name===n){(r=r.slice()).splice(u,1);break}i.tween=r}}:function(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=br(this,t),u=o.tween;if(u!==r){i=(r=u).slice();for(var a={name:n,value:e},c=0,s=i.length;c<s;++c)if(i[c].name===n){i[c]=a;break}c===s&&i.push(a)}o.tween=i}})(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){xr(this,t).delay=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){xr(this,t).delay=n}})(n,t)):wr(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){br(this,t).duration=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){br(this,t).duration=n}})(n,t)):wr(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(function(t,n){if("function"!=typeof n)throw new Error;return function(){br(this,t).ease=n}}(n,t)):wr(this.node(),n).ease}};var Lr=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),qr=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),Dr=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),Ur=Math.PI,Or=Ur/2;function Fr(t){return(1-Math.cos(Ur*t))/2}function Ir(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Yr(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Br=4/11,Hr=6/11,jr=8/11,Xr=.75,Vr=9/11,$r=10/11,Wr=.9375,Zr=21/22,Gr=63/64,Qr=1/Br/Br;function Jr(t){return(t=+t)<Br?Qr*t*t:t<jr?Qr*(t-=Hr)*t+Xr:t<$r?Qr*(t-=Vr)*t+Wr:Qr*(t-=Zr)*t+Gr}var Kr=function t(n){function e(t){return t*t*((n+1)*t-n)}return n=+n,e.overshoot=t,e}(1.70158),ti=function t(n){function e(t){return--t*t*((n+1)*t+n)+1}return n=+n,e.overshoot=t,e}(1.70158),ni=function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(1.70158),ei=2*Math.PI,ri=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=ei);function i(t){return n*Math.pow(2,10*--t)*Math.sin((r-t)/e)}return i.amplitude=function(n){return t(n,e*ei)},i.period=function(e){return t(n,e)},i}(1,.3),ii=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=ei);function i(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/e)}return i.amplitude=function(n){return t(n,e*ei)},i.period=function(e){return t(n,e)},i}(1,.3),oi=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=ei);function i(t){return((t=2*t-1)<0?n*Math.pow(2,10*t)*Math.sin((r-t)/e):2-n*Math.pow(2,-10*t)*Math.sin((r+t)/e))/2}return i.amplitude=function(n){return t(n,e*ei)},i.period=function(e){return t(n,e)},i}(1,.3),ui={time:null,delay:0,duration:250,ease:Rr};function ai(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return ui.time=nr(),ui;return e}Rt.prototype.interrupt=function(t){return this.each(function(){Mr(this,t)})},Rt.prototype.transition=function(t){var n,e;t instanceof Er?(n=t._id,t=t._name):(n=Cr(),(e=ui).time=nr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var u,a=r[o],c=a.length,s=0;s<c;++s)(u=a[s])&&mr(u,t,n,s,a,e||ai(u,n));return new Er(r,this._parents,t,n)};var ci=[null];function si(t){return function(){return t}}function fi(t,n,e){this.target=t,this.type=n,this.selection=e}function li(){t.event.stopImmediatePropagation()}function hi(){t.event.preventDefault(),t.event.stopImmediatePropagation()}var pi={name:"drag"},di={name:"space"},vi={name:"handle"},gi={name:"center"},_i={name:"x",handles:["e","w"].map(Ni),input:function(t,n){return t&&[[t[0],n[0][1]],[t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},yi={name:"y",handles:["n","s"].map(Ni),input:function(t,n){return t&&[[n[0][0],t[0]],[n[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},mi={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(Ni),input:function(t){return t},output:function(t){return t}},xi={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},bi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},wi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Mi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Ti={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ni(t){return{type:t}}function ki(){return!t.event.button}function Si(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Ei(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Ai(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Ci(n){var e,r=Si,i=ki,o=Y(a,"start","brush","end"),u=6;function a(t){var e=t.property("__brush",h).selectAll(".overlay").data([Ni("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",xi.overlay).merge(e).each(function(){var t=Ei(this).extent;Lt(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([Ni("selection")]).enter().append("rect").attr("class","selection").attr("cursor",xi.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(n.handles,function(t){return t.type});r.exit().remove(),r.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return xi[t.type]}),t.each(c).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",l)}function c(){var t=Lt(this),n=Ei(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?n[1][0]-u/2:n[0][0]-u/2}).attr("y",function(t){return"s"===t.type[0]?n[1][1]-u/2:n[0][1]-u/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+u:u}).attr("height",function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+u:u})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function s(t,n){return t.__brush.emitter||new f(t,n)}function f(t,n){this.that=t,this.args=n,this.state=t.__brush,this.active=0}function l(){if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return hi()}else if(e)return;if(i.apply(this,arguments)){var r,o,u,a,f,l,h,p,d,v,g,_,y,m=this,x=t.event.target.__data__.type,b="selection"===(t.event.metaKey?x="overlay":x)?pi:t.event.altKey?gi:vi,w=n===yi?null:Mi[x],M=n===_i?null:Ti[x],T=Ei(m),N=T.extent,k=T.selection,S=N[0][0],E=N[0][1],A=N[1][0],C=N[1][1],z=w&&M&&t.event.shiftKey,P=It(m),R=P,L=s(m,arguments).beforestart();"overlay"===x?T.selection=k=[[r=n===yi?S:P[0],u=n===_i?E:P[1]],[f=n===yi?A:r,h=n===_i?C:u]]:(r=k[0][0],u=k[0][1],f=k[1][0],h=k[1][1]),o=r,a=u,l=f,p=h;var q=Lt(m).attr("pointer-events","none"),D=q.selectAll(".overlay").attr("cursor",xi[x]);if(t.event.touches)q.on("touchmove.brush",O,!0).on("touchend.brush touchcancel.brush",I,!0);else{var U=Lt(t.event.view).on("keydown.brush",function(){switch(t.event.keyCode){case 16:z=w&&M;break;case 18:b===vi&&(w&&(f=l-d*w,r=o+d*w),M&&(h=p-v*M,u=a+v*M),b=gi,F());break;case 32:b!==vi&&b!==gi||(w<0?f=l-d:w>0&&(r=o-d),M<0?h=p-v:M>0&&(u=a-v),b=di,D.attr("cursor",xi.selection),F());break;default:return}hi()},!0).on("keyup.brush",function(){switch(t.event.keyCode){case 16:z&&(_=y=z=!1,F());break;case 18:b===gi&&(w<0?f=l:w>0&&(r=o),M<0?h=p:M>0&&(u=a),b=vi,F());break;case 32:b===di&&(t.event.altKey?(w&&(f=l-d*w,r=o+d*w),M&&(h=p-v*M,u=a+v*M),b=gi):(w<0?f=l:w>0&&(r=o),M<0?h=p:M>0&&(u=a),b=vi),D.attr("cursor",xi[x]),F());break;default:return}hi()},!0).on("mousemove.brush",O,!0).on("mouseup.brush",I,!0);jt(t.event.view)}li(),Mr(m),c.call(m),L.start()}function O(){var t=It(m);!z||_||y||(Math.abs(t[0]-R[0])>Math.abs(t[1]-R[1])?y=!0:_=!0),R=t,g=!0,hi(),F()}function F(){var t;switch(d=R[0]-P[0],v=R[1]-P[1],b){case di:case pi:w&&(d=Math.max(S-r,Math.min(A-f,d)),o=r+d,l=f+d),M&&(v=Math.max(E-u,Math.min(C-h,v)),a=u+v,p=h+v);break;case vi:w<0?(d=Math.max(S-r,Math.min(A-r,d)),o=r+d,l=f):w>0&&(d=Math.max(S-f,Math.min(A-f,d)),o=r,l=f+d),M<0?(v=Math.max(E-u,Math.min(C-u,v)),a=u+v,p=h):M>0&&(v=Math.max(E-h,Math.min(C-h,v)),a=u,p=h+v);break;case gi:w&&(o=Math.max(S,Math.min(A,r-d*w)),l=Math.max(S,Math.min(A,f+d*w))),M&&(a=Math.max(E,Math.min(C,u-v*M)),p=Math.max(E,Math.min(C,h+v*M)))}l<o&&(w*=-1,t=r,r=f,f=t,t=o,o=l,l=t,x in bi&&D.attr("cursor",xi[x=bi[x]])),p<a&&(M*=-1,t=u,u=h,h=t,t=a,a=p,p=t,x in wi&&D.attr("cursor",xi[x=wi[x]])),T.selection&&(k=T.selection),_&&(o=k[0][0],l=k[1][0]),y&&(a=k[0][1],p=k[1][1]),k[0][0]===o&&k[0][1]===a&&k[1][0]===l&&k[1][1]===p||(T.selection=[[o,a],[l,p]],c.call(m),L.brush())}function I(){if(li(),t.event.touches){if(t.event.touches.length)return;e&&clearTimeout(e),e=setTimeout(function(){e=null},500),q.on("touchmove.brush touchend.brush touchcancel.brush",null)}else Xt(t.event.view,g),U.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);q.attr("pointer-events","all"),D.attr("cursor",xi.overlay),T.selection&&(k=T.selection),Ai(k)&&(T.selection=null,c.call(m)),L.end()}}function h(){var t=this.__brush||{selection:null};return t.extent=r.apply(this,arguments),t.dim=n,t}return a.move=function(t,e){t.selection?t.on("start.brush",function(){s(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){s(this,arguments).end()}).tween("brush",function(){var t=this,r=t.__brush,i=s(t,arguments),o=r.selection,u=n.input("function"==typeof e?e.apply(this,arguments):e,r.extent),a=_e(o,u);function f(n){r.selection=1===n&&Ai(u)?null:a(n),c.call(t),i.brush()}return o&&u?f:f(1)}):t.each(function(){var t=arguments,r=this.__brush,i=n.input("function"==typeof e?e.apply(this,t):e,r.extent),o=s(this,t).beforestart();Mr(this),r.selection=null==i||Ai(i)?null:i,c.call(this),o.start().brush().end()})},f.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){At(new fi(a,t,n.output(this.state.selection)),o.apply,o,[t,this.that,this.args])}},a.extent=function(t){return arguments.length?(r="function"==typeof t?t:si([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),a):r},a.filter=function(t){return arguments.length?(i="function"==typeof t?t:si(!!t),a):i},a.handleSize=function(t){return arguments.length?(u=+t,a):u},a.on=function(){var t=o.on.apply(o,arguments);return t===o?a:t},a}var zi=Math.cos,Pi=Math.sin,Ri=Math.PI,Li=Ri/2,qi=2*Ri,Di=Math.max;var Ui=Array.prototype.slice;function Oi(t){return function(){return t}}var Fi=Math.PI,Ii=2*Fi,Yi=Ii-1e-6;function Bi(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Hi(){return new Bi}function ji(t){return t.source}function Xi(t){return t.target}function Vi(t){return t.radius}function $i(t){return t.startAngle}function Wi(t){return t.endAngle}Bi.prototype=Hi.prototype={constructor:Bi,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var o=this._x1,u=this._y1,a=e-t,c=r-n,s=o-t,f=u-n,l=s*s+f*f;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(f*a-c*s)>1e-6&&i){var h=e-o,p=r-u,d=a*a+c*c,v=h*h+p*p,g=Math.sqrt(d),_=Math.sqrt(l),y=i*Math.tan((Fi-Math.acos((d+l-v)/(2*g*_)))/2),m=y/_,x=y/g;Math.abs(m-1)>1e-6&&(this._+="L"+(t+m*s)+","+(n+m*f)),this._+="A"+i+","+i+",0,0,"+ +(f*h>s*p)+","+(this._x1=t+x*a)+","+(this._y1=n+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,o){t=+t,n=+n;var u=(e=+e)*Math.cos(r),a=e*Math.sin(r),c=t+u,s=n+a,f=1^o,l=o?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+c+","+s:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-s)>1e-6)&&(this._+="L"+c+","+s),e&&(l<0&&(l=l%Ii+Ii),l>Yi?this._+="A"+e+","+e+",0,1,"+f+","+(t-u)+","+(n-a)+"A"+e+","+e+",0,1,"+f+","+(this._x1=c)+","+(this._y1=s):l>1e-6&&(this._+="A"+e+","+e+",0,"+ +(l>=Fi)+","+f+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};function Zi(){}function Gi(t,n){var e=new Zi;if(t instanceof Zi)t.each(function(t,n){e.set(n,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==n)for(;++i<o;)e.set(i,t[i]);else for(;++i<o;)e.set(n(r=t[i],i,t),r)}else if(t)for(var u in t)e.set(u,t[u]);return e}function Qi(){return{}}function Ji(t,n,e){t[n]=e}function Ki(){return Gi()}function to(t,n,e){t.set(n,e)}function no(){}Zi.prototype=Gi.prototype={constructor:Zi,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,n){return this["$"+t]=n,this},remove:function(t){var n="$"+t;return n in this&&delete this[n]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)"$"===n[0]&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)"$"===n[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var n in this)"$"===n[0]&&t(this[n],n.slice(1),this)}};var eo=Gi.prototype;function ro(t,n){var e=new no;if(t instanceof no)t.each(function(t){e.add(t)});else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}no.prototype=ro.prototype={constructor:no,has:eo.has,add:function(t){return this["$"+(t+="")]=t,this},remove:eo.remove,clear:eo.clear,values:eo.keys,size:eo.size,empty:eo.empty,each:eo.each};var io={},oo={},uo=34,ao=10,co=13;function so(t){return new Function("d","return {"+t.map(function(t,n){return JSON.stringify(t)+": d["+n+"]"}).join(",")+"}")}function fo(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],o=t.length,u=0,a=0,c=o<=0,s=!1;function f(){if(c)return oo;if(s)return s=!1,io;var n,r,i=u;if(t.charCodeAt(i)===uo){for(;u++<o&&t.charCodeAt(u)!==uo||t.charCodeAt(++u)===uo;);return(n=u)>=o?c=!0:(r=t.charCodeAt(u++))===ao?s=!0:r===co&&(s=!0,t.charCodeAt(u)===ao&&++u),t.slice(i+1,n-1).replace(/""/g,'"')}for(;u<o;){if((r=t.charCodeAt(n=u++))===ao)s=!0;else if(r===co)s=!0,t.charCodeAt(u)===ao&&++u;else if(r!==e)continue;return t.slice(i,n)}return c=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===ao&&--o,t.charCodeAt(o-1)===co&&--o;(r=f())!==oo;){for(var l=[];r!==io&&r!==oo;)l.push(r),r=f();n&&null==(l=n(l,a++))||i.push(l)}return i}function i(n){return n.map(o).join(t)}function o(t){return null==t?"":n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,o=r(t,function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=so(t);return function(r,i){return n(e(r),i,t)}}(t,n):so(t)});return o.columns=i||[],o},parseRows:r,format:function(n,e){return null==e&&(e=function(t){var n=Object.create(null),e=[];return t.forEach(function(t){for(var r in t)r in n||e.push(n[r]=r)}),e}(n)),[e.map(o).join(t)].concat(n.map(function(n){return e.map(function(t){return o(n[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(i).join("\n")}}}var lo=fo(","),ho=lo.parse,po=lo.parseRows,vo=lo.format,go=lo.formatRows,_o=fo("\t"),yo=_o.parse,mo=_o.parseRows,xo=_o.format,bo=_o.formatRows;function wo(t){return function(){return t}}function Mo(){return 1e-6*(Math.random()-.5)}function To(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,u,a,c,s,f,l,h,p=t._root,d={data:r},v=t._x0,g=t._y0,_=t._x1,y=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((s=n>=(o=(v+_)/2))?v=o:_=o,(f=e>=(u=(g+y)/2))?g=u:y=u,i=p,!(p=p[l=f<<1|s]))return i[l]=d,t;if(a=+t._x.call(null,p.data),c=+t._y.call(null,p.data),n===a&&e===c)return d.next=p,i?i[l]=d:t._root=d,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(s=n>=(o=(v+_)/2))?v=o:_=o,(f=e>=(u=(g+y)/2))?g=u:y=u}while((l=f<<1|s)==(h=(c>=u)<<1|a>=o));return i[h]=p,i[l]=d,t}function No(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function ko(t){return t[0]}function So(t){return t[1]}function Eo(t,n,e){var r=new Ao(null==n?ko:n,null==e?So:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Ao(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Co(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var zo=Eo.prototype=Ao.prototype;function Po(t){return t.x+t.vx}function Ro(t){return t.y+t.vy}function Lo(t){return t.index}function qo(t,n){var e=t.get(n);if(!e)throw new Error("missing: "+n);return e}function Do(t){return t.x}function Uo(t){return t.y}zo.copy=function(){var t,n,e=new Ao(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Co(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Co(n));return e},zo.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return To(this.cover(n,e),n,e,t)},zo.addAll=function(t){var n,e,r,i,o=t.length,u=new Array(o),a=new Array(o),c=1/0,s=1/0,f=-1/0,l=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(u[e]=r,a[e]=i,r<c&&(c=r),r>f&&(f=r),i<s&&(s=i),i>l&&(l=i));for(f<c&&(c=this._x0,f=this._x1),l<s&&(s=this._y0,l=this._y1),this.cover(c,s).cover(f,l),e=0;e<o;++e)To(this,u[e],a[e],t[e]);return this},zo.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{if(!(e>t||t>i||r>n||n>o))return this;var u,a,c=i-e,s=this._root;switch(a=(n<(r+o)/2)<<1|t<(e+i)/2){case 0:do{(u=new Array(4))[a]=s,s=u}while(o=r+(c*=2),t>(i=e+c)||n>o);break;case 1:do{(u=new Array(4))[a]=s,s=u}while(o=r+(c*=2),(e=i-c)>t||n>o);break;case 2:do{(u=new Array(4))[a]=s,s=u}while(r=o-(c*=2),t>(i=e+c)||r>n);break;case 3:do{(u=new Array(4))[a]=s,s=u}while(r=o-(c*=2),(e=i-c)>t||r>n)}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},zo.data=function(){var t=[];return this.visit(function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)}),t},zo.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},zo.find=function(t,n,e){var r,i,o,u,a,c,s,f=this._x0,l=this._y0,h=this._x1,p=this._y1,d=[],v=this._root;for(v&&d.push(new No(v,f,l,h,p)),null==e?e=1/0:(f=t-e,l=n-e,h=t+e,p=n+e,e*=e);c=d.pop();)if(!(!(v=c.node)||(i=c.x0)>h||(o=c.y0)>p||(u=c.x1)<f||(a=c.y1)<l))if(v.length){var g=(i+u)/2,_=(o+a)/2;d.push(new No(v[3],g,_,u,a),new No(v[2],i,_,g,a),new No(v[1],g,o,u,_),new No(v[0],i,o,g,_)),(s=(n>=_)<<1|t>=g)&&(c=d[d.length-1],d[d.length-1]=d[d.length-1-s],d[d.length-1-s]=c)}else{var y=t-+this._x.call(null,v.data),m=n-+this._y.call(null,v.data),x=y*y+m*m;if(x<e){var b=Math.sqrt(e=x);f=t-b,l=n-b,h=t+b,p=n+b,r=v.data}}return r},zo.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(u=+this._y.call(null,t)))return this;var n,e,r,i,o,u,a,c,s,f,l,h,p=this._root,d=this._x0,v=this._y0,g=this._x1,_=this._y1;if(!p)return this;if(p.length)for(;;){if((s=o>=(a=(d+g)/2))?d=a:g=a,(f=u>=(c=(v+_)/2))?v=c:_=c,n=p,!(p=p[l=f<<1|s]))return this;if(!p.length)break;(n[l+1&3]||n[l+2&3]||n[l+3&3])&&(e=n,h=l)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):n?(i?n[l]=i:delete n[l],(p=n[0]||n[1]||n[2]||n[3])&&p===(n[3]||n[2]||n[1]||n[0])&&!p.length&&(e?e[h]=p:this._root=p),this):(this._root=i,this)},zo.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},zo.root=function(){return this._root},zo.size=function(){var t=0;return this.visit(function(n){if(!n.length)do{++t}while(n=n.next)}),t},zo.visit=function(t){var n,e,r,i,o,u,a=[],c=this._root;for(c&&a.push(new No(c,this._x0,this._y0,this._x1,this._y1));n=a.pop();)if(!t(c=n.node,r=n.x0,i=n.y0,o=n.x1,u=n.y1)&&c.length){var s=(r+o)/2,f=(i+u)/2;(e=c[3])&&a.push(new No(e,s,f,o,u)),(e=c[2])&&a.push(new No(e,r,f,s,u)),(e=c[1])&&a.push(new No(e,s,i,o,f)),(e=c[0])&&a.push(new No(e,r,i,s,f))}return this},zo.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new No(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,u=n.x0,a=n.y0,c=n.x1,s=n.y1,f=(u+c)/2,l=(a+s)/2;(o=i[0])&&e.push(new No(o,u,a,f,l)),(o=i[1])&&e.push(new No(o,f,a,c,l)),(o=i[2])&&e.push(new No(o,u,l,f,s)),(o=i[3])&&e.push(new No(o,f,l,c,s))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},zo.x=function(t){return arguments.length?(this._x=t,this):this._x},zo.y=function(t){return arguments.length?(this._y=t,this):this._y};var Oo,Fo=10,Io=Math.PI*(3-Math.sqrt(5));function Yo(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function Bo(t){return(t=Yo(Math.abs(t)))?t[1]:NaN}function Ho(t,n){var e=Yo(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var jo={"":function(t,n){t:for(var e,r=(t=t.toPrecision(n)).length,i=1,o=-1;i<r;++i)switch(t[i]){case".":o=e=i;break;case"0":0===o&&(o=i),e=i;break;case"e":break t;default:o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t},"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return Ho(100*t,n)},r:Ho,s:function(t,n){var e=Yo(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(Oo=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,u=r.length;return o===u?r:o>u?r+new Array(o-u+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Yo(t,Math.max(0,n+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Xo=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function Vo(t){return new $o(t)}function $o(t){if(!(n=Xo.exec(t)))throw new Error("invalid format: "+t);var n,e=n[1]||" ",r=n[2]||">",i=n[3]||"-",o=n[4]||"",u=!!n[5],a=n[6]&&+n[6],c=!!n[7],s=n[8]&&+n[8].slice(1),f=n[9]||"";"n"===f?(c=!0,f="g"):jo[f]||(f=""),(u||"0"===e&&"="===r)&&(u=!0,e="0",r="="),this.fill=e,this.align=r,this.sign=i,this.symbol=o,this.zero=u,this.width=a,this.comma=c,this.precision=s,this.type=f}function Wo(t){return t}Vo.prototype=$o.prototype,$o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Zo,Go=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Qo(t){var n,e,r=t.grouping&&t.thousands?(n=t.grouping,e=t.thousands,function(t,r){for(var i=t.length,o=[],u=0,a=n[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),o.push(t.substring(i-=a,i+a)),!((c+=a+1)>r));)a=n[u=(u+1)%n.length];return o.reverse().join(e)}):Wo,i=t.currency,o=t.decimal,u=t.numerals?function(t){return function(n){return n.replace(/[0-9]/g,function(n){return t[+n]})}}(t.numerals):Wo,a=t.percent||"%";function c(t){var n=(t=Vo(t)).fill,e=t.align,c=t.sign,s=t.symbol,f=t.zero,l=t.width,h=t.comma,p=t.precision,d=t.type,v="$"===s?i[0]:"#"===s&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",g="$"===s?i[1]:/[%p]/.test(d)?a:"",_=jo[d],y=!d||/[defgprs%]/.test(d);function m(t){var i,a,s,m=v,x=g;if("c"===d)x=_(t)+x,t="";else{var b=(t=+t)<0;if(t=_(Math.abs(t),p),b&&0==+t&&(b=!1),m=(b?"("===c?c:"-":"-"===c||"("===c?"":c)+m,x=("s"===d?Go[8+Oo/3]:"")+x+(b&&"("===c?")":""),y)for(i=-1,a=t.length;++i<a;)if(48>(s=t.charCodeAt(i))||s>57){x=(46===s?o+t.slice(i+1):t.slice(i))+x,t=t.slice(0,i);break}}h&&!f&&(t=r(t,1/0));var w=m.length+t.length+x.length,M=w<l?new Array(l-w+1).join(n):"";switch(h&&f&&(t=r(M+t,M.length?l-x.length:1/0),M=""),e){case"<":t=m+t+x+M;break;case"=":t=m+M+t+x;break;case"^":t=M.slice(0,w=M.length>>1)+m+t+x+M.slice(w);break;default:t=M+m+t+x}return u(t)}return p=null==p?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),m.toString=function(){return t+""},m}return{format:c,formatPrefix:function(t,n){var e=c(((t=Vo(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Bo(n)/3))),i=Math.pow(10,-r),o=Go[8+r/3];return function(t){return e(i*t)+o}}}}function Jo(n){return Zo=Qo(n),t.format=Zo.format,t.formatPrefix=Zo.formatPrefix,Zo}function Ko(t){return Math.max(0,-Bo(Math.abs(t)))}function tu(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Bo(n)/3)))-Bo(Math.abs(t)))}function nu(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Bo(n)-Bo(t))+1}function eu(){return new ru}function ru(){this.reset()}Jo({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),ru.prototype={constructor:ru,reset:function(){this.s=this.t=0},add:function(t){ou(iu,t,this.t),ou(this,iu.s,this.s),this.s?this.t+=iu.t:this.s=iu.t},valueOf:function(){return this.s}};var iu=new ru;function ou(t,n,e){var r=t.s=n+e,i=r-n,o=r-i;t.t=n-o+(e-i)}var uu=1e-6,au=1e-12,cu=Math.PI,su=cu/2,fu=cu/4,lu=2*cu,hu=180/cu,pu=cu/180,du=Math.abs,vu=Math.atan,gu=Math.atan2,_u=Math.cos,yu=Math.ceil,mu=Math.exp,xu=Math.log,bu=Math.pow,wu=Math.sin,Mu=Math.sign||function(t){return t>0?1:t<0?-1:0},Tu=Math.sqrt,Nu=Math.tan;function ku(t){return t>1?0:t<-1?cu:Math.acos(t)}function Su(t){return t>1?su:t<-1?-su:Math.asin(t)}function Eu(t){return(t=wu(t/2))*t}function Au(){}function Cu(t,n){t&&Pu.hasOwnProperty(t.type)&&Pu[t.type](t,n)}var zu={Feature:function(t,n){Cu(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Cu(e[r].geometry,n)}},Pu={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Ru(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Ru(e[r],n,0)},Polygon:function(t,n){Lu(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Lu(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Cu(e[r],n)}};function Ru(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function Lu(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Ru(t[e],n,1);n.polygonEnd()}function qu(t,n){t&&zu.hasOwnProperty(t.type)?zu[t.type](t,n):Cu(t,n)}var Du,Uu,Ou,Fu,Iu,Yu,Bu,Hu,ju,Xu,Vu,$u,Wu,Zu=eu(),Gu=eu(),Qu={point:Au,lineStart:Au,lineEnd:Au,polygonStart:function(){Zu.reset(),Qu.lineStart=Ju,Qu.lineEnd=Ku},polygonEnd:function(){var t=+Zu;Gu.add(t<0?lu+t:t),this.lineStart=this.lineEnd=this.point=Au},sphere:function(){Gu.add(lu)}};function Ju(){Qu.point=ta}function Ku(){na(Du,Uu)}function ta(t,n){Qu.point=na,Du=t,Uu=n,Ou=t*=pu,Fu=_u(n=(n*=pu)/2+fu),Iu=wu(n)}function na(t,n){var e=(t*=pu)-Ou,r=e>=0?1:-1,i=r*e,o=_u(n=(n*=pu)/2+fu),u=wu(n),a=Iu*u,c=Fu*o+a*_u(i),s=a*r*wu(i);Zu.add(gu(s,c)),Ou=t,Fu=o,Iu=u}function ea(t){return[gu(t[1],t[0]),Su(t[2])]}function ra(t){var n=t[0],e=t[1],r=_u(e);return[r*_u(n),r*wu(n),wu(e)]}function ia(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function oa(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function ua(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function aa(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function ca(t){var n=Tu(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}var sa,fa,la,ha,pa,da,va,ga,_a,ya,ma,xa,ba,wa,Ma,Ta,Na,ka,Sa=eu(),Ea={point:Aa,lineStart:za,lineEnd:Pa,polygonStart:function(){Ea.point=Ra,Ea.lineStart=La,Ea.lineEnd=qa,Sa.reset(),Qu.polygonStart()},polygonEnd:function(){Qu.polygonEnd(),Ea.point=Aa,Ea.lineStart=za,Ea.lineEnd=Pa,Zu<0?(Yu=-(Hu=180),Bu=-(ju=90)):Sa>uu?ju=90:Sa<-uu&&(Bu=-90),fa[0]=Yu,fa[1]=Hu}};function Aa(t,n){sa.push(fa=[Yu=t,Hu=t]),n<Bu&&(Bu=n),n>ju&&(ju=n)}function Ca(t,n){var e=ra([t*pu,n*pu]);if(Wu){var r=oa(Wu,e),i=oa([r[1],-r[0],0],r);ca(i),i=ea(i);var o,u=t-Xu,a=u>0?1:-1,c=i[0]*hu*a,s=du(u)>180;s^(a*Xu<c&&c<a*t)?(o=i[1]*hu)>ju&&(ju=o):s^(a*Xu<(c=(c+360)%360-180)&&c<a*t)?(o=-i[1]*hu)<Bu&&(Bu=o):(n<Bu&&(Bu=n),n>ju&&(ju=n)),s?t<Xu?Da(Yu,t)>Da(Yu,Hu)&&(Hu=t):Da(t,Hu)>Da(Yu,Hu)&&(Yu=t):Hu>=Yu?(t<Yu&&(Yu=t),t>Hu&&(Hu=t)):t>Xu?Da(Yu,t)>Da(Yu,Hu)&&(Hu=t):Da(t,Hu)>Da(Yu,Hu)&&(Yu=t)}else sa.push(fa=[Yu=t,Hu=t]);n<Bu&&(Bu=n),n>ju&&(ju=n),Wu=e,Xu=t}function za(){Ea.point=Ca}function Pa(){fa[0]=Yu,fa[1]=Hu,Ea.point=Aa,Wu=null}function Ra(t,n){if(Wu){var e=t-Xu;Sa.add(du(e)>180?e+(e>0?360:-360):e)}else Vu=t,$u=n;Qu.point(t,n),Ca(t,n)}function La(){Qu.lineStart()}function qa(){Ra(Vu,$u),Qu.lineEnd(),du(Sa)>uu&&(Yu=-(Hu=180)),fa[0]=Yu,fa[1]=Hu,Wu=null}function Da(t,n){return(n-=t)<0?n+360:n}function Ua(t,n){return t[0]-n[0]}function Oa(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var Fa={sphere:Au,point:Ia,lineStart:Ba,lineEnd:Xa,polygonStart:function(){Fa.lineStart=Va,Fa.lineEnd=$a},polygonEnd:function(){Fa.lineStart=Ba,Fa.lineEnd=Xa}};function Ia(t,n){t*=pu;var e=_u(n*=pu);Ya(e*_u(t),e*wu(t),wu(n))}function Ya(t,n,e){pa+=(t-pa)/++la,da+=(n-da)/la,va+=(e-va)/la}function Ba(){Fa.point=Ha}function Ha(t,n){t*=pu;var e=_u(n*=pu);Ta=e*_u(t),Na=e*wu(t),ka=wu(n),Fa.point=ja,Ya(Ta,Na,ka)}function ja(t,n){t*=pu;var e=_u(n*=pu),r=e*_u(t),i=e*wu(t),o=wu(n),u=gu(Tu((u=Na*o-ka*i)*u+(u=ka*r-Ta*o)*u+(u=Ta*i-Na*r)*u),Ta*r+Na*i+ka*o);ha+=u,ga+=u*(Ta+(Ta=r)),_a+=u*(Na+(Na=i)),ya+=u*(ka+(ka=o)),Ya(Ta,Na,ka)}function Xa(){Fa.point=Ia}function Va(){Fa.point=Wa}function $a(){Za(wa,Ma),Fa.point=Ia}function Wa(t,n){wa=t,Ma=n,t*=pu,n*=pu,Fa.point=Za;var e=_u(n);Ta=e*_u(t),Na=e*wu(t),ka=wu(n),Ya(Ta,Na,ka)}function Za(t,n){t*=pu;var e=_u(n*=pu),r=e*_u(t),i=e*wu(t),o=wu(n),u=Na*o-ka*i,a=ka*r-Ta*o,c=Ta*i-Na*r,s=Tu(u*u+a*a+c*c),f=Su(s),l=s&&-f/s;ma+=l*u,xa+=l*a,ba+=l*c,ha+=f,ga+=f*(Ta+(Ta=r)),_a+=f*(Na+(Na=i)),ya+=f*(ka+(ka=o)),Ya(Ta,Na,ka)}function Ga(t){return function(){return t}}function Qa(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function Ja(t,n){return[t>cu?t-lu:t<-cu?t+lu:t,n]}function Ka(t,n,e){return(t%=lu)?n||e?Qa(nc(t),ec(n,e)):nc(t):n||e?ec(n,e):Ja}function tc(t){return function(n,e){return[(n+=t)>cu?n-lu:n<-cu?n+lu:n,e]}}function nc(t){var n=tc(t);return n.invert=tc(-t),n}function ec(t,n){var e=_u(t),r=wu(t),i=_u(n),o=wu(n);function u(t,n){var u=_u(n),a=_u(t)*u,c=wu(t)*u,s=wu(n),f=s*e+a*r;return[gu(c*i-f*o,a*e-s*r),Su(f*i+c*o)]}return u.invert=function(t,n){var u=_u(n),a=_u(t)*u,c=wu(t)*u,s=wu(n),f=s*i-c*o;return[gu(c*i+s*o,a*e+f*r),Su(f*e-a*r)]},u}function rc(t){function n(n){return(n=t(n[0]*pu,n[1]*pu))[0]*=hu,n[1]*=hu,n}return t=Ka(t[0]*pu,t[1]*pu,t.length>2?t[2]*pu:0),n.invert=function(n){return(n=t.invert(n[0]*pu,n[1]*pu))[0]*=hu,n[1]*=hu,n},n}function ic(t,n,e,r,i,o){if(e){var u=_u(n),a=wu(n),c=r*e;null==i?(i=n+r*lu,o=n-c/2):(i=oc(u,i),o=oc(u,o),(r>0?i<o:i>o)&&(i+=r*lu));for(var s,f=i;r>0?f>o:f<o;f-=c)s=ea([u,-a*_u(f),-a*wu(f)]),t.point(s[0],s[1])}}function oc(t,n){(n=ra(n))[0]-=t,ca(n);var e=ku(-n[1]);return((-n[2]<0?-e:e)+lu-uu)%lu}function uc(){var t,n=[];return{point:function(n,e){t.push([n,e])},lineStart:function(){n.push(t=[])},lineEnd:Au,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function ac(t,n){return du(t[0]-n[0])<uu&&du(t[1]-n[1])<uu}function cc(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function sc(t,n,e,r,i){var o,u,a=[],c=[];if(t.forEach(function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],u=t[n];if(ac(r,u)){for(i.lineStart(),o=0;o<n;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else a.push(e=new cc(r,t,null,!0)),c.push(e.o=new cc(r,null,e,!1)),a.push(e=new cc(u,t,null,!1)),c.push(e.o=new cc(u,null,e,!0))}}),a.length){for(c.sort(n),fc(a),fc(c),o=0,u=c.length;o<u;++o)c[o].e=e=!e;for(var s,f,l=a[0];;){for(var h=l,p=!0;h.v;)if((h=h.n)===l)return;s=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(o=0,u=s.length;o<u;++o)i.point((f=s[o])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(p)for(s=h.p.z,o=s.length-1;o>=0;--o)i.point((f=s[o])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}s=(h=h.o).z,p=!p}while(!h.v);i.lineEnd()}}}function fc(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}Ja.invert=Ja;var lc=eu();function hc(t,n){var e=n[0],r=n[1],i=[wu(e),-_u(e),0],o=0,u=0;lc.reset();for(var a=0,c=t.length;a<c;++a)if(f=(s=t[a]).length)for(var s,f,l=s[f-1],h=l[0],p=l[1]/2+fu,d=wu(p),v=_u(p),g=0;g<f;++g,h=y,d=x,v=b,l=_){var _=s[g],y=_[0],m=_[1]/2+fu,x=wu(m),b=_u(m),w=y-h,M=w>=0?1:-1,T=M*w,N=T>cu,k=d*x;if(lc.add(gu(k*M*wu(T),v*b+k*_u(T))),o+=N?w+M*lu:w,N^h>=e^y>=e){var S=oa(ra(l),ra(_));ca(S);var E=oa(i,S);ca(E);var A=(N^w>=0?-1:1)*Su(E[2]);(r>A||r===A&&(S[0]||S[1]))&&(u+=N^w>=0?1:-1)}}return(o<-uu||o<uu&&lc<-uu)^1&u}function pc(t,n,e,r){return function(i){var o,u,a,c=n(i),s=uc(),f=n(s),l=!1,h={point:p,lineStart:v,lineEnd:g,polygonStart:function(){h.point=_,h.lineStart=y,h.lineEnd=m,u=[],o=[]},polygonEnd:function(){h.point=p,h.lineStart=v,h.lineEnd=g,u=N(u);var t=hc(o,r);u.length?(l||(i.polygonStart(),l=!0),sc(u,vc,t,e,i)):t&&(l||(i.polygonStart(),l=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),u=o=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(n,e){t(n,e)&&i.point(n,e)}function d(t,n){c.point(t,n)}function v(){h.point=d,c.lineStart()}function g(){h.point=p,c.lineEnd()}function _(t,n){a.push([t,n]),f.point(t,n)}function y(){f.lineStart(),a=[]}function m(){_(a[0][0],a[0][1]),f.lineEnd();var t,n,e,r,c=f.clean(),h=s.result(),p=h.length;if(a.pop(),o.push(a),a=null,p)if(1&c){if((n=(e=h[0]).length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),t=0;t<n;++t)i.point((r=e[t])[0],r[1]);i.lineEnd()}}else p>1&&2&c&&h.push(h.pop().concat(h.shift())),u.push(h.filter(dc))}return h}}function dc(t){return t.length>1}function vc(t,n){return((t=t.x)[0]<0?t[1]-su-uu:su-t[1])-((n=n.x)[0]<0?n[1]-su-uu:su-n[1])}var gc=pc(function(){return!0},function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,u){var a=o>0?cu:-cu,c=du(o-e);du(c-cu)<uu?(t.point(e,r=(r+u)/2>0?su:-su),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),n=0):i!==a&&c>=cu&&(du(e-i)<uu&&(e-=i*uu),du(o-a)<uu&&(o-=a*uu),r=function(t,n,e,r){var i,o,u=wu(t-e);return du(u)>uu?vu((wu(n)*(o=_u(r))*wu(e)-wu(r)*(i=_u(n))*wu(t))/(i*o*u)):(n+r)/2}(e,r,o,u),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),n=0),t.point(e=o,r=u),i=a},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}},function(t,n,e,r){var i;if(null==t)i=e*su,r.point(-cu,i),r.point(0,i),r.point(cu,i),r.point(cu,0),r.point(cu,-i),r.point(0,-i),r.point(-cu,-i),r.point(-cu,0),r.point(-cu,i);else if(du(t[0]-n[0])>uu){var o=t[0]<n[0]?cu:-cu;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])},[-cu,-su]);function _c(t){var n=_u(t),e=6*pu,r=n>0,i=du(n)>uu;function o(t,e){return _u(t)*_u(e)>n}function u(t,e,r){var i=[1,0,0],o=oa(ra(t),ra(e)),u=ia(o,o),a=o[0],c=u-a*a;if(!c)return!r&&t;var s=n*u/c,f=-n*a/c,l=oa(i,o),h=aa(i,s);ua(h,aa(o,f));var p=l,d=ia(h,p),v=ia(p,p),g=d*d-v*(ia(h,h)-1);if(!(g<0)){var _=Tu(g),y=aa(p,(-d-_)/v);if(ua(y,h),y=ea(y),!r)return y;var m,x=t[0],b=e[0],w=t[1],M=e[1];b<x&&(m=x,x=b,b=m);var T=b-x,N=du(T-cu)<uu;if(!N&&M<w&&(m=w,w=M,M=m),N||T<uu?N?w+M>0^y[1]<(du(y[0]-x)<uu?w:M):w<=y[1]&&y[1]<=M:T>cu^(x<=y[0]&&y[0]<=b)){var k=aa(p,(-d+_)/v);return ua(k,h),[y,ea(k)]}}}function a(n,e){var i=r?t:cu-t,o=0;return n<-i?o|=1:n>i&&(o|=2),e<-i?o|=4:e>i&&(o|=8),o}return pc(o,function(t){var n,e,c,s,f;return{lineStart:function(){s=c=!1,f=1},point:function(l,h){var p,d=[l,h],v=o(l,h),g=r?v?0:a(l,h):v?a(l+(l<0?cu:-cu),h):0;if(!n&&(s=c=v)&&t.lineStart(),v!==c&&(!(p=u(n,d))||ac(n,p)||ac(d,p))&&(d[0]+=uu,d[1]+=uu,v=o(d[0],d[1])),v!==c)f=0,v?(t.lineStart(),p=u(d,n),t.point(p[0],p[1])):(p=u(n,d),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(i&&n&&r^v){var _;g&e||!(_=u(d,n,!0))||(f=0,r?(t.lineStart(),t.point(_[0][0],_[0][1]),t.point(_[1][0],_[1][1]),t.lineEnd()):(t.point(_[1][0],_[1][1]),t.lineEnd(),t.lineStart(),t.point(_[0][0],_[0][1])))}!v||n&&ac(n,d)||t.point(d[0],d[1]),n=d,c=v,e=g},lineEnd:function(){c&&t.lineEnd(),n=null},clean:function(){return f|(s&&c)<<1}}},function(n,r,i,o){ic(o,t,e,i,n,r)},r?[0,-t]:[-cu,t-cu])}var yc=1e9,mc=-yc;function xc(t,n,e,r){function i(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function o(i,o,a,s){var f=0,l=0;if(null==i||(f=u(i,a))!==(l=u(o,a))||c(i,o)<0^a>0)do{s.point(0===f||3===f?t:e,f>1?r:n)}while((f=(f+a+4)%4)!==l);else s.point(o[0],o[1])}function u(r,i){return du(r[0]-t)<uu?i>0?0:3:du(r[0]-e)<uu?i>0?2:1:du(r[1]-n)<uu?i>0?1:0:i>0?3:2}function a(t,n){return c(t.x,n.x)}function c(t,n){var e=u(t,1),r=u(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(u){var c,s,f,l,h,p,d,v,g,_,y,m=u,x=uc(),b={point:w,lineStart:function(){b.point=M,s&&s.push(f=[]);_=!0,g=!1,d=v=NaN},lineEnd:function(){c&&(M(l,h),p&&g&&x.rejoin(),c.push(x.result()));b.point=w,g&&m.lineEnd()},polygonStart:function(){m=x,c=[],s=[],y=!0},polygonEnd:function(){var n=function(){for(var n=0,e=0,i=s.length;e<i;++e)for(var o,u,a=s[e],c=1,f=a.length,l=a[0],h=l[0],p=l[1];c<f;++c)o=h,u=p,l=a[c],h=l[0],p=l[1],u<=r?p>r&&(h-o)*(r-u)>(p-u)*(t-o)&&++n:p<=r&&(h-o)*(r-u)<(p-u)*(t-o)&&--n;return n}(),e=y&&n,i=(c=N(c)).length;(e||i)&&(u.polygonStart(),e&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),i&&sc(c,a,n,o,u),u.polygonEnd());m=u,c=s=f=null}};function w(t,n){i(t,n)&&m.point(t,n)}function M(o,u){var a=i(o,u);if(s&&f.push([o,u]),_)l=o,h=u,p=a,_=!1,a&&(m.lineStart(),m.point(o,u));else if(a&&g)m.point(o,u);else{var c=[d=Math.max(mc,Math.min(yc,d)),v=Math.max(mc,Math.min(yc,v))],x=[o=Math.max(mc,Math.min(yc,o)),u=Math.max(mc,Math.min(yc,u))];!function(t,n,e,r,i,o){var u,a=t[0],c=t[1],s=0,f=1,l=n[0]-a,h=n[1]-c;if(u=e-a,l||!(u>0)){if(u/=l,l<0){if(u<s)return;u<f&&(f=u)}else if(l>0){if(u>f)return;u>s&&(s=u)}if(u=i-a,l||!(u<0)){if(u/=l,l<0){if(u>f)return;u>s&&(s=u)}else if(l>0){if(u<s)return;u<f&&(f=u)}if(u=r-c,h||!(u>0)){if(u/=h,h<0){if(u<s)return;u<f&&(f=u)}else if(h>0){if(u>f)return;u>s&&(s=u)}if(u=o-c,h||!(u<0)){if(u/=h,h<0){if(u>f)return;u>s&&(s=u)}else if(h>0){if(u<s)return;u<f&&(f=u)}return s>0&&(t[0]=a+s*l,t[1]=c+s*h),f<1&&(n[0]=a+f*l,n[1]=c+f*h),!0}}}}}(c,x,t,n,e,r)?a&&(m.lineStart(),m.point(o,u),y=!1):(g||(m.lineStart(),m.point(c[0],c[1])),m.point(x[0],x[1]),a||m.lineEnd(),y=!1)}d=o,v=u,g=a}return b}}var bc,wc,Mc,Tc=eu(),Nc={sphere:Au,point:Au,lineStart:function(){Nc.point=Sc,Nc.lineEnd=kc},lineEnd:Au,polygonStart:Au,polygonEnd:Au};function kc(){Nc.point=Nc.lineEnd=Au}function Sc(t,n){bc=t*=pu,wc=wu(n*=pu),Mc=_u(n),Nc.point=Ec}function Ec(t,n){t*=pu;var e=wu(n*=pu),r=_u(n),i=du(t-bc),o=_u(i),u=r*wu(i),a=Mc*e-wc*r*o,c=wc*e+Mc*r*o;Tc.add(gu(Tu(u*u+a*a),c)),bc=t,wc=e,Mc=r}function Ac(t){return Tc.reset(),qu(t,Nc),+Tc}var Cc=[null,null],zc={type:"LineString",coordinates:Cc};function Pc(t,n){return Cc[0]=t,Cc[1]=n,Ac(zc)}var Rc={Feature:function(t,n){return qc(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)if(qc(e[r].geometry,n))return!0;return!1}},Lc={Sphere:function(){return!0},Point:function(t,n){return Dc(t.coordinates,n)},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Dc(e[r],n))return!0;return!1},LineString:function(t,n){return Uc(t.coordinates,n)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Uc(e[r],n))return!0;return!1},Polygon:function(t,n){return Oc(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(Oc(e[r],n))return!0;return!1},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)if(qc(e[r],n))return!0;return!1}};function qc(t,n){return!(!t||!Lc.hasOwnProperty(t.type))&&Lc[t.type](t,n)}function Dc(t,n){return 0===Pc(t,n)}function Uc(t,n){var e=Pc(t[0],t[1]);return Pc(t[0],n)+Pc(n,t[1])<=e+uu}function Oc(t,n){return!!hc(t.map(Fc),Ic(n))}function Fc(t){return(t=t.map(Ic)).pop(),t}function Ic(t){return[t[0]*pu,t[1]*pu]}function Yc(t,n,e){var r=g(t,n-uu,e).concat(n);return function(t){return r.map(function(n){return[t,n]})}}function Bc(t,n,e){var r=g(t,n-uu,e).concat(n);return function(t){return r.map(function(n){return[n,t]})}}function Hc(){var t,n,e,r,i,o,u,a,c,s,f,l,h=10,p=h,d=90,v=360,_=2.5;function y(){return{type:"MultiLineString",coordinates:m()}}function m(){return g(yu(r/d)*d,e,d).map(f).concat(g(yu(a/v)*v,u,v).map(l)).concat(g(yu(n/h)*h,t,h).filter(function(t){return du(t%d)>uu}).map(c)).concat(g(yu(o/p)*p,i,p).filter(function(t){return du(t%v)>uu}).map(s))}return y.lines=function(){return m().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(l(u).slice(1),f(e).reverse().slice(1),l(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],u=+t[1][1],r>e&&(t=r,r=e,e=t),a>u&&(t=a,a=u,u=t),y.precision(_)):[[r,a],[e,u]]},y.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],o=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),o>i&&(e=o,o=i,i=e),y.precision(_)):[[n,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(d=+t[0],v=+t[1],y):[d,v]},y.stepMinor=function(t){return arguments.length?(h=+t[0],p=+t[1],y):[h,p]},y.precision=function(h){return arguments.length?(_=+h,c=Yc(o,i,90),s=Bc(n,t,_),f=Yc(a,u,90),l=Bc(r,e,_),y):_},y.extentMajor([[-180,-90+uu],[180,90-uu]]).extentMinor([[-180,-80-uu],[180,80+uu]])}function jc(t){return t}var Xc,Vc,$c,Wc,Zc=eu(),Gc=eu(),Qc={point:Au,lineStart:Au,lineEnd:Au,polygonStart:function(){Qc.lineStart=Jc,Qc.lineEnd=ns},polygonEnd:function(){Qc.lineStart=Qc.lineEnd=Qc.point=Au,Zc.add(du(Gc)),Gc.reset()},result:function(){var t=Zc/2;return Zc.reset(),t}};function Jc(){Qc.point=Kc}function Kc(t,n){Qc.point=ts,Xc=$c=t,Vc=Wc=n}function ts(t,n){Gc.add(Wc*t-$c*n),$c=t,Wc=n}function ns(){ts(Xc,Vc)}var es=1/0,rs=es,is=-es,os=is,us={point:function(t,n){t<es&&(es=t);t>is&&(is=t);n<rs&&(rs=n);n>os&&(os=n)},lineStart:Au,lineEnd:Au,polygonStart:Au,polygonEnd:Au,result:function(){var t=[[es,rs],[is,os]];return is=os=-(rs=es=1/0),t}};var as,cs,ss,fs,ls=0,hs=0,ps=0,ds=0,vs=0,gs=0,_s=0,ys=0,ms=0,xs={point:bs,lineStart:ws,lineEnd:Ns,polygonStart:function(){xs.lineStart=ks,xs.lineEnd=Ss},polygonEnd:function(){xs.point=bs,xs.lineStart=ws,xs.lineEnd=Ns},result:function(){var t=ms?[_s/ms,ys/ms]:gs?[ds/gs,vs/gs]:ps?[ls/ps,hs/ps]:[NaN,NaN];return ls=hs=ps=ds=vs=gs=_s=ys=ms=0,t}};function bs(t,n){ls+=t,hs+=n,++ps}function ws(){xs.point=Ms}function Ms(t,n){xs.point=Ts,bs(ss=t,fs=n)}function Ts(t,n){var e=t-ss,r=n-fs,i=Tu(e*e+r*r);ds+=i*(ss+t)/2,vs+=i*(fs+n)/2,gs+=i,bs(ss=t,fs=n)}function Ns(){xs.point=bs}function ks(){xs.point=Es}function Ss(){As(as,cs)}function Es(t,n){xs.point=As,bs(as=ss=t,cs=fs=n)}function As(t,n){var e=t-ss,r=n-fs,i=Tu(e*e+r*r);ds+=i*(ss+t)/2,vs+=i*(fs+n)/2,gs+=i,_s+=(i=fs*t-ss*n)*(ss+t),ys+=i*(fs+n),ms+=3*i,bs(ss=t,fs=n)}function Cs(t){this._context=t}Cs.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,lu)}},result:Au};var zs,Ps,Rs,Ls,qs,Ds=eu(),Us={point:Au,lineStart:function(){Us.point=Os},lineEnd:function(){zs&&Fs(Ps,Rs),Us.point=Au},polygonStart:function(){zs=!0},polygonEnd:function(){zs=null},result:function(){var t=+Ds;return Ds.reset(),t}};function Os(t,n){Us.point=Fs,Ps=Ls=t,Rs=qs=n}function Fs(t,n){Ls-=t,qs-=n,Ds.add(Tu(Ls*Ls+qs*qs)),Ls=t,qs=n}function Is(){this._string=[]}function Ys(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Bs(t){return function(n){var e=new Hs;for(var r in t)e[r]=t[r];return e.stream=n,e}}function Hs(){}function js(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),qu(e,t.stream(us)),n(us.result()),null!=r&&t.clipExtent(r),t}function Xs(t,n,e){return js(t,function(e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],o=Math.min(r/(e[1][0]-e[0][0]),i/(e[1][1]-e[0][1])),u=+n[0][0]+(r-o*(e[1][0]+e[0][0]))/2,a=+n[0][1]+(i-o*(e[1][1]+e[0][1]))/2;t.scale(150*o).translate([u,a])},e)}function Vs(t,n,e){return Xs(t,[[0,0],n],e)}function $s(t,n,e){return js(t,function(e){var r=+n,i=r/(e[1][0]-e[0][0]),o=(r-i*(e[1][0]+e[0][0]))/2,u=-i*e[0][1];t.scale(150*i).translate([o,u])},e)}function Ws(t,n,e){return js(t,function(e){var r=+n,i=r/(e[1][1]-e[0][1]),o=-i*e[0][0],u=(r-i*(e[1][1]+e[0][1]))/2;t.scale(150*i).translate([o,u])},e)}Is.prototype={_radius:4.5,_circle:Ys(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=Ys(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Hs.prototype={constructor:Hs,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Zs=16,Gs=_u(30*pu);function Qs(t,n){return+n?function(t,n){function e(r,i,o,u,a,c,s,f,l,h,p,d,v,g){var _=s-r,y=f-i,m=_*_+y*y;if(m>4*n&&v--){var x=u+h,b=a+p,w=c+d,M=Tu(x*x+b*b+w*w),T=Su(w/=M),N=du(du(w)-1)<uu||du(o-l)<uu?(o+l)/2:gu(b,x),k=t(N,T),S=k[0],E=k[1],A=S-r,C=E-i,z=y*A-_*C;(z*z/m>n||du((_*A+y*C)/m-.5)>.3||u*h+a*p+c*d<Gs)&&(e(r,i,o,u,a,c,S,E,N,x/=M,b/=M,w,v,g),g.point(S,E),e(S,E,N,x,b,w,s,f,l,h,p,d,v,g))}}return function(n){var r,i,o,u,a,c,s,f,l,h,p,d,v={point:g,lineStart:_,lineEnd:m,polygonStart:function(){n.polygonStart(),v.lineStart=x},polygonEnd:function(){n.polygonEnd(),v.lineStart=_}};function g(e,r){e=t(e,r),n.point(e[0],e[1])}function _(){f=NaN,v.point=y,n.lineStart()}function y(r,i){var o=ra([r,i]),u=t(r,i);e(f,l,s,h,p,d,f=u[0],l=u[1],s=r,h=o[0],p=o[1],d=o[2],Zs,n),n.point(f,l)}function m(){v.point=g,n.lineEnd()}function x(){_(),v.point=b,v.lineEnd=w}function b(t,n){y(r=t,n),i=f,o=l,u=h,a=p,c=d,v.point=y}function w(){e(f,l,s,h,p,d,i,o,r,u,a,c,Zs,n),v.lineEnd=m,m()}return v}}(t,n):function(t){return Bs({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}(t)}var Js=Bs({point:function(t,n){this.stream.point(t*pu,n*pu)}});function Ks(t){return tf(function(){return t})()}function tf(t){var n,e,r,i,o,u,a,c,s,f,l=150,h=480,p=250,d=0,v=0,g=0,_=0,y=0,m=null,x=gc,b=null,w=jc,M=.5,T=Qs(S,M);function N(t){return[(t=o(t[0]*pu,t[1]*pu))[0]*l+e,r-t[1]*l]}function k(t){return(t=o.invert((t[0]-e)/l,(r-t[1])/l))&&[t[0]*hu,t[1]*hu]}function S(t,i){return[(t=n(t,i))[0]*l+e,r-t[1]*l]}function E(){o=Qa(i=Ka(g,_,y),n);var t=n(d,v);return e=h-t[0]*l,r=p+t[1]*l,A()}function A(){return s=f=null,N}return N.stream=function(t){return s&&f===t?s:s=Js(function(t){return Bs({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}(i)(x(T(w(f=t)))))},N.preclip=function(t){return arguments.length?(x=t,m=void 0,A()):x},N.postclip=function(t){return arguments.length?(w=t,b=u=a=c=null,A()):w},N.clipAngle=function(t){return arguments.length?(x=+t?_c(m=t*pu):(m=null,gc),A()):m*hu},N.clipExtent=function(t){return arguments.length?(w=null==t?(b=u=a=c=null,jc):xc(b=+t[0][0],u=+t[0][1],a=+t[1][0],c=+t[1][1]),A()):null==b?null:[[b,u],[a,c]]},N.scale=function(t){return arguments.length?(l=+t,E()):l},N.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],E()):[h,p]},N.center=function(t){return arguments.length?(d=t[0]%360*pu,v=t[1]%360*pu,E()):[d*hu,v*hu]},N.rotate=function(t){return arguments.length?(g=t[0]%360*pu,_=t[1]%360*pu,y=t.length>2?t[2]%360*pu:0,E()):[g*hu,_*hu,y*hu]},N.precision=function(t){return arguments.length?(T=Qs(S,M=t*t),A()):Tu(M)},N.fitExtent=function(t,n){return Xs(N,t,n)},N.fitSize=function(t,n){return Vs(N,t,n)},N.fitWidth=function(t,n){return $s(N,t,n)},N.fitHeight=function(t,n){return Ws(N,t,n)},function(){return n=t.apply(this,arguments),N.invert=n.invert&&k,E()}}function nf(t){var n=0,e=cu/3,r=tf(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*pu,e=t[1]*pu):[n*hu,e*hu]},i}function ef(t,n){var e=wu(t),r=(e+wu(n))/2;if(du(r)<uu)return function(t){var n=_u(t);function e(t,e){return[t*n,wu(e)/n]}return e.invert=function(t,e){return[t/n,Su(e*n)]},e}(t);var i=1+e*(2*r-e),o=Tu(i)/r;function u(t,n){var e=Tu(i-2*r*wu(n))/r;return[e*wu(t*=r),o-e*_u(t)]}return u.invert=function(t,n){var e=o-n;return[gu(t,du(e))/r*Mu(e),Su((i-(t*t+e*e)*r*r)/(2*r))]},u}function rf(){return nf(ef).scale(155.424).center([0,33.6442])}function of(){return rf().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function uf(t){return function(n,e){var r=_u(n),i=_u(e),o=t(r*i);return[o*i*wu(n),o*wu(e)]}}function af(t){return function(n,e){var r=Tu(n*n+e*e),i=t(r),o=wu(i),u=_u(i);return[gu(n*o,r*u),Su(r&&e*o/r)]}}var cf=uf(function(t){return Tu(2/(1+t))});cf.invert=af(function(t){return 2*Su(t/2)});var sf=uf(function(t){return(t=ku(t))&&t/wu(t)});function ff(t,n){return[t,xu(Nu((su+n)/2))]}function lf(t){var n,e,r,i=Ks(t),o=i.center,u=i.scale,a=i.translate,c=i.clipExtent,s=null;function f(){var o=cu*u(),a=i(rc(i.rotate()).invert([0,0]));return c(null==s?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===ff?[[Math.max(a[0]-o,s),n],[Math.min(a[0]+o,e),r]]:[[s,Math.max(a[1]-o,n)],[e,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(u(t),f()):u()},i.translate=function(t){return arguments.length?(a(t),f()):a()},i.center=function(t){return arguments.length?(o(t),f()):o()},i.clipExtent=function(t){return arguments.length?(null==t?s=n=e=r=null:(s=+t[0][0],n=+t[0][1],e=+t[1][0],r=+t[1][1]),f()):null==s?null:[[s,n],[e,r]]},f()}function hf(t){return Nu((su+t)/2)}function pf(t,n){var e=_u(t),r=t===n?wu(t):xu(e/_u(n))/xu(hf(n)/hf(t)),i=e*bu(hf(t),r)/r;if(!r)return ff;function o(t,n){i>0?n<-su+uu&&(n=-su+uu):n>su-uu&&(n=su-uu);var e=i/bu(hf(n),r);return[e*wu(r*t),i-e*_u(r*t)]}return o.invert=function(t,n){var e=i-n,o=Mu(r)*Tu(t*t+e*e);return[gu(t,du(e))/r*Mu(e),2*vu(bu(i/o,1/r))-su]},o}function df(t,n){return[t,n]}function vf(t,n){var e=_u(t),r=t===n?wu(t):(e-_u(n))/(n-t),i=e/r+t;if(du(r)<uu)return df;function o(t,n){var e=i-n,o=r*t;return[e*wu(o),i-e*_u(o)]}return o.invert=function(t,n){var e=i-n;return[gu(t,du(e))/r*Mu(e),i-Mu(r)*Tu(t*t+e*e)]},o}function gf(t,n){var e=_u(n),r=_u(t)*e;return[e*wu(t)/r,wu(n)/r]}function _f(t,n,e,r){return 1===t&&1===n&&0===e&&0===r?jc:Bs({point:function(i,o){this.stream.point(i*t+e,o*n+r)}})}function yf(t,n){var e=n*n,r=e*e;return[t*(.8707-.131979*e+r*(r*(.003971*e-.001529*r)-.013791)),n*(1.007226+e*(.015085+r*(.028874*e-.044475-.005916*r)))]}function mf(t,n){return[_u(n)*wu(t),wu(n)]}function xf(t,n){var e=_u(n),r=1+_u(t)*e;return[e*wu(t)/r,wu(n)/r]}function bf(t,n){return[xu(Nu((su+n)/2)),-t]}function wf(t,n){return t.parent===n.parent?1:2}function Mf(t,n){return t+n.x}function Tf(t,n){return Math.max(t,n.y)}function Nf(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function kf(t,n){var e,r,i,o,u,a=new Cf(t),c=+t.value&&(a.value=t.value),s=[a];for(null==n&&(n=Sf);e=s.pop();)if(c&&(e.value=+e.data.value),(i=n(e.data))&&(u=i.length))for(e.children=new Array(u),o=u-1;o>=0;--o)s.push(r=e.children[o]=new Cf(i[o])),r.parent=e,r.depth=e.depth+1;return a.eachBefore(Af)}function Sf(t){return t.children}function Ef(t){t.data=t.data.data}function Af(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function Cf(t){this.data=t,this.depth=this.height=0,this.parent=null}sf.invert=af(function(t){return t}),ff.invert=function(t,n){return[t,2*vu(mu(n))-su]},df.invert=df,gf.invert=af(vu),yf.invert=function(t,n){var e,r=n,i=25;do{var o=r*r,u=o*o;r-=e=(r*(1.007226+o*(.015085+u*(.028874*o-.044475-.005916*u)))-n)/(1.007226+o*(.045255+u*(.259866*o-.311325-.005916*11*u)))}while(du(e)>uu&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},mf.invert=af(Su),xf.invert=af(function(t){return 2*vu(t)}),bf.invert=function(t,n){return[-n,2*vu(mu(t))-su]},Cf.prototype=kf.prototype={constructor:Cf,count:function(){return this.eachAfter(Nf)},each:function(t){var n,e,r,i,o=this,u=[o];do{for(n=u.reverse(),u=[];o=n.pop();)if(t(o),e=o.children)for(r=0,i=e.length;r<i;++r)u.push(e[r])}while(u.length);return this},eachAfter:function(t){for(var n,e,r,i=this,o=[i],u=[];i=o.pop();)if(u.push(i),n=i.children)for(e=0,r=n.length;e<r;++e)o.push(n[e]);for(;i=u.pop();)t(i);return this},eachBefore:function(t){for(var n,e,r=this,i=[r];r=i.pop();)if(t(r),n=r.children)for(e=n.length-1;e>=0;--e)i.push(n[e]);return this},sum:function(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e})},sort:function(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;for(t=e.pop(),n=r.pop();t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){var t=[];return this.each(function(n){t.push(n)}),t},leaves:function(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t},links:function(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n},copy:function(){return kf(this).eachBefore(Ef)}};var zf=Array.prototype.slice;function Pf(t){for(var n,e,r=0,i=(t=function(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}(zf.call(t))).length,o=[];r<i;)n=t[r],e&&qf(e,n)?++r:(e=Uf(o=Rf(o,n)),r=0);return e}function Rf(t,n){var e,r;if(Df(n,t))return[n];for(e=0;e<t.length;++e)if(Lf(n,t[e])&&Df(Of(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(Lf(Of(t[e],t[r]),n)&&Lf(Of(t[e],n),t[r])&&Lf(Of(t[r],n),t[e])&&Df(Ff(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function Lf(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function qf(t,n){var e=t.r-n.r+1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Df(t,n){for(var e=0;e<n.length;++e)if(!qf(t,n[e]))return!1;return!0}function Uf(t){switch(t.length){case 1:return{x:(n=t[0]).x,y:n.y,r:n.r};case 2:return Of(t[0],t[1]);case 3:return Ff(t[0],t[1],t[2])}var n}function Of(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,u=n.y,a=n.r,c=o-e,s=u-r,f=a-i,l=Math.sqrt(c*c+s*s);return{x:(e+o+c/l*f)/2,y:(r+u+s/l*f)/2,r:(l+i+a)/2}}function Ff(t,n,e){var r=t.x,i=t.y,o=t.r,u=n.x,a=n.y,c=n.r,s=e.x,f=e.y,l=e.r,h=r-u,p=r-s,d=i-a,v=i-f,g=c-o,_=l-o,y=r*r+i*i-o*o,m=y-u*u-a*a+c*c,x=y-s*s-f*f+l*l,b=p*d-h*v,w=(d*x-v*m)/(2*b)-r,M=(v*g-d*_)/b,T=(p*m-h*x)/(2*b)-i,N=(h*_-p*g)/b,k=M*M+N*N-1,S=2*(o+w*M+T*N),E=w*w+T*T-o*o,A=-(k?(S+Math.sqrt(S*S-4*k*E))/(2*k):E/S);return{x:r+w+M*A,y:i+T+N*A,r:A}}function If(t,n,e){var r=t.x,i=t.y,o=n.r+e.r,u=t.r+e.r,a=n.x-r,c=n.y-i,s=a*a+c*c;if(s){var f=.5+((u*=u)-(o*=o))/(2*s),l=Math.sqrt(Math.max(0,2*o*(u+s)-(u-=s)*u-o*o))/(2*s);e.x=r+f*a+l*c,e.y=i+f*c-l*a}else e.x=r+u,e.y=i}function Yf(t,n){var e=n.x-t.x,r=n.y-t.y,i=t.r+n.r;return i*i-1e-6>e*e+r*r}function Bf(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,o=(n.y*e.r+e.y*n.r)/r;return i*i+o*o}function Hf(t){this._=t,this.next=null,this.previous=null}function jf(t){if(!(i=t.length))return 0;var n,e,r,i,o,u,a,c,s,f,l;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;If(e,n,r=t[2]),n=new Hf(n),e=new Hf(e),r=new Hf(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(a=3;a<i;++a){If(n._,e._,r=t[a]),r=new Hf(r),c=e.next,s=n.previous,f=e._.r,l=n._.r;do{if(f<=l){if(Yf(c._,r._)){e=c,n.next=e,e.previous=n,--a;continue t}f+=c._.r,c=c.next}else{if(Yf(s._,r._)){(n=s).next=e,e.previous=n,--a;continue t}l+=s._.r,s=s.previous}}while(c!==s.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,o=Bf(n);(r=r.next)!==e;)(u=Bf(r))<o&&(n=r,o=u);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=Pf(n),a=0;a<i;++a)(n=t[a]).x-=r.x,n.y-=r.y;return r.r}function Xf(t){if("function"!=typeof t)throw new Error;return t}function Vf(){return 0}function $f(t){return function(){return t}}function Wf(t){return Math.sqrt(t.value)}function Zf(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function Gf(t,n){return function(e){if(r=e.children){var r,i,o,u=r.length,a=t(e)*n||0;if(a)for(i=0;i<u;++i)r[i].r+=a;if(o=jf(r),a)for(i=0;i<u;++i)r[i].r-=a;e.r=o+a}}}function Qf(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function Jf(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Kf(t,n,e,r,i){for(var o,u=t.children,a=-1,c=u.length,s=t.value&&(r-n)/t.value;++a<c;)(o=u[a]).y0=e,o.y1=i,o.x0=n,o.x1=n+=o.value*s}var tl="$",nl={depth:-1},el={};function rl(t){return t.id}function il(t){return t.parentId}function ol(t,n){return t.parent===n.parent?1:2}function ul(t){var n=t.children;return n?n[0]:t.t}function al(t){var n=t.children;return n?n[n.length-1]:t.t}function cl(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function sl(t,n,e){return t.a.parent===n.parent?t.a:e}function fl(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function ll(t,n,e,r,i){for(var o,u=t.children,a=-1,c=u.length,s=t.value&&(i-e)/t.value;++a<c;)(o=u[a]).x0=n,o.x1=r,o.y0=e,o.y1=e+=o.value*s}fl.prototype=Object.create(Cf.prototype);var hl=(1+Math.sqrt(5))/2;function pl(t,n,e,r,i,o){for(var u,a,c,s,f,l,h,p,d,v,g,_=[],y=n.children,m=0,x=0,b=y.length,w=n.value;m<b;){c=i-e,s=o-r;do{f=y[x++].value}while(!f&&x<b);for(l=h=f,g=f*f*(v=Math.max(s/c,c/s)/(w*t)),d=Math.max(h/g,g/l);x<b;++x){if(f+=a=y[x].value,a<l&&(l=a),a>h&&(h=a),g=f*f*v,(p=Math.max(h/g,g/l))>d){f-=a;break}d=p}_.push(u={value:f,dice:c<s,children:y.slice(m,x)}),u.dice?Kf(u,e,r,i,w?r+=s*f/w:o):ll(u,e,r,w?e+=c*f/w:i,o),w-=f,m=x}return _}var dl=function t(n){function e(t,e,r,i,o){pl(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(hl);var vl=function t(n){function e(t,e,r,i,o){if((u=t._squarify)&&u.ratio===n)for(var u,a,c,s,f,l=-1,h=u.length,p=t.value;++l<h;){for(c=(a=u[l]).children,s=a.value=0,f=c.length;s<f;++s)a.value+=c[s].value;a.dice?Kf(a,e,r,i,r+=(o-r)*a.value/p):ll(a,e,r,e+=(i-e)*a.value/p,o),p-=a.value}else t._squarify=u=pl(n,t,e,r,i,o),u.ratio=n}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(hl);function gl(t,n){return t[0]-n[0]||t[1]-n[1]}function _l(t){for(var n,e,r,i=t.length,o=[0,1],u=2,a=2;a<i;++a){for(;u>1&&(n=t[o[u-2]],e=t[o[u-1]],r=t[a],(e[0]-n[0])*(r[1]-n[1])-(e[1]-n[1])*(r[0]-n[0])<=0);)--u;o[u++]=a}return o.slice(0,u)}var yl=[].slice,ml={};function xl(t){this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function bl(t){if(!t._start)try{!function(t){for(;t._start=t._waiting&&t._active<t._size;){var n=t._ended+t._active,e=t._tasks[n],r=e.length-1,i=e[r];e[r]=wl(t,n),--t._waiting,++t._active,e=i.apply(null,e),t._tasks[n]&&(t._tasks[n]=e||ml)}}(t)}catch(n){if(t._tasks[t._ended+t._active-1])Ml(t,n);else if(!t._data)throw n}}function wl(t,n){return function(e,r){t._tasks[n]&&(--t._active,++t._ended,t._tasks[n]=null,null==t._error&&(null!=e?Ml(t,e):(t._data[n]=r,t._waiting?bl(t):Tl(t))))}}function Ml(t,n){var e,r=t._tasks.length;for(t._error=n,t._data=void 0,t._waiting=NaN;--r>=0;)if((e=t._tasks[r])&&(t._tasks[r]=null,e.abort))try{e.abort()}catch(n){}t._active=NaN,Tl(t)}function Tl(t){if(!t._active&&t._call){var n=t._data;t._data=void 0,t._call(t._error,n)}}function Nl(t){if(null==t)t=1/0;else if(!((t=+t)>=1))throw new Error("invalid concurrency");return new xl(t)}function kl(){return Math.random()}xl.prototype=Nl.prototype={constructor:xl,defer:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var n=yl.call(arguments,1);return n.push(t),++this._waiting,this._tasks.push(n),bl(this),this},abort:function(){return null==this._error&&Ml(this,new Error("abort")),this},await:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(n,e){t.apply(null,[n].concat(e))},Tl(this),this},awaitAll:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=t,Tl(this),this}};var Sl=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(kl),El=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var o;if(null!=r)o=r,r=null;else do{r=2*n()-1,o=2*n()-1,i=r*r+o*o}while(!i||i>1);return t+e*o*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}(kl),Al=function t(n){function e(){var t=El.source(n).apply(this,arguments);return function(){return Math.exp(t())}}return e.source=t,e}(kl),Cl=function t(n){function e(t){return function(){for(var e=0,r=0;r<t;++r)e+=n();return e}}return e.source=t,e}(kl),zl=function t(n){function e(t){var e=Cl.source(n)(t);return function(){return e()/t}}return e.source=t,e}(kl),Pl=function t(n){function e(t){return function(){return-Math.log(1-n())/t}}return e.source=t,e}(kl);function Rl(t,n){var e,r,i,o,u=Y("beforesend","progress","load","error"),a=Gi(),c=new XMLHttpRequest,s=null,f=null,l=0;function h(t){var n,r=c.status;if(!r&&function(t){var n=t.responseType;return n&&"text"!==n?t.response:t.responseText}(c)||r>=200&&r<300||304===r){if(i)try{n=i.call(e,c)}catch(t){return void u.call("error",e,t)}else n=c;u.call("load",e,n)}else u.call("error",e,t)}if("undefined"==typeof XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(t)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=c.ontimeout=h:c.onreadystatechange=function(t){c.readyState>3&&h(t)},c.onprogress=function(t){u.call("progress",e,t)},e={header:function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?a.get(t):(null==n?a.remove(t):a.set(t,n+""),e)},mimeType:function(t){return arguments.length?(r=null==t?null:t+"",e):r},responseType:function(t){return arguments.length?(o=t,e):o},timeout:function(t){return arguments.length?(l=+t,e):l},user:function(t){return arguments.length<1?s:(s=null==t?null:t+"",e)},password:function(t){return arguments.length<1?f:(f=null==t?null:t+"",e)},response:function(t){return i=t,e},get:function(t,n){return e.send("GET",t,n)},post:function(t,n){return e.send("POST",t,n)},send:function(n,i,h){return c.open(n,t,!0,s,f),null==r||a.has("accept")||a.set("accept",r+",*/*"),c.setRequestHeader&&a.each(function(t,n){c.setRequestHeader(n,t)}),null!=r&&c.overrideMimeType&&c.overrideMimeType(r),null!=o&&(c.responseType=o),l>0&&(c.timeout=l),null==h&&"function"==typeof i&&(h=i,i=null),null!=h&&1===h.length&&(h=function(t){return function(n,e){t(null==n?e:null)}}(h)),null!=h&&e.on("error",h).on("load",function(t){h(null,t)}),u.call("beforesend",e,c),c.send(null==i?null:i),e},abort:function(){return c.abort(),e},on:function(){var t=u.on.apply(u,arguments);return t===u?e:t}},null!=n){if("function"!=typeof n)throw new Error("invalid callback: "+n);return e.get(n)}return e}function Ll(t,n){return function(e,r){var i=Rl(e).mimeType(t).response(n);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return i.get(r)}return i}}var ql=Ll("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),Dl=Ll("application/json",function(t){return JSON.parse(t.responseText)}),Ul=Ll("text/plain",function(t){return t.responseText}),Ol=Ll("application/xml",function(t){var n=t.responseXML;if(!n)throw new Error("parse error");return n});function Fl(t,n){return function(e,r,i){arguments.length<3&&(i=r,r=null);var o=Rl(e).mimeType(t);return o.row=function(t){return arguments.length?o.response(function(t,n){return function(e){return t(e.responseText,n)}}(n,r=t)):r},o.row(r),i?o.get(i):o}}var Il=Fl("text/csv",ho),Yl=Fl("text/tab-separated-values",yo),Bl=Array.prototype,Hl=Bl.map,jl=Bl.slice,Xl={name:"implicit"};function Vl(t){var n=Gi(),e=[],r=Xl;function i(i){var o=i+"",u=n.get(o);if(!u){if(r!==Xl)return r;n.set(o,u=e.push(i))}return t[(u-1)%t.length]}return t=null==t?[]:jl.call(t),i.domain=function(t){if(!arguments.length)return e.slice();e=[],n=Gi();for(var r,o,u=-1,a=t.length;++u<a;)n.has(o=(r=t[u])+"")||n.set(o,e.push(r));return i},i.range=function(n){return arguments.length?(t=jl.call(n),i):t.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Vl().domain(e).range(t).unknown(r)},i}function $l(){var t,n,e=Vl().unknown(void 0),r=e.domain,i=e.range,o=[0,1],u=!1,a=0,c=0,s=.5;function f(){var e=r().length,f=o[1]<o[0],l=o[f-0],h=o[1-f];t=(h-l)/Math.max(1,e-a+2*c),u&&(t=Math.floor(t)),l+=(h-l-t*(e-a))*s,n=t*(1-a),u&&(l=Math.round(l),n=Math.round(n));var p=g(e).map(function(n){return l+t*n});return i(f?p.reverse():p)}return delete e.unknown,e.domain=function(t){return arguments.length?(r(t),f()):r()},e.range=function(t){return arguments.length?(o=[+t[0],+t[1]],f()):o.slice()},e.rangeRound=function(t){return o=[+t[0],+t[1]],u=!0,f()},e.bandwidth=function(){return n},e.step=function(){return t},e.round=function(t){return arguments.length?(u=!!t,f()):u},e.padding=function(t){return arguments.length?(a=c=Math.max(0,Math.min(1,t)),f()):a},e.paddingInner=function(t){return arguments.length?(a=Math.max(0,Math.min(1,t)),f()):a},e.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),f()):c},e.align=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),f()):s},e.copy=function(){return $l().domain(r()).range(o).round(u).paddingInner(a).paddingOuter(c).align(s)},f()}function Wl(t){return function(){return t}}function Zl(t){return+t}var Gl=[0,1];function Ql(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:Wl(n)}function Jl(t,n,e,r){var i=t[0],o=t[1],u=n[0],a=n[1];return o<i?(i=e(o,i),u=r(a,u)):(i=e(i,o),u=r(u,a)),function(t){return u(i(t))}}function Kl(t,n,e,r){var o=Math.min(t.length,n.length)-1,u=new Array(o),a=new Array(o),c=-1;for(t[o]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++c<o;)u[c]=e(t[c],t[c+1]),a[c]=r(n[c],n[c+1]);return function(n){var e=i(t,n,1,o)-1;return a[e](u[e](n))}}function th(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function nh(t,n){var e,r,i,o=Gl,u=Gl,a=_e,c=!1;function s(){return e=Math.min(o.length,u.length)>2?Kl:Jl,r=i=null,f}function f(n){return(r||(r=e(o,u,c?function(t){return function(n,e){var r=t(n=+n,e=+e);return function(t){return t<=n?0:t>=e?1:r(t)}}}(t):t,a)))(+n)}return f.invert=function(t){return(i||(i=e(u,o,Ql,c?function(t){return function(n,e){var r=t(n=+n,e=+e);return function(t){return t<=0?n:t>=1?e:r(t)}}}(n):n)))(+t)},f.domain=function(t){return arguments.length?(o=Hl.call(t,Zl),s()):o.slice()},f.range=function(t){return arguments.length?(u=jl.call(t),s()):u.slice()},f.rangeRound=function(t){return u=jl.call(t),a=ye,s()},f.clamp=function(t){return arguments.length?(c=!!t,s()):c},f.interpolate=function(t){return arguments.length?(a=t,s()):a},s()}function eh(n){var e=n.domain;return n.ticks=function(t){var n=e();return x(n[0],n[n.length-1],null==t?10:t)},n.tickFormat=function(n,r){return function(n,e,r){var i,o=n[0],u=n[n.length-1],a=w(o,u,null==e?10:e);switch((r=Vo(null==r?",f":r)).type){case"s":var c=Math.max(Math.abs(o),Math.abs(u));return null!=r.precision||isNaN(i=tu(a,c))||(r.precision=i),t.formatPrefix(r,c);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=nu(a,Math.max(Math.abs(o),Math.abs(u))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Ko(a))||(r.precision=i-2*("%"===r.type))}return t.format(r)}(e(),n,r)},n.nice=function(t){null==t&&(t=10);var r,i=e(),o=0,u=i.length-1,a=i[o],c=i[u];return c<a&&(r=a,a=c,c=r,r=o,o=u,u=r),(r=b(a,c,t))>0?r=b(a=Math.floor(a/r)*r,c=Math.ceil(c/r)*r,t):r<0&&(r=b(a=Math.ceil(a*r)/r,c=Math.floor(c*r)/r,t)),r>0?(i[o]=Math.floor(a/r)*r,i[u]=Math.ceil(c/r)*r,e(i)):r<0&&(i[o]=Math.ceil(a*r)/r,i[u]=Math.floor(c*r)/r,e(i)),n},n}function rh(t,n){var e,r=0,i=(t=t.slice()).length-1,o=t[r],u=t[i];return u<o&&(e=r,r=i,i=e,e=o,o=u,u=e),t[r]=n.floor(o),t[i]=n.ceil(u),t}function ih(t,n){return(n=Math.log(n/t))?function(e){return Math.log(e/t)/n}:Wl(n)}function oh(t,n){return t<0?function(e){return-Math.pow(-n,e)*Math.pow(-t,1-e)}:function(e){return Math.pow(n,e)*Math.pow(t,1-e)}}function uh(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ah(t){return 10===t?uh:t===Math.E?Math.exp:function(n){return Math.pow(t,n)}}function ch(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(n){return Math.log(n)/t})}function sh(t){return function(n){return-t(-n)}}function fh(t,n){return t<0?-Math.pow(-t,n):Math.pow(t,n)}function lh(){var t=1,n=nh(function(n,e){return(e=fh(e,t)-(n=fh(n,t)))?function(r){return(fh(r,t)-n)/e}:Wl(e)},function(n,e){return e=fh(e,t)-(n=fh(n,t)),function(r){return fh(n+e*r,1/t)}}),e=n.domain;return n.exponent=function(n){return arguments.length?(t=+n,e(e())):t},n.copy=function(){return th(n,lh().exponent(t))},eh(n)}var hh=new Date,ph=new Date;function dh(t,n,e,r){function i(n){return t(n=new Date(+n)),n}return i.floor=i,i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,o){var u,a=[];if(e=i.ceil(e),o=null==o?1:Math.floor(o),!(e<r&&o>0))return a;do{a.push(u=new Date(+e)),n(e,o),t(e)}while(u<e&&e<r);return a},i.filter=function(e){return dh(function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););})},e&&(i.count=function(n,r){return hh.setTime(+n),ph.setTime(+r),t(hh),t(ph),Math.floor(e(hh,ph))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var vh=dh(function(){},function(t,n){t.setTime(+t+n)},function(t,n){return n-t});vh.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?dh(function(n){n.setTime(Math.floor(n/t)*t)},function(n,e){n.setTime(+n+e*t)},function(n,e){return(e-n)/t}):vh:null};var gh=vh.range,_h=6e4,yh=6048e5,mh=dh(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,n){t.setTime(+t+1e3*n)},function(t,n){return(n-t)/1e3},function(t){return t.getUTCSeconds()}),xh=mh.range,bh=dh(function(t){t.setTime(Math.floor(t/_h)*_h)},function(t,n){t.setTime(+t+n*_h)},function(t,n){return(n-t)/_h},function(t){return t.getMinutes()}),wh=bh.range,Mh=dh(function(t){var n=t.getTimezoneOffset()*_h%36e5;n<0&&(n+=36e5),t.setTime(36e5*Math.floor((+t-n)/36e5)+n)},function(t,n){t.setTime(+t+36e5*n)},function(t,n){return(n-t)/36e5},function(t){return t.getHours()}),Th=Mh.range,Nh=dh(function(t){t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*_h)/864e5},function(t){return t.getDate()-1}),kh=Nh.range;function Sh(t){return dh(function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*_h)/yh})}var Eh=Sh(0),Ah=Sh(1),Ch=Sh(2),zh=Sh(3),Ph=Sh(4),Rh=Sh(5),Lh=Sh(6),qh=Eh.range,Dh=Ah.range,Uh=Ch.range,Oh=zh.range,Fh=Ph.range,Ih=Rh.range,Yh=Lh.range,Bh=dh(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,n){t.setMonth(t.getMonth()+n)},function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),Hh=Bh.range,jh=dh(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n)},function(t,n){return n.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});jh.every=function(t){return isFinite(t=Math.floor(t))&&t>0?dh(function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e*t)}):null};var Xh=jh.range,Vh=dh(function(t){t.setUTCSeconds(0,0)},function(t,n){t.setTime(+t+n*_h)},function(t,n){return(n-t)/_h},function(t){return t.getUTCMinutes()}),$h=Vh.range,Wh=dh(function(t){t.setUTCMinutes(0,0,0)},function(t,n){t.setTime(+t+36e5*n)},function(t,n){return(n-t)/36e5},function(t){return t.getUTCHours()}),Zh=Wh.range,Gh=dh(function(t){t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n)},function(t,n){return(n-t)/864e5},function(t){return t.getUTCDate()-1}),Qh=Gh.range;function Jh(t){return dh(function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/yh})}var Kh=Jh(0),tp=Jh(1),np=Jh(2),ep=Jh(3),rp=Jh(4),ip=Jh(5),op=Jh(6),up=Kh.range,ap=tp.range,cp=np.range,sp=ep.range,fp=rp.range,lp=ip.range,hp=op.range,pp=dh(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCMonth(t.getUTCMonth()+n)},function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),dp=pp.range,vp=dh(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)},function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});vp.every=function(t){return isFinite(t=Math.floor(t))&&t>0?dh(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)}):null};var gp=vp.range;function _p(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function yp(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function mp(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function xp(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,u=t.shortDays,a=t.months,c=t.shortMonths,s=Ep(i),f=Ap(i),l=Ep(o),h=Ap(o),p=Ep(u),d=Ap(u),v=Ep(a),g=Ap(a),_=Ep(c),y=Ap(c),m={a:function(t){return u[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:Zp,e:Zp,f:td,H:Gp,I:Qp,j:Jp,L:Kp,m:nd,M:ed,p:function(t){return i[+(t.getHours()>=12)]},Q:Cd,s:zd,S:rd,u:id,U:od,V:ud,w:ad,W:cd,x:null,X:null,y:sd,Y:fd,Z:ld,"%":Ad},x={a:function(t){return u[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:hd,e:hd,f:_d,H:pd,I:dd,j:vd,L:gd,m:yd,M:md,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:Cd,s:zd,S:xd,u:bd,U:wd,V:Md,w:Td,W:Nd,x:null,X:null,y:kd,Y:Sd,Z:Ed,"%":Ad},b={a:function(t,n,e){var r=p.exec(n.slice(e));return r?(t.w=d[r[0].toLowerCase()],e+r[0].length):-1},A:function(t,n,e){var r=l.exec(n.slice(e));return r?(t.w=h[r[0].toLowerCase()],e+r[0].length):-1},b:function(t,n,e){var r=_.exec(n.slice(e));return r?(t.m=y[r[0].toLowerCase()],e+r[0].length):-1},B:function(t,n,e){var r=v.exec(n.slice(e));return r?(t.m=g[r[0].toLowerCase()],e+r[0].length):-1},c:function(t,e,r){return T(t,n,e,r)},d:Fp,e:Fp,f:Xp,H:Yp,I:Yp,j:Ip,L:jp,m:Op,M:Bp,p:function(t,n,e){var r=s.exec(n.slice(e));return r?(t.p=f[r[0].toLowerCase()],e+r[0].length):-1},Q:$p,s:Wp,S:Hp,u:zp,U:Pp,V:Rp,w:Cp,W:Lp,x:function(t,n,r){return T(t,e,n,r)},X:function(t,n,e){return T(t,r,n,e)},y:Dp,Y:qp,Z:Up,"%":Vp};function w(t,n){return function(e){var r,i,o,u=[],a=-1,c=0,s=t.length;for(e instanceof Date||(e=new Date(+e));++a<s;)37===t.charCodeAt(a)&&(u.push(t.slice(c,a)),null!=(i=wp[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=n[r])&&(r=o(e,i)),u.push(r),c=a+1);return u.push(t.slice(c,a)),u.join("")}}function M(t,n){return function(e){var r,i,o=mp(1900);if(T(o,t,e+="",0)!=e.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=yp(mp(o.y))).getUTCDay(),r=i>4||0===i?tp.ceil(r):tp(r),r=Gh.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=n(mp(o.y))).getDay(),r=i>4||0===i?Ah.ceil(r):Ah(r),r=Nh.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?yp(mp(o.y)).getUTCDay():n(mp(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,yp(o)):n(o)}}function T(t,n,e,r){for(var i,o,u=0,a=n.length,c=e.length;u<a;){if(r>=c)return-1;if(37===(i=n.charCodeAt(u++))){if(i=n.charAt(u++),!(o=b[i in wp?n.charAt(u++):i])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return m.x=w(e,m),m.X=w(r,m),m.c=w(n,m),x.x=w(e,x),x.X=w(r,x),x.c=w(n,x),{format:function(t){var n=w(t+="",m);return n.toString=function(){return t},n},parse:function(t){var n=M(t+="",_p);return n.toString=function(){return t},n},utcFormat:function(t){var n=w(t+="",x);return n.toString=function(){return t},n},utcParse:function(t){var n=M(t,yp);return n.toString=function(){return t},n}}}var bp,wp={"-":"",_:" ",0:"0"},Mp=/^\s*\d+/,Tp=/^%/,Np=/[\\^$*+?|[\]().{}]/g;function kp(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function Sp(t){return t.replace(Np,"\\$&")}function Ep(t){return new RegExp("^(?:"+t.map(Sp).join("|")+")","i")}function Ap(t){for(var n={},e=-1,r=t.length;++e<r;)n[t[e].toLowerCase()]=e;return n}function Cp(t,n,e){var r=Mp.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function zp(t,n,e){var r=Mp.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function Pp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function Rp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function Lp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function qp(t,n,e){var r=Mp.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Dp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function Up(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function Op(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function Fp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function Ip(t,n,e){var r=Mp.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function Yp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function Bp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function Hp(t,n,e){var r=Mp.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function jp(t,n,e){var r=Mp.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function Xp(t,n,e){var r=Mp.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function Vp(t,n,e){var r=Tp.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function $p(t,n,e){var r=Mp.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function Wp(t,n,e){var r=Mp.exec(n.slice(e));return r?(t.Q=1e3*+r[0],e+r[0].length):-1}function Zp(t,n){return kp(t.getDate(),n,2)}function Gp(t,n){return kp(t.getHours(),n,2)}function Qp(t,n){return kp(t.getHours()%12||12,n,2)}function Jp(t,n){return kp(1+Nh.count(jh(t),t),n,3)}function Kp(t,n){return kp(t.getMilliseconds(),n,3)}function td(t,n){return Kp(t,n)+"000"}function nd(t,n){return kp(t.getMonth()+1,n,2)}function ed(t,n){return kp(t.getMinutes(),n,2)}function rd(t,n){return kp(t.getSeconds(),n,2)}function id(t){var n=t.getDay();return 0===n?7:n}function od(t,n){return kp(Eh.count(jh(t),t),n,2)}function ud(t,n){var e=t.getDay();return t=e>=4||0===e?Ph(t):Ph.ceil(t),kp(Ph.count(jh(t),t)+(4===jh(t).getDay()),n,2)}function ad(t){return t.getDay()}function cd(t,n){return kp(Ah.count(jh(t),t),n,2)}function sd(t,n){return kp(t.getFullYear()%100,n,2)}function fd(t,n){return kp(t.getFullYear()%1e4,n,4)}function ld(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+kp(n/60|0,"0",2)+kp(n%60,"0",2)}function hd(t,n){return kp(t.getUTCDate(),n,2)}function pd(t,n){return kp(t.getUTCHours(),n,2)}function dd(t,n){return kp(t.getUTCHours()%12||12,n,2)}function vd(t,n){return kp(1+Gh.count(vp(t),t),n,3)}function gd(t,n){return kp(t.getUTCMilliseconds(),n,3)}function _d(t,n){return gd(t,n)+"000"}function yd(t,n){return kp(t.getUTCMonth()+1,n,2)}function md(t,n){return kp(t.getUTCMinutes(),n,2)}function xd(t,n){return kp(t.getUTCSeconds(),n,2)}function bd(t){var n=t.getUTCDay();return 0===n?7:n}function wd(t,n){return kp(Kh.count(vp(t),t),n,2)}function Md(t,n){var e=t.getUTCDay();return t=e>=4||0===e?rp(t):rp.ceil(t),kp(rp.count(vp(t),t)+(4===vp(t).getUTCDay()),n,2)}function Td(t){return t.getUTCDay()}function Nd(t,n){return kp(tp.count(vp(t),t),n,2)}function kd(t,n){return kp(t.getUTCFullYear()%100,n,2)}function Sd(t,n){return kp(t.getUTCFullYear()%1e4,n,4)}function Ed(){return"+0000"}function Ad(){return"%"}function Cd(t){return+t}function zd(t){return Math.floor(+t/1e3)}function Pd(n){return bp=xp(n),t.timeFormat=bp.format,t.timeParse=bp.parse,t.utcFormat=bp.utcFormat,t.utcParse=bp.utcParse,bp}Pd({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Rd=Date.prototype.toISOString?function(t){return t.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ");var Ld=+new Date("2000-01-01T00:00:00.000Z")?function(t){var n=new Date(t);return isNaN(n)?null:n}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),qd=1e3,Dd=60*qd,Ud=60*Dd,Od=24*Ud,Fd=7*Od,Id=30*Od,Yd=365*Od;function Bd(t){return new Date(t)}function Hd(t){return t instanceof Date?+t:+new Date(+t)}function jd(t,n,r,i,o,u,a,c,s){var f=nh(Ql,he),l=f.invert,h=f.domain,p=s(".%L"),d=s(":%S"),v=s("%I:%M"),g=s("%I %p"),_=s("%a %d"),y=s("%b %d"),m=s("%B"),x=s("%Y"),b=[[a,1,qd],[a,5,5*qd],[a,15,15*qd],[a,30,30*qd],[u,1,Dd],[u,5,5*Dd],[u,15,15*Dd],[u,30,30*Dd],[o,1,Ud],[o,3,3*Ud],[o,6,6*Ud],[o,12,12*Ud],[i,1,Od],[i,2,2*Od],[r,1,Fd],[n,1,Id],[n,3,3*Id],[t,1,Yd]];function M(e){return(a(e)<e?p:u(e)<e?d:o(e)<e?v:i(e)<e?g:n(e)<e?r(e)<e?_:y:t(e)<e?m:x)(e)}function T(n,r,i,o){if(null==n&&(n=10),"number"==typeof n){var u=Math.abs(i-r)/n,a=e(function(t){return t[2]}).right(b,u);a===b.length?(o=w(r/Yd,i/Yd,n),n=t):a?(o=(a=b[u/b[a-1][2]<b[a][2]/u?a-1:a])[1],n=a[0]):(o=Math.max(w(r,i,n),1),n=c)}return null==o?n:n.every(o)}return f.invert=function(t){return new Date(l(t))},f.domain=function(t){return arguments.length?h(Hl.call(t,Hd)):h().map(Bd)},f.ticks=function(t,n){var e,r=h(),i=r[0],o=r[r.length-1],u=o<i;return u&&(e=i,i=o,o=e),e=(e=T(t,i,o,n))?e.range(i,o+1):[],u?e.reverse():e},f.tickFormat=function(t,n){return null==n?M:s(n)},f.nice=function(t,n){var e=h();return(t=T(t,e[0],e[e.length-1],n))?h(rh(e,t)):f},f.copy=function(){return th(f,jd(t,n,r,i,o,u,a,c,s))},f}function Xd(t){return t.match(/.{6}/g).map(function(t){return"#"+t})}var Vd=Xd("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),$d=Xd("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Wd=Xd("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Zd=Xd("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Gd=He(Gn(300,.5,0),Gn(-240,.5,1)),Qd=He(Gn(-100,.75,.35),Gn(80,1.5,.8)),Jd=He(Gn(260,.75,.35),Gn(80,1.5,.8)),Kd=Gn();function tv(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}var nv=tv(Xd("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ev=tv(Xd("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),rv=tv(Xd("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),iv=tv(Xd("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function ov(t){return function(){return t}}var uv=Math.abs,av=Math.atan2,cv=Math.cos,sv=Math.max,fv=Math.min,lv=Math.sin,hv=Math.sqrt,pv=1e-12,dv=Math.PI,vv=dv/2,gv=2*dv;function _v(t){return t>=1?vv:t<=-1?-vv:Math.asin(t)}function yv(t){return t.innerRadius}function mv(t){return t.outerRadius}function xv(t){return t.startAngle}function bv(t){return t.endAngle}function wv(t){return t&&t.padAngle}function Mv(t,n,e,r,i,o,u){var a=t-e,c=n-r,s=(u?o:-o)/hv(a*a+c*c),f=s*c,l=-s*a,h=t+f,p=n+l,d=e+f,v=r+l,g=(h+d)/2,_=(p+v)/2,y=d-h,m=v-p,x=y*y+m*m,b=i-o,w=h*v-d*p,M=(m<0?-1:1)*hv(sv(0,b*b*x-w*w)),T=(w*m-y*M)/x,N=(-w*y-m*M)/x,k=(w*m+y*M)/x,S=(-w*y+m*M)/x,E=T-g,A=N-_,C=k-g,z=S-_;return E*E+A*A>C*C+z*z&&(T=k,N=S),{cx:T,cy:N,x01:-f,y01:-l,x11:T*(i/b-1),y11:N*(i/b-1)}}function Tv(t){this._context=t}function Nv(t){return new Tv(t)}function kv(t){return t[0]}function Sv(t){return t[1]}function Ev(){var t=kv,n=Sv,e=ov(!0),r=null,i=Nv,o=null;function u(u){var a,c,s,f=u.length,l=!1;for(null==r&&(o=i(s=Hi())),a=0;a<=f;++a)!(a<f&&e(c=u[a],a,u))===l&&((l=!l)?o.lineStart():o.lineEnd()),l&&o.point(+t(c,a,u),+n(c,a,u));if(s)return o=null,s+""||null}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:ov(+n),u):t},u.y=function(t){return arguments.length?(n="function"==typeof t?t:ov(+t),u):n},u.defined=function(t){return arguments.length?(e="function"==typeof t?t:ov(!!t),u):e},u.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),u):i},u.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),u):r},u}function Av(){var t=kv,n=null,e=ov(0),r=Sv,i=ov(!0),o=null,u=Nv,a=null;function c(c){var s,f,l,h,p,d=c.length,v=!1,g=new Array(d),_=new Array(d);for(null==o&&(a=u(p=Hi())),s=0;s<=d;++s){if(!(s<d&&i(h=c[s],s,c))===v)if(v=!v)f=s,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),l=s-1;l>=f;--l)a.point(g[l],_[l]);a.lineEnd(),a.areaEnd()}v&&(g[s]=+t(h,s,c),_[s]=+e(h,s,c),a.point(n?+n(h,s,c):g[s],r?+r(h,s,c):_[s]))}if(p)return a=null,p+""||null}function s(){return Ev().defined(i).curve(u).context(o)}return c.x=function(e){return arguments.length?(t="function"==typeof e?e:ov(+e),n=null,c):t},c.x0=function(n){return arguments.length?(t="function"==typeof n?n:ov(+n),c):t},c.x1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:ov(+t),c):n},c.y=function(t){return arguments.length?(e="function"==typeof t?t:ov(+t),r=null,c):e},c.y0=function(t){return arguments.length?(e="function"==typeof t?t:ov(+t),c):e},c.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ov(+t),c):r},c.lineX0=c.lineY0=function(){return s().x(t).y(e)},c.lineY1=function(){return s().x(t).y(r)},c.lineX1=function(){return s().x(n).y(e)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:ov(!!t),c):i},c.curve=function(t){return arguments.length?(u=t,null!=o&&(a=u(o)),c):u},c.context=function(t){return arguments.length?(null==t?o=a=null:a=u(o=t),c):o},c}function Cv(t,n){return n<t?-1:n>t?1:n>=t?0:NaN}function zv(t){return t}Tv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var Pv=Lv(Nv);function Rv(t){this._curve=t}function Lv(t){function n(n){return new Rv(t(n))}return n._curve=t,n}function qv(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n(Lv(t)):n()._curve},t}function Dv(){return qv(Ev().curve(Pv))}function Uv(){var t=Av().curve(Pv),n=t.curve,e=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return qv(e())},delete t.lineX0,t.lineEndAngle=function(){return qv(r())},delete t.lineX1,t.lineInnerRadius=function(){return qv(i())},delete t.lineY0,t.lineOuterRadius=function(){return qv(o())},delete t.lineY1,t.curve=function(t){return arguments.length?n(Lv(t)):n()._curve},t}function Ov(t,n){return[(n=+n)*Math.cos(t-=Math.PI/2),n*Math.sin(t)]}Rv.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};var Fv=Array.prototype.slice;function Iv(t){return t.source}function Yv(t){return t.target}function Bv(t){var n=Iv,e=Yv,r=kv,i=Sv,o=null;function u(){var u,a=Fv.call(arguments),c=n.apply(this,a),s=e.apply(this,a);if(o||(o=u=Hi()),t(o,+r.apply(this,(a[0]=c,a)),+i.apply(this,a),+r.apply(this,(a[0]=s,a)),+i.apply(this,a)),u)return o=null,u+""||null}return u.source=function(t){return arguments.length?(n=t,u):n},u.target=function(t){return arguments.length?(e=t,u):e},u.x=function(t){return arguments.length?(r="function"==typeof t?t:ov(+t),u):r},u.y=function(t){return arguments.length?(i="function"==typeof t?t:ov(+t),u):i},u.context=function(t){return arguments.length?(o=null==t?null:t,u):o},u}function Hv(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function jv(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n,e=(e+i)/2,r,e,r,i)}function Xv(t,n,e,r,i){var o=Ov(n,e),u=Ov(n,e=(e+i)/2),a=Ov(r,e),c=Ov(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(u[0],u[1],a[0],a[1],c[0],c[1])}var Vv={draw:function(t,n){var e=Math.sqrt(n/dv);t.moveTo(e,0),t.arc(0,0,e,0,gv)}},$v={draw:function(t,n){var e=Math.sqrt(n/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},Wv=Math.sqrt(1/3),Zv=2*Wv,Gv={draw:function(t,n){var e=Math.sqrt(n/Zv),r=e*Wv;t.moveTo(0,-e),t.lineTo(r,0),t.lineTo(0,e),t.lineTo(-r,0),t.closePath()}},Qv=Math.sin(dv/10)/Math.sin(7*dv/10),Jv=Math.sin(gv/10)*Qv,Kv=-Math.cos(gv/10)*Qv,tg={draw:function(t,n){var e=Math.sqrt(.8908130915292852*n),r=Jv*e,i=Kv*e;t.moveTo(0,-e),t.lineTo(r,i);for(var o=1;o<5;++o){var u=gv*o/5,a=Math.cos(u),c=Math.sin(u);t.lineTo(c*e,-a*e),t.lineTo(a*r-c*i,c*r+a*i)}t.closePath()}},ng={draw:function(t,n){var e=Math.sqrt(n),r=-e/2;t.rect(r,r,e,e)}},eg=Math.sqrt(3),rg={draw:function(t,n){var e=-Math.sqrt(n/(3*eg));t.moveTo(0,2*e),t.lineTo(-eg*e,-e),t.lineTo(eg*e,-e),t.closePath()}},ig=-.5,og=Math.sqrt(3)/2,ug=1/Math.sqrt(12),ag=3*(ug/2+1),cg={draw:function(t,n){var e=Math.sqrt(n/ag),r=e/2,i=e*ug,o=r,u=e*ug+e,a=-o,c=u;t.moveTo(r,i),t.lineTo(o,u),t.lineTo(a,c),t.lineTo(ig*r-og*i,og*r+ig*i),t.lineTo(ig*o-og*u,og*o+ig*u),t.lineTo(ig*a-og*c,og*a+ig*c),t.lineTo(ig*r+og*i,ig*i-og*r),t.lineTo(ig*o+og*u,ig*u-og*o),t.lineTo(ig*a+og*c,ig*c-og*a),t.closePath()}},sg=[Vv,$v,Gv,ng,tg,rg,cg];function fg(){}function lg(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function hg(t){this._context=t}function pg(t){this._context=t}function dg(t){this._context=t}function vg(t,n){this._basis=new hg(t),this._beta=n}hg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lg(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},pg.prototype={areaStart:fg,areaEnd:fg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:lg(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},dg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 3:this._point=4;default:lg(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},vg.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(e>0)for(var r,i=t[0],o=n[0],u=t[e]-i,a=n[e]-o,c=-1;++c<=e;)r=c/e,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*u),this._beta*n[c]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var gg=function t(n){function e(t){return 1===n?new hg(t):new vg(t,n)}return e.beta=function(n){return t(+n)},e}(.85);function _g(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function yg(t,n){this._context=t,this._k=(1-n)/6}yg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_g(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:_g(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var mg=function t(n){function e(t){return new yg(t,n)}return e.tension=function(n){return t(+n)},e}(0);function xg(t,n){this._context=t,this._k=(1-n)/6}xg.prototype={areaStart:fg,areaEnd:fg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:_g(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var bg=function t(n){function e(t){return new xg(t,n)}return e.tension=function(n){return t(+n)},e}(0);function wg(t,n){this._context=t,this._k=(1-n)/6}wg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_g(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Mg=function t(n){function e(t){return new wg(t,n)}return e.tension=function(n){return t(+n)},e}(0);function Tg(t,n,e){var r=t._x1,i=t._y1,o=t._x2,u=t._y2;if(t._l01_a>pv){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>pv){var s=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*s+t._x1*t._l23_2a-n*t._l12_2a)/f,u=(u*s+t._y1*t._l23_2a-e*t._l12_2a)/f}t._context.bezierCurveTo(r,i,o,u,t._x2,t._y2)}function Ng(t,n){this._context=t,this._alpha=n}Ng.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:Tg(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var kg=function t(n){function e(t){return n?new Ng(t,n):new yg(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function Sg(t,n){this._context=t,this._alpha=n}Sg.prototype={areaStart:fg,areaEnd:fg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:Tg(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Eg=function t(n){function e(t){return n?new Sg(t,n):new xg(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function Ag(t,n){this._context=t,this._alpha=n}Ag.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Tg(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var Cg=function t(n){function e(t){return n?new Ag(t,n):new wg(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function zg(t){this._context=t}function Pg(t){return t<0?-1:1}function Rg(t,n,e){var r=t._x1-t._x0,i=n-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),u=(e-t._y1)/(i||r<0&&-0),a=(o*i+u*r)/(r+i);return(Pg(o)+Pg(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(a))||0}function Lg(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function qg(t,n,e){var r=t._x0,i=t._y0,o=t._x1,u=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*n,o-a,u-a*e,o,u)}function Dg(t){this._context=t}function Ug(t){this._context=new Og(t)}function Og(t){this._context=t}function Fg(t){this._context=t}function Ig(t){var n,e,r=t.length-1,i=new Array(r),o=new Array(r),u=new Array(r);for(i[0]=0,o[0]=2,u[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,o[n]=4,u[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,o[r-1]=7,u[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)e=i[n]/o[n-1],o[n]-=e,u[n]-=e*u[n-1];for(i[r-1]=u[r-1]/o[r-1],n=r-2;n>=0;--n)i[n]=(u[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)o[n]=2*t[n+1]-i[n+1];return[i,o]}function Yg(t,n){this._context=t,this._t=n}function Bg(t,n){if((i=t.length)>1)for(var e,r,i,o=1,u=t[n[0]],a=u.length;o<i;++o)for(r=u,u=t[n[o]],e=0;e<a;++e)u[e][1]+=u[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]}function Hg(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e}function jg(t,n){return t[n]}function Xg(t){var n=t.map(Vg);return Hg(t).sort(function(t,e){return n[t]-n[e]})}function Vg(t){for(var n,e=0,r=-1,i=t.length;++r<i;)(n=+t[r][1])&&(e+=n);return e}function $g(t){return function(){return t}}function Wg(t){return t[0]}function Zg(t){return t[1]}function Gg(){this._=null}function Qg(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Jg(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Kg(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function t_(t){for(;t.L;)t=t.L;return t}function n_(t,n,e,r){var i=[null,null],o=N_.push(i)-1;return i.left=t,i.right=n,e&&r_(i,t,n,e),r&&r_(i,n,t,r),M_[t.index].halfedges.push(o),M_[n.index].halfedges.push(o),i}function e_(t,n,e){var r=[n,e];return r.left=t,r}function r_(t,n,e,r){t[0]||t[1]?t.left===e?t[1]=r:t[0]=r:(t[0]=r,t.left=n,t.right=e)}function i_(t,n,e,r,i){var o,u=t[0],a=t[1],c=u[0],s=u[1],f=0,l=1,h=a[0]-c,p=a[1]-s;if(o=n-c,h||!(o>0)){if(o/=h,h<0){if(o<f)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>f&&(f=o)}if(o=r-c,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>f&&(f=o)}else if(h>0){if(o<f)return;o<l&&(l=o)}if(o=e-s,p||!(o>0)){if(o/=p,p<0){if(o<f)return;o<l&&(l=o)}else if(p>0){if(o>l)return;o>f&&(f=o)}if(o=i-s,p||!(o<0)){if(o/=p,p<0){if(o>l)return;o>f&&(f=o)}else if(p>0){if(o<f)return;o<l&&(l=o)}return!(f>0||l<1)||(f>0&&(t[0]=[c+f*h,s+f*p]),l<1&&(t[1]=[c+l*h,s+l*p]),!0)}}}}}function o_(t,n,e,r,i){var o=t[1];if(o)return!0;var u,a,c=t[0],s=t.left,f=t.right,l=s[0],h=s[1],p=f[0],d=f[1],v=(l+p)/2,g=(h+d)/2;if(d===h){if(v<n||v>=r)return;if(l>p){if(c){if(c[1]>=i)return}else c=[v,e];o=[v,i]}else{if(c){if(c[1]<e)return}else c=[v,i];o=[v,e]}}else if(a=g-(u=(l-p)/(d-h))*v,u<-1||u>1)if(l>p){if(c){if(c[1]>=i)return}else c=[(e-a)/u,e];o=[(i-a)/u,i]}else{if(c){if(c[1]<e)return}else c=[(i-a)/u,i];o=[(e-a)/u,e]}else if(h<d){if(c){if(c[0]>=r)return}else c=[n,u*n+a];o=[r,u*r+a]}else{if(c){if(c[0]<n)return}else c=[r,u*r+a];o=[n,u*n+a]}return t[0]=c,t[1]=o,!0}function u_(t,n){var e=t.site,r=n.left,i=n.right;return e===i&&(i=r,r=e),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(e===r?(r=n[1],i=n[0]):(r=n[0],i=n[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function a_(t,n){return n[+(n.left!==t.site)]}function c_(t,n){return n[+(n.left===t.site)]}zg.prototype={areaStart:fg,areaEnd:fg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}},Dg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:qg(this,this._t0,Lg(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,qg(this,Lg(this,e=Rg(this,t,n)),e);break;default:qg(this,this._t0,e=Rg(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},(Ug.prototype=Object.create(Dg.prototype)).point=function(t,n){Dg.prototype.point.call(this,n,t)},Og.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,e,r,i,o){this._context.bezierCurveTo(n,t,r,e,o,i)}},Fg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,e=t.length;if(e)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===e)this._context.lineTo(t[1],n[1]);else for(var r=Ig(t),i=Ig(n),o=0,u=1;u<e;++o,++u)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[u],n[u]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}},Yg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}},Gg.prototype={constructor:Gg,insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=t_(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(Jg(this,e),e=(t=e).U),e.C=!1,r.C=!0,Kg(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&(Kg(this,e),e=(t=e).U),e.C=!1,r.C=!0,Jg(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,o=t.L,u=t.R;if(e=o?u?t_(u):o:u,i?i.L===t?i.L=e:i.R=e:this._=e,o&&u?(r=e.C,e.C=t.C,e.L=o,o.U=e,e!==u?(i=e.U,e.U=t.U,t=e.R,i.L=t,e.R=u,u.U=e):(e.U=i,i=e,t=e.R)):(r=t.C,t=e),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,Jg(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,Kg(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,Jg(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,Kg(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,Jg(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,Kg(this,i),t=this._;break}n.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var s_,f_=[];function l_(){Qg(this),this.x=this.y=this.arc=this.site=this.cy=null}function h_(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,o=e.site;if(r!==o){var u=i[0],a=i[1],c=r[0]-u,s=r[1]-a,f=o[0]-u,l=o[1]-a,h=2*(c*l-s*f);if(!(h>=-S_)){var p=c*c+s*s,d=f*f+l*l,v=(l*p-s*d)/h,g=(c*d-f*p)/h,_=f_.pop()||new l_;_.arc=t,_.site=i,_.x=v+u,_.y=(_.cy=g+a)+Math.sqrt(v*v+g*g),t.circle=_;for(var y=null,m=T_._;m;)if(_.y<m.y||_.y===m.y&&_.x<=m.x){if(!m.L){y=m.P;break}m=m.L}else{if(!m.R){y=m;break}m=m.R}T_.insert(y,_),y||(s_=_)}}}}function p_(t){var n=t.circle;n&&(n.P||(s_=n.N),T_.remove(n),f_.push(n),Qg(n),t.circle=null)}var d_=[];function v_(){Qg(this),this.edge=this.site=this.circle=null}function g_(t){var n=d_.pop()||new v_;return n.site=t,n}function __(t){p_(t),w_.remove(t),d_.push(t),Qg(t)}function y_(t){var n=t.circle,e=n.x,r=n.cy,i=[e,r],o=t.P,u=t.N,a=[t];__(t);for(var c=o;c.circle&&Math.abs(e-c.circle.x)<k_&&Math.abs(r-c.circle.cy)<k_;)o=c.P,a.unshift(c),__(c),c=o;a.unshift(c),p_(c);for(var s=u;s.circle&&Math.abs(e-s.circle.x)<k_&&Math.abs(r-s.circle.cy)<k_;)u=s.N,a.push(s),__(s),s=u;a.push(s),p_(s);var f,l=a.length;for(f=1;f<l;++f)s=a[f],c=a[f-1],r_(s.edge,c.site,s.site,i);c=a[0],(s=a[l-1]).edge=n_(c.site,s.site,null,i),h_(c),h_(s)}function m_(t){for(var n,e,r,i,o=t[0],u=t[1],a=w_._;a;)if((r=x_(a,u)-o)>k_)a=a.L;else{if(!((i=o-b_(a,u))>k_)){r>-k_?(n=a.P,e=a):i>-k_?(n=a,e=a.N):n=e=a;break}if(!a.R){n=a;break}a=a.R}!function(t){M_[t.index]={site:t,halfedges:[]}}(t);var c=g_(t);if(w_.insert(n,c),n||e){if(n===e)return p_(n),e=g_(n.site),w_.insert(c,e),c.edge=e.edge=n_(n.site,c.site),h_(n),void h_(e);if(e){p_(n),p_(e);var s=n.site,f=s[0],l=s[1],h=t[0]-f,p=t[1]-l,d=e.site,v=d[0]-f,g=d[1]-l,_=2*(h*g-p*v),y=h*h+p*p,m=v*v+g*g,x=[(g*y-p*m)/_+f,(h*m-v*y)/_+l];r_(e.edge,s,d,x),c.edge=n_(s,t,null,x),e.edge=n_(t,d,null,x),h_(n),h_(e)}else c.edge=n_(n.site,c.site)}}function x_(t,n){var e=t.site,r=e[0],i=e[1],o=i-n;if(!o)return r;var u=t.P;if(!u)return-1/0;var a=(e=u.site)[0],c=e[1],s=c-n;if(!s)return a;var f=a-r,l=1/o-1/s,h=f/s;return l?(-h+Math.sqrt(h*h-2*l*(f*f/(-2*s)-c+s/2+i-o/2)))/l+r:(r+a)/2}function b_(t,n){var e=t.N;if(e)return x_(e,n);var r=t.site;return r[1]===n?r[0]:1/0}var w_,M_,T_,N_,k_=1e-6,S_=1e-12;function E_(t,n){return n[1]-t[1]||n[0]-t[0]}function A_(t,n){var e,r,i,o=t.sort(E_).pop();for(N_=[],M_=new Array(t.length),w_=new Gg,T_=new Gg;;)if(i=s_,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===e&&o[1]===r||(m_(o),e=o[0],r=o[1]),o=t.pop();else{if(!i)break;y_(i.arc)}if(function(){for(var t,n,e,r,i=0,o=M_.length;i<o;++i)if((t=M_[i])&&(r=(n=t.halfedges).length)){var u=new Array(r),a=new Array(r);for(e=0;e<r;++e)u[e]=e,a[e]=u_(t,N_[n[e]]);for(u.sort(function(t,n){return a[n]-a[t]}),e=0;e<r;++e)a[e]=n[u[e]];for(e=0;e<r;++e)n[e]=a[e]}}(),n){var u=+n[0][0],a=+n[0][1],c=+n[1][0],s=+n[1][1];!function(t,n,e,r){for(var i,o=N_.length;o--;)o_(i=N_[o],t,n,e,r)&&i_(i,t,n,e,r)&&(Math.abs(i[0][0]-i[1][0])>k_||Math.abs(i[0][1]-i[1][1])>k_)||delete N_[o]}(u,a,c,s),function(t,n,e,r){var i,o,u,a,c,s,f,l,h,p,d,v,g=M_.length,_=!0;for(i=0;i<g;++i)if(o=M_[i]){for(u=o.site,a=(c=o.halfedges).length;a--;)N_[c[a]]||c.splice(a,1);for(a=0,s=c.length;a<s;)d=(p=c_(o,N_[c[a]]))[0],v=p[1],l=(f=a_(o,N_[c[++a%s]]))[0],h=f[1],(Math.abs(d-l)>k_||Math.abs(v-h)>k_)&&(c.splice(a,0,N_.push(e_(u,p,Math.abs(d-t)<k_&&r-v>k_?[t,Math.abs(l-t)<k_?h:r]:Math.abs(v-r)<k_&&e-d>k_?[Math.abs(h-r)<k_?l:e,r]:Math.abs(d-e)<k_&&v-n>k_?[e,Math.abs(l-e)<k_?h:n]:Math.abs(v-n)<k_&&d-t>k_?[Math.abs(h-n)<k_?l:t,n]:null))-1),++s);s&&(_=!1)}if(_){var y,m,x,b=1/0;for(i=0,_=null;i<g;++i)(o=M_[i])&&(x=(y=(u=o.site)[0]-t)*y+(m=u[1]-n)*m)<b&&(b=x,_=o);if(_){var w=[t,n],M=[t,r],T=[e,r],N=[e,n];_.halfedges.push(N_.push(e_(u=_.site,w,M))-1,N_.push(e_(u,M,T))-1,N_.push(e_(u,T,N))-1,N_.push(e_(u,N,w))-1)}}for(i=0;i<g;++i)(o=M_[i])&&(o.halfedges.length||delete M_[i])}(u,a,c,s)}this.edges=N_,this.cells=M_,w_=T_=N_=M_=null}function C_(t){return function(){return t}}function z_(t,n,e){this.target=t,this.type=n,this.transform=e}function P_(t,n,e){this.k=t,this.x=n,this.y=e}A_.prototype={constructor:A_,polygons:function(){var t=this.edges;return this.cells.map(function(n){var e=n.halfedges.map(function(e){return a_(n,t[e])});return e.data=n.site.data,e})},triangles:function(){var t=[],n=this.edges;return this.cells.forEach(function(e,r){if(o=(i=e.halfedges).length)for(var i,o,u,a,c,s,f=e.site,l=-1,h=n[i[o-1]],p=h.left===f?h.right:h.left;++l<o;)u=p,p=(h=n[i[l]]).left===f?h.right:h.left,u&&p&&r<u.index&&r<p.index&&(c=u,s=p,((a=f)[0]-s[0])*(c[1]-a[1])-(a[0]-c[0])*(s[1]-a[1])<0)&&t.push([f.data,u.data,p.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,n,e){for(var r,i,o=this,u=o._found||0,a=o.cells.length;!(i=o.cells[u]);)if(++u>=a)return null;var c=t-i.site[0],s=n-i.site[1],f=c*c+s*s;do{i=o.cells[r=u],u=null,i.halfedges.forEach(function(e){var r=o.edges[e],a=r.left;if(a!==i.site&&a||(a=r.right)){var c=t-a[0],s=n-a[1],l=c*c+s*s;l<f&&(f=l,u=a.index)}})}while(null!==u);return o._found=r,null==e||f<=e*e?i.site:null}},P_.prototype={constructor:P_,scale:function(t){return 1===t?this:new P_(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new P_(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var R_=new P_(1,0,0);function L_(t){return t.__zoom||R_}function q_(){t.event.stopImmediatePropagation()}function D_(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function U_(){return!t.event.button}function O_(){var t,n,e=this;return e instanceof SVGElement?(t=(e=e.ownerSVGElement||e).width.baseVal.value,n=e.height.baseVal.value):(t=e.clientWidth,n=e.clientHeight),[[0,0],[t,n]]}function F_(){return this.__zoom||R_}function I_(){return-t.event.deltaY*(t.event.deltaMode?120:1)/500}function Y_(){return"ontouchstart"in this}function B_(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],u=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),u>o?(o+u)/2:Math.min(0,o)||Math.max(0,u))}L_.prototype=P_.prototype,t.version="4.13.0",t.bisect=i,t.bisectRight=i,t.bisectLeft=o,t.ascending=n,t.bisector=e,t.cross=function(t,n,e){var r,i,o,a,c=t.length,s=n.length,f=new Array(c*s);for(null==e&&(e=u),r=o=0;r<c;++r)for(a=t[r],i=0;i<s;++i,++o)f[o]=e(a,n[i]);return f},t.descending=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},t.deviation=s,t.extent=f,t.histogram=function(){var t=v,n=f,e=M;function r(r){var o,u,a=r.length,c=new Array(a);for(o=0;o<a;++o)c[o]=t(r[o],o,r);var s=n(c),f=s[0],l=s[1],h=e(c,f,l);Array.isArray(h)||(h=w(f,l,h),h=g(Math.ceil(f/h)*h,Math.floor(l/h)*h,h));for(var p=h.length;h[0]<=f;)h.shift(),--p;for(;h[p-1]>l;)h.pop(),--p;var d,v=new Array(p+1);for(o=0;o<=p;++o)(d=v[o]=[]).x0=o>0?h[o-1]:f,d.x1=o<p?h[o]:l;for(o=0;o<a;++o)f<=(u=c[o])&&u<=l&&v[i(h,u,0,p)].push(r[o]);return v}return r.value=function(n){return arguments.length?(t="function"==typeof n?n:d(n),r):t},r.domain=function(t){return arguments.length?(n="function"==typeof t?t:d([t[0],t[1]]),r):n},r.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?d(h.call(t)):d(t),r):e},r},t.thresholdFreedmanDiaconis=function(t,e,r){return t=p.call(t,a).sort(n),Math.ceil((r-e)/(2*(T(t,.75)-T(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,n,e){return Math.ceil((e-n)/(3.5*s(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=M,t.max=function(t,n){var e,r,i=t.length,o=-1;if(null==n){for(;++o<i;)if(null!=(e=t[o])&&e>=e)for(r=e;++o<i;)null!=(e=t[o])&&e>r&&(r=e)}else for(;++o<i;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=e;++o<i;)null!=(e=n(t[o],o,t))&&e>r&&(r=e);return r},t.mean=function(t,n){var e,r=t.length,i=r,o=-1,u=0;if(null==n)for(;++o<r;)isNaN(e=a(t[o]))?--i:u+=e;else for(;++o<r;)isNaN(e=a(n(t[o],o,t)))?--i:u+=e;if(i)return u/i},t.median=function(t,e){var r,i=t.length,o=-1,u=[];if(null==e)for(;++o<i;)isNaN(r=a(t[o]))||u.push(r);else for(;++o<i;)isNaN(r=a(e(t[o],o,t)))||u.push(r);return T(u.sort(n),.5)},t.merge=N,t.min=k,t.pairs=function(t,n){null==n&&(n=u);for(var e=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);e<r;)o[e]=n(i,i=t[++e]);return o},t.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},t.quantile=T,t.range=g,t.scan=function(t,e){if(r=t.length){var r,i,o=0,u=0,a=t[u];for(null==e&&(e=n);++o<r;)(e(i=t[o],a)<0||0!==e(a,a))&&(a=i,u=o);return 0===e(a,a)?u:void 0}},t.shuffle=function(t,n,e){for(var r,i,o=(null==e?t.length:e)-(n=null==n?0:+n);o;)i=Math.random()*o--|0,r=t[o+n],t[o+n]=t[i+n],t[i+n]=r;return t},t.sum=function(t,n){var e,r=t.length,i=-1,o=0;if(null==n)for(;++i<r;)(e=+t[i])&&(o+=e);else for(;++i<r;)(e=+n(t[i],i,t))&&(o+=e);return o},t.ticks=x,t.tickIncrement=b,t.tickStep=w,t.transpose=S,t.variance=c,t.zip=function(){return S(arguments)},t.axisTop=function(t){return F(z,t)},t.axisRight=function(t){return F(P,t)},t.axisBottom=function(t){return F(R,t)},t.axisLeft=function(t){return F(L,t)},t.brush=function(){return Ci(mi)},t.brushX=function(){return Ci(_i)},t.brushY=function(){return Ci(yi)},t.brushSelection=function(t){var n=t.__brush;return n?n.dim.output(n.selection):null},t.chord=function(){var t=0,n=null,e=null,r=null;function i(i){var o,u,a,c,s,f,l=i.length,h=[],p=g(l),d=[],v=[],_=v.groups=new Array(l),y=new Array(l*l);for(o=0,s=-1;++s<l;){for(u=0,f=-1;++f<l;)u+=i[s][f];h.push(u),d.push(g(l)),o+=u}for(n&&p.sort(function(t,e){return n(h[t],h[e])}),e&&d.forEach(function(t,n){t.sort(function(t,r){return e(i[n][t],i[n][r])})}),c=(o=Di(0,qi-t*l)/o)?t:qi/l,u=0,s=-1;++s<l;){for(a=u,f=-1;++f<l;){var m=p[s],x=d[m][f],b=i[m][x],w=u,M=u+=b*o;y[x*l+m]={index:m,subindex:x,startAngle:w,endAngle:M,value:b}}_[m]={index:m,startAngle:a,endAngle:u,value:h[m]},u+=c}for(s=-1;++s<l;)for(f=s-1;++f<l;){var T=y[f*l+s],N=y[s*l+f];(T.value||N.value)&&v.push(T.value<N.value?{source:N,target:T}:{source:T,target:N})}return r?v.sort(r):v}return i.padAngle=function(n){return arguments.length?(t=Di(0,n),i):t},i.sortGroups=function(t){return arguments.length?(n=t,i):n},i.sortSubgroups=function(t){return arguments.length?(e=t,i):e},i.sortChords=function(t){return arguments.length?(null==t?r=null:(n=t,r=function(t,e){return n(t.source.value+t.target.value,e.source.value+e.target.value)})._=t,i):r&&r._;var n},i},t.ribbon=function(){var t=ji,n=Xi,e=Vi,r=$i,i=Wi,o=null;function u(){var u,a=Ui.call(arguments),c=t.apply(this,a),s=n.apply(this,a),f=+e.apply(this,(a[0]=c,a)),l=r.apply(this,a)-Li,h=i.apply(this,a)-Li,p=f*zi(l),d=f*Pi(l),v=+e.apply(this,(a[0]=s,a)),g=r.apply(this,a)-Li,_=i.apply(this,a)-Li;if(o||(o=u=Hi()),o.moveTo(p,d),o.arc(0,0,f,l,h),l===g&&h===_||(o.quadraticCurveTo(0,0,v*zi(g),v*Pi(g)),o.arc(0,0,v,g,_)),o.quadraticCurveTo(0,0,p,d),o.closePath(),u)return o=null,u+""||null}return u.radius=function(t){return arguments.length?(e="function"==typeof t?t:Oi(+t),u):e},u.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Oi(+t),u):r},u.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Oi(+t),u):i},u.source=function(n){return arguments.length?(t=n,u):t},u.target=function(t){return arguments.length?(n=t,u):n},u.context=function(t){return arguments.length?(o=null==t?null:t,u):o},u},t.nest=function(){var t,n,e,r=[],i=[];function o(e,i,u,a){if(i>=r.length)return null!=t&&e.sort(t),null!=n?n(e):e;for(var c,s,f,l=-1,h=e.length,p=r[i++],d=Gi(),v=u();++l<h;)(f=d.get(c=p(s=e[l])+""))?f.push(s):d.set(c,[s]);return d.each(function(t,n){a(v,n,o(t,i,u,a))}),v}return e={object:function(t){return o(t,0,Qi,Ji)},map:function(t){return o(t,0,Ki,to)},entries:function(t){return function t(e,o){if(++o>r.length)return e;var u,a=i[o-1];return null!=n&&o>=r.length?u=e.entries():(u=[],e.each(function(n,e){u.push({key:e,values:t(n,o)})})),null!=a?u.sort(function(t,n){return a(t.key,n.key)}):u}(o(t,0,Ki,to),0)},key:function(t){return r.push(t),e},sortKeys:function(t){return i[r.length-1]=t,e},sortValues:function(n){return t=n,e},rollup:function(t){return n=t,e}}},t.set=ro,t.map=Gi,t.keys=function(t){var n=[];for(var e in t)n.push(e);return n},t.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},t.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},t.color=dn,t.rgb=yn,t.hsl=bn,t.lab=Ln,t.hcl=In,t.cubehelix=Gn,t.dispatch=Y,t.drag=function(){var n,e,r,i,o=Wt,u=Zt,a=Gt,c=Qt,s={},f=Y("start","drag","end"),l=0,h=0;function p(t){t.on("mousedown.drag",d).filter(c).on("touchstart.drag",_).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(){if(!i&&o.apply(this,arguments)){var a=x("mouse",u.apply(this,arguments),It,this,arguments);a&&(Lt(t.event.view).on("mousemove.drag",v,!0).on("mouseup.drag",g,!0),jt(t.event.view),Bt(),r=!1,n=t.event.clientX,e=t.event.clientY,a("start"))}}function v(){if(Ht(),!r){var i=t.event.clientX-n,o=t.event.clientY-e;r=i*i+o*o>h}s.mouse("drag")}function g(){Lt(t.event.view).on("mousemove.drag mouseup.drag",null),Xt(t.event.view,r),Ht(),s.mouse("end")}function _(){if(o.apply(this,arguments)){var n,e,r=t.event.changedTouches,i=u.apply(this,arguments),a=r.length;for(n=0;n<a;++n)(e=x(r[n].identifier,i,Yt,this,arguments))&&(Bt(),e("start"))}}function y(){var n,e,r=t.event.changedTouches,i=r.length;for(n=0;n<i;++n)(e=s[r[n].identifier])&&(Ht(),e("drag"))}function m(){var n,e,r=t.event.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),n=0;n<o;++n)(e=s[r[n].identifier])&&(Bt(),e("end"))}function x(n,e,r,i,o){var u,c,h,d=r(e,n),v=f.copy();if(At(new $t(p,"beforestart",u,n,l,d[0],d[1],0,0,v),function(){return null!=(t.event.subject=u=a.apply(i,o))&&(c=u.x-d[0]||0,h=u.y-d[1]||0,!0)}))return function t(a){var f,g=d;switch(a){case"start":s[n]=t,f=l++;break;case"end":delete s[n],--l;case"drag":d=r(e,n),f=l}At(new $t(p,a,u,n,f,d[0]+c,d[1]+h,d[0]-g[0],d[1]-g[1],v),v.apply,v,[a,i,o])}}return p.filter=function(t){return arguments.length?(o="function"==typeof t?t:Vt(!!t),p):o},p.container=function(t){return arguments.length?(u="function"==typeof t?t:Vt(t),p):u},p.subject=function(t){return arguments.length?(a="function"==typeof t?t:Vt(t),p):a},p.touchable=function(t){return arguments.length?(c="function"==typeof t?t:Vt(!!t),p):c},p.on=function(){var t=f.on.apply(f,arguments);return t===f?p:t},p.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,p):Math.sqrt(h)},p},t.dragDisable=jt,t.dragEnable=Xt,t.dsvFormat=fo,t.csvParse=ho,t.csvParseRows=po,t.csvFormat=vo,t.csvFormatRows=go,t.tsvParse=yo,t.tsvParseRows=mo,t.tsvFormat=xo,t.tsvFormatRows=bo,t.easeLinear=function(t){return+t},t.easeQuad=Pr,t.easeQuadIn=function(t){return t*t},t.easeQuadOut=function(t){return t*(2-t)},t.easeQuadInOut=Pr,t.easeCubic=Rr,t.easeCubicIn=function(t){return t*t*t},t.easeCubicOut=function(t){return--t*t*t+1},t.easeCubicInOut=Rr,t.easePoly=Dr,t.easePolyIn=Lr,t.easePolyOut=qr,t.easePolyInOut=Dr,t.easeSin=Fr,t.easeSinIn=function(t){return 1-Math.cos(t*Or)},t.easeSinOut=function(t){return Math.sin(t*Or)},t.easeSinInOut=Fr,t.easeExp=Ir,t.easeExpIn=function(t){return Math.pow(2,10*t-10)},t.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},t.easeExpInOut=Ir,t.easeCircle=Yr,t.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},t.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},t.easeCircleInOut=Yr,t.easeBounce=Jr,t.easeBounceIn=function(t){return 1-Jr(1-t)},t.easeBounceOut=Jr,t.easeBounceInOut=function(t){return((t*=2)<=1?1-Jr(1-t):Jr(t-1)+1)/2},t.easeBack=ni,t.easeBackIn=Kr,t.easeBackOut=ti,t.easeBackInOut=ni,t.easeElastic=ii,t.easeElasticIn=ri,t.easeElasticOut=ii,t.easeElasticInOut=oi,t.forceCenter=function(t,n){var e;function r(){var r,i,o=e.length,u=0,a=0;for(r=0;r<o;++r)u+=(i=e[r]).x,a+=i.y;for(u=u/o-t,a=a/o-n,r=0;r<o;++r)(i=e[r]).x-=u,i.y-=a}return null==t&&(t=0),null==n&&(n=0),r.initialize=function(t){e=t},r.x=function(n){return arguments.length?(t=+n,r):t},r.y=function(t){return arguments.length?(n=+t,r):n},r},t.forceCollide=function(t){var n,e,r=1,i=1;function o(){for(var t,o,a,c,s,f,l,h=n.length,p=0;p<i;++p)for(o=Eo(n,Po,Ro).visitAfter(u),t=0;t<h;++t)a=n[t],f=e[a.index],l=f*f,c=a.x+a.vx,s=a.y+a.vy,o.visit(d);function d(t,n,e,i,o){var u=t.data,h=t.r,p=f+h;if(!u)return n>c+p||i<c-p||e>s+p||o<s-p;if(u.index>a.index){var d=c-u.x-u.vx,v=s-u.y-u.vy,g=d*d+v*v;g<p*p&&(0===d&&(g+=(d=Mo())*d),0===v&&(g+=(v=Mo())*v),g=(p-(g=Math.sqrt(g)))/g*r,a.vx+=(d*=g)*(p=(h*=h)/(l+h)),a.vy+=(v*=g)*p,u.vx-=d*(p=1-p),u.vy-=v*p)}}}function u(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function a(){if(n){var r,i,o=n.length;for(e=new Array(o),r=0;r<o;++r)i=n[r],e[i.index]=+t(i,r,n)}}return"function"!=typeof t&&(t=wo(null==t?1:+t)),o.initialize=function(t){n=t,a()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(n){return arguments.length?(t="function"==typeof n?n:wo(+n),a(),o):t},o},t.forceLink=function(t){var n,e,r,i,o,u=Lo,a=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=wo(30),s=1;function f(r){for(var i=0,u=t.length;i<s;++i)for(var a,c,f,l,h,p,d,v=0;v<u;++v)c=(a=t[v]).source,l=(f=a.target).x+f.vx-c.x-c.vx||Mo(),h=f.y+f.vy-c.y-c.vy||Mo(),l*=p=((p=Math.sqrt(l*l+h*h))-e[v])/p*r*n[v],h*=p,f.vx-=l*(d=o[v]),f.vy-=h*d,c.vx+=l*(d=1-d),c.vy+=h*d}function l(){if(r){var a,c,s=r.length,f=t.length,l=Gi(r,u);for(a=0,i=new Array(s);a<f;++a)(c=t[a]).index=a,"object"!=typeof c.source&&(c.source=qo(l,c.source)),"object"!=typeof c.target&&(c.target=qo(l,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(a=0,o=new Array(f);a<f;++a)c=t[a],o[a]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);n=new Array(f),h(),e=new Array(f),p()}}function h(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+a(t[e],e,t)}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}return null==t&&(t=[]),f.initialize=function(t){r=t,l()},f.links=function(n){return arguments.length?(t=n,l(),f):t},f.id=function(t){return arguments.length?(u=t,f):u},f.iterations=function(t){return arguments.length?(s=+t,f):s},f.strength=function(t){return arguments.length?(a="function"==typeof t?t:wo(+t),h(),f):a},f.distance=function(t){return arguments.length?(c="function"==typeof t?t:wo(+t),p(),f):c},f},t.forceManyBody=function(){var t,n,e,r,i=wo(-30),o=1,u=1/0,a=.81;function c(r){var i,o=t.length,u=Eo(t,Do,Uo).visitAfter(f);for(e=r,i=0;i<o;++i)n=t[i],u.visit(l)}function s(){if(t){var n,e,o=t.length;for(r=new Array(o),n=0;n<o;++n)e=t[n],r[e.index]=+i(e,n,t)}}function f(t){var n,e,i,o,u,a=0,c=0;if(t.length){for(i=o=u=0;u<4;++u)(n=t[u])&&(e=Math.abs(n.value))&&(a+=n.value,c+=e,i+=e*n.x,o+=e*n.y);t.x=i/c,t.y=o/c}else{(n=t).x=n.data.x,n.y=n.data.y;do{a+=r[n.data.index]}while(n=n.next)}t.value=a}function l(t,i,c,s){if(!t.value)return!0;var f=t.x-n.x,l=t.y-n.y,h=s-i,p=f*f+l*l;if(h*h/a<p)return p<u&&(0===f&&(p+=(f=Mo())*f),0===l&&(p+=(l=Mo())*l),p<o&&(p=Math.sqrt(o*p)),n.vx+=f*t.value*e/p,n.vy+=l*t.value*e/p),!0;if(!(t.length||p>=u)){(t.data!==n||t.next)&&(0===f&&(p+=(f=Mo())*f),0===l&&(p+=(l=Mo())*l),p<o&&(p=Math.sqrt(o*p)));do{t.data!==n&&(h=r[t.data.index]*e/p,n.vx+=f*h,n.vy+=l*h)}while(t=t.next)}}return c.initialize=function(n){t=n,s()},c.strength=function(t){return arguments.length?(i="function"==typeof t?t:wo(+t),s(),c):i},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c.theta=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c},t.forceRadial=function(t,n,e){var r,i,o,u=wo(.1);function a(t){for(var u=0,a=r.length;u<a;++u){var c=r[u],s=c.x-n||1e-6,f=c.y-e||1e-6,l=Math.sqrt(s*s+f*f),h=(o[u]-l)*i[u]*t/l;c.vx+=s*h,c.vy+=f*h}}function c(){if(r){var n,e=r.length;for(i=new Array(e),o=new Array(e),n=0;n<e;++n)o[n]=+t(r[n],n,r),i[n]=isNaN(o[n])?0:+u(r[n],n,r)}}return"function"!=typeof t&&(t=wo(+t)),null==n&&(n=0),null==e&&(e=0),a.initialize=function(t){r=t,c()},a.strength=function(t){return arguments.length?(u="function"==typeof t?t:wo(+t),c(),a):u},a.radius=function(n){return arguments.length?(t="function"==typeof n?n:wo(+n),c(),a):t},a.x=function(t){return arguments.length?(n=+t,a):n},a.y=function(t){return arguments.length?(e=+t,a):e},a},t.forceSimulation=function(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,u=.6,a=Gi(),c=ir(f),s=Y("tick","end");function f(){l(),s.call("tick",n),e<r&&(c.stop(),s.call("end",n))}function l(){var n,r,c=t.length;for(e+=(o-e)*i,a.each(function(t){t(e)}),n=0;n<c;++n)null==(r=t[n]).fx?r.x+=r.vx*=u:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=u:(r.y=r.fy,r.vy=0)}function h(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,isNaN(n.x)||isNaN(n.y)){var i=Fo*Math.sqrt(e),o=e*Io;n.x=i*Math.cos(o),n.y=i*Math.sin(o)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function p(n){return n.initialize&&n.initialize(t),n}return null==t&&(t=[]),h(),n={tick:l,restart:function(){return c.restart(f),n},stop:function(){return c.stop(),n},nodes:function(e){return arguments.length?(t=e,h(),a.each(p),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(i=+t,n):+i},alphaTarget:function(t){return arguments.length?(o=+t,n):o},velocityDecay:function(t){return arguments.length?(u=1-t,n):1-u},force:function(t,e){return arguments.length>1?(null==e?a.remove(t):a.set(t,p(e)),n):a.get(t)},find:function(n,e,r){var i,o,u,a,c,s=0,f=t.length;for(null==r?r=1/0:r*=r,s=0;s<f;++s)(u=(i=n-(a=t[s]).x)*i+(o=e-a.y)*o)<r&&(c=a,r=u);return c},on:function(t,e){return arguments.length>1?(s.on(t,e),n):s.on(t)}}},t.forceX=function(t){var n,e,r,i=wo(.1);function o(t){for(var i,o=0,u=n.length;o<u;++o)(i=n[o]).vx+=(r[o]-i.x)*e[o]*t}function u(){if(n){var o,u=n.length;for(e=new Array(u),r=new Array(u),o=0;o<u;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=wo(null==t?0:+t)),o.initialize=function(t){n=t,u()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:wo(+t),u(),o):i},o.x=function(n){return arguments.length?(t="function"==typeof n?n:wo(+n),u(),o):t},o},t.forceY=function(t){var n,e,r,i=wo(.1);function o(t){for(var i,o=0,u=n.length;o<u;++o)(i=n[o]).vy+=(r[o]-i.y)*e[o]*t}function u(){if(n){var o,u=n.length;for(e=new Array(u),r=new Array(u),o=0;o<u;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=wo(null==t?0:+t)),o.initialize=function(t){n=t,u()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:wo(+t),u(),o):i},o.y=function(n){return arguments.length?(t="function"==typeof n?n:wo(+n),u(),o):t},o},t.formatDefaultLocale=Jo,t.formatLocale=Qo,t.formatSpecifier=Vo,t.precisionFixed=Ko,t.precisionPrefix=tu,t.precisionRound=nu,t.geoArea=function(t){return Gu.reset(),qu(t,Qu),2*Gu},t.geoBounds=function(t){var n,e,r,i,o,u,a;if(ju=Hu=-(Yu=Bu=1/0),sa=[],qu(t,Ea),e=sa.length){for(sa.sort(Ua),n=1,o=[r=sa[0]];n<e;++n)Oa(r,(i=sa[n])[0])||Oa(r,i[1])?(Da(r[0],i[1])>Da(r[0],r[1])&&(r[1]=i[1]),Da(i[0],r[1])>Da(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(u=-1/0,n=0,r=o[e=o.length-1];n<=e;r=i,++n)i=o[n],(a=Da(r[1],i[0]))>u&&(u=a,Yu=i[0],Hu=r[1])}return sa=fa=null,Yu===1/0||Bu===1/0?[[NaN,NaN],[NaN,NaN]]:[[Yu,Bu],[Hu,ju]]},t.geoCentroid=function(t){la=ha=pa=da=va=ga=_a=ya=ma=xa=ba=0,qu(t,Fa);var n=ma,e=xa,r=ba,i=n*n+e*e+r*r;return i<au&&(n=ga,e=_a,r=ya,ha<uu&&(n=pa,e=da,r=va),(i=n*n+e*e+r*r)<au)?[NaN,NaN]:[gu(e,n)*hu,Su(r/Tu(i))*hu]},t.geoCircle=function(){var t,n,e=Ga([0,0]),r=Ga(90),i=Ga(6),o={point:function(e,r){t.push(e=n(e,r)),e[0]*=hu,e[1]*=hu}};function u(){var u=e.apply(this,arguments),a=r.apply(this,arguments)*pu,c=i.apply(this,arguments)*pu;return t=[],n=Ka(-u[0]*pu,-u[1]*pu,0).invert,ic(o,a,c,1),u={type:"Polygon",coordinates:[t]},t=n=null,u}return u.center=function(t){return arguments.length?(e="function"==typeof t?t:Ga([+t[0],+t[1]]),u):e},u.radius=function(t){return arguments.length?(r="function"==typeof t?t:Ga(+t),u):r},u.precision=function(t){return arguments.length?(i="function"==typeof t?t:Ga(+t),u):i},u},t.geoClipAntimeridian=gc,t.geoClipCircle=_c,t.geoClipExtent=function(){var t,n,e,r=0,i=0,o=960,u=500;return e={stream:function(e){return t&&n===e?t:t=xc(r,i,o,u)(n=e)},extent:function(a){return arguments.length?(r=+a[0][0],i=+a[0][1],o=+a[1][0],u=+a[1][1],t=n=null,e):[[r,i],[o,u]]}}},t.geoClipRectangle=xc,t.geoContains=function(t,n){return(t&&Rc.hasOwnProperty(t.type)?Rc[t.type]:qc)(t,n)},t.geoDistance=Pc,t.geoGraticule=Hc,t.geoGraticule10=function(){return Hc()()},t.geoInterpolate=function(t,n){var e=t[0]*pu,r=t[1]*pu,i=n[0]*pu,o=n[1]*pu,u=_u(r),a=wu(r),c=_u(o),s=wu(o),f=u*_u(e),l=u*wu(e),h=c*_u(i),p=c*wu(i),d=2*Su(Tu(Eu(o-r)+u*c*Eu(i-e))),v=wu(d),g=d?function(t){var n=wu(t*=d)/v,e=wu(d-t)/v,r=e*f+n*h,i=e*l+n*p,o=e*a+n*s;return[gu(i,r)*hu,gu(o,Tu(r*r+i*i))*hu]}:function(){return[e*hu,r*hu]};return g.distance=d,g},t.geoLength=Ac,t.geoPath=function(t,n){var e,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),qu(t,e(r))),r.result()}return o.area=function(t){return qu(t,e(Qc)),Qc.result()},o.measure=function(t){return qu(t,e(Us)),Us.result()},o.bounds=function(t){return qu(t,e(us)),us.result()},o.centroid=function(t){return qu(t,e(xs)),xs.result()},o.projection=function(n){return arguments.length?(e=null==n?(t=null,jc):(t=n).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(n=null,new Is):new Cs(n=t),"function"!=typeof i&&r.pointRadius(i),o):n},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(n)},t.geoAlbers=of,t.geoAlbersUsa=function(){var t,n,e,r,i,o,u=of(),a=rf().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=rf().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(t,n){o=[t,n]}};function f(t){var n=t[0],u=t[1];return o=null,e.point(n,u),o||(r.point(n,u),o)||(i.point(n,u),o)}function l(){return t=n=null,f}return f.invert=function(t){var n=u.scale(),e=u.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:u).invert(t)},f.stream=function(e){return t&&n===e?t:(r=[u.stream(n=e),a.stream(e),c.stream(e)],i=r.length,t={point:function(t,n){for(var e=-1;++e<i;)r[e].point(t,n)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},f.precision=function(t){return arguments.length?(u.precision(t),a.precision(t),c.precision(t),l()):u.precision()},f.scale=function(t){return arguments.length?(u.scale(t),a.scale(.35*t),c.scale(t),f.translate(u.translate())):u.scale()},f.translate=function(t){if(!arguments.length)return u.translate();var n=u.scale(),o=+t[0],f=+t[1];return e=u.translate(t).clipExtent([[o-.455*n,f-.238*n],[o+.455*n,f+.238*n]]).stream(s),r=a.translate([o-.307*n,f+.201*n]).clipExtent([[o-.425*n+uu,f+.12*n+uu],[o-.214*n-uu,f+.234*n-uu]]).stream(s),i=c.translate([o-.205*n,f+.212*n]).clipExtent([[o-.214*n+uu,f+.166*n+uu],[o-.115*n-uu,f+.234*n-uu]]).stream(s),l()},f.fitExtent=function(t,n){return Xs(f,t,n)},f.fitSize=function(t,n){return Vs(f,t,n)},f.fitWidth=function(t,n){return $s(f,t,n)},f.fitHeight=function(t,n){return Ws(f,t,n)},f.scale(1070)},t.geoAzimuthalEqualArea=function(){return Ks(cf).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=cf,t.geoAzimuthalEquidistant=function(){return Ks(sf).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=sf,t.geoConicConformal=function(){return nf(pf).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=pf,t.geoConicEqualArea=rf,t.geoConicEqualAreaRaw=ef,t.geoConicEquidistant=function(){return nf(vf).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=vf,t.geoEquirectangular=function(){return Ks(df).scale(152.63)},t.geoEquirectangularRaw=df,t.geoGnomonic=function(){return Ks(gf).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=gf,t.geoIdentity=function(){var t,n,e,r,i,o,u=1,a=0,c=0,s=1,f=1,l=jc,h=null,p=jc;function d(){return r=i=null,o}return o={stream:function(t){return r&&i===t?r:r=l(p(i=t))},postclip:function(r){return arguments.length?(p=r,h=t=n=e=null,d()):p},clipExtent:function(r){return arguments.length?(p=null==r?(h=t=n=e=null,jc):xc(h=+r[0][0],t=+r[0][1],n=+r[1][0],e=+r[1][1]),d()):null==h?null:[[h,t],[n,e]]},scale:function(t){return arguments.length?(l=_f((u=+t)*s,u*f,a,c),d()):u},translate:function(t){return arguments.length?(l=_f(u*s,u*f,a=+t[0],c=+t[1]),d()):[a,c]},reflectX:function(t){return arguments.length?(l=_f(u*(s=t?-1:1),u*f,a,c),d()):s<0},reflectY:function(t){return arguments.length?(l=_f(u*s,u*(f=t?-1:1),a,c),d()):f<0},fitExtent:function(t,n){return Xs(o,t,n)},fitSize:function(t,n){return Vs(o,t,n)},fitWidth:function(t,n){return $s(o,t,n)},fitHeight:function(t,n){return Ws(o,t,n)}}},t.geoProjection=Ks,t.geoProjectionMutator=tf,t.geoMercator=function(){return lf(ff).scale(961/lu)},t.geoMercatorRaw=ff,t.geoNaturalEarth1=function(){return Ks(yf).scale(175.295)},t.geoNaturalEarth1Raw=yf,t.geoOrthographic=function(){return Ks(mf).scale(249.5).clipAngle(90+uu)},t.geoOrthographicRaw=mf,t.geoStereographic=function(){return Ks(xf).scale(250).clipAngle(142)},t.geoStereographicRaw=xf,t.geoTransverseMercator=function(){var t=lf(bf),n=t.center,e=t.rotate;return t.center=function(t){return arguments.length?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return arguments.length?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=bf,t.geoRotation=rc,t.geoStream=qu,t.geoTransform=function(t){return{stream:Bs(t)}},t.cluster=function(){var t=wf,n=1,e=1,r=!1;function i(i){var o,u=0;i.eachAfter(function(n){var e=n.children;e?(n.x=function(t){return t.reduce(Mf,0)/t.length}(e),n.y=function(t){return 1+t.reduce(Tf,0)}(e)):(n.x=o?u+=t(n,o):0,n.y=0,o=n)});var a=function(t){for(var n;n=t.children;)t=n[0];return t}(i),c=function(t){for(var n;n=t.children;)t=n[n.length-1];return t}(i),s=a.x-t(a,c)/2,f=c.x+t(c,a)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*n,t.y=(i.y-t.y)*e}:function(t){t.x=(t.x-s)/(f-s)*n,t.y=(1-(i.y?t.y/i.y:1))*e})}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i},t.hierarchy=kf,t.pack=function(){var t=null,n=1,e=1,r=Vf;function i(i){return i.x=n/2,i.y=e/2,t?i.eachBefore(Zf(t)).eachAfter(Gf(r,.5)).eachBefore(Qf(1)):i.eachBefore(Zf(Wf)).eachAfter(Gf(Vf,1)).eachAfter(Gf(r,i.r/Math.min(n,e))).eachBefore(Qf(Math.min(n,e)/(2*i.r))),i}return i.radius=function(n){return arguments.length?(t=null==(e=n)?null:Xf(e),i):t;var e},i.size=function(t){return arguments.length?(n=+t[0],e=+t[1],i):[n,e]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:$f(+t),i):r},i},t.packSiblings=function(t){return jf(t),t},t.packEnclose=Pf,t.partition=function(){var t=1,n=1,e=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=e,i.x1=t,i.y1=n/o,i.eachBefore(function(t,n){return function(r){r.children&&Kf(r,r.x0,t*(r.depth+1)/n,r.x1,t*(r.depth+2)/n);var i=r.x0,o=r.y0,u=r.x1-e,a=r.y1-e;u<i&&(i=u=(i+u)/2),a<o&&(o=a=(o+a)/2),r.x0=i,r.y0=o,r.x1=u,r.y1=a}}(n,o)),r&&i.eachBefore(Jf),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(t){return arguments.length?(e=+t,i):e},i},t.stratify=function(){var t=rl,n=il;function e(e){var r,i,o,u,a,c,s,f=e.length,l=new Array(f),h={};for(i=0;i<f;++i)r=e[i],a=l[i]=new Cf(r),null!=(c=t(r,i,e))&&(c+="")&&(h[s=tl+(a.id=c)]=s in h?el:a);for(i=0;i<f;++i)if(a=l[i],null!=(c=n(e[i],i,e))&&(c+="")){if(!(u=h[tl+c]))throw new Error("missing: "+c);if(u===el)throw new Error("ambiguous: "+c);u.children?u.children.push(a):u.children=[a],a.parent=u}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=nl,o.eachBefore(function(t){t.depth=t.parent.depth+1,--f}).eachBefore(Af),o.parent=null,f>0)throw new Error("cycle");return o}return e.id=function(n){return arguments.length?(t=Xf(n),e):t},e.parentId=function(t){return arguments.length?(n=Xf(t),e):n},e},t.tree=function(){var t=ol,n=1,e=1,r=null;function i(i){var c=function(t){for(var n,e,r,i,o,u=new fl(t,0),a=[u];n=a.pop();)if(r=n._.children)for(n.children=new Array(o=r.length),i=o-1;i>=0;--i)a.push(e=n.children[i]=new fl(r[i],i)),e.parent=n;return(u.parent=new fl(null,0)).children=[u],u}(i);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(u),r)i.eachBefore(a);else{var s=i,f=i,l=i;i.eachBefore(function(t){t.x<s.x&&(s=t),t.x>f.x&&(f=t),t.depth>l.depth&&(l=t)});var h=s===f?1:t(s,f)/2,p=h-s.x,d=n/(f.x+h+p),v=e/(l.depth||1);i.eachBefore(function(t){t.x=(t.x+p)*d,t.y=t.depth*v})}return i}function o(n){var e=n.children,r=n.parent.children,i=n.i?r[n.i-1]:null;if(e){!function(t){for(var n,e=0,r=0,i=t.children,o=i.length;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(n);var o=(e[0].z+e[e.length-1].z)/2;i?(n.z=i.z+t(n._,i._),n.m=n.z-o):n.z=o}else i&&(n.z=i.z+t(n._,i._));n.parent.A=function(n,e,r){if(e){for(var i,o=n,u=n,a=e,c=o.parent.children[0],s=o.m,f=u.m,l=a.m,h=c.m;a=al(a),o=ul(o),a&&o;)c=ul(c),(u=al(u)).a=n,(i=a.z+l-o.z-s+t(a._,o._))>0&&(cl(sl(a,n,r),n,i),s+=i,f+=i),l+=a.m,s+=o.m,h+=c.m,f+=u.m;a&&!al(u)&&(u.t=a,u.m+=l-f),o&&!ul(c)&&(c.t=o,c.m+=s-h,r=n)}return r}(n,i,n.parent.A||r[0])}function u(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=n,t.y=t.depth*e}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i},t.treemap=function(){var t=dl,n=!1,e=1,r=1,i=[0],o=Vf,u=Vf,a=Vf,c=Vf,s=Vf;function f(t){return t.x0=t.y0=0,t.x1=e,t.y1=r,t.eachBefore(l),i=[0],n&&t.eachBefore(Jf),t}function l(n){var e=i[n.depth],r=n.x0+e,f=n.y0+e,l=n.x1-e,h=n.y1-e;l<r&&(r=l=(r+l)/2),h<f&&(f=h=(f+h)/2),n.x0=r,n.y0=f,n.x1=l,n.y1=h,n.children&&(e=i[n.depth+1]=o(n)/2,r+=s(n)-e,f+=u(n)-e,(l-=a(n)-e)<r&&(r=l=(r+l)/2),(h-=c(n)-e)<f&&(f=h=(f+h)/2),t(n,r,f,l,h))}return f.round=function(t){return arguments.length?(n=!!t,f):n},f.size=function(t){return arguments.length?(e=+t[0],r=+t[1],f):[e,r]},f.tile=function(n){return arguments.length?(t=Xf(n),f):t},f.padding=function(t){return arguments.length?f.paddingInner(t).paddingOuter(t):f.paddingInner()},f.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:$f(+t),f):o},f.paddingOuter=function(t){return arguments.length?f.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):f.paddingTop()},f.paddingTop=function(t){return arguments.length?(u="function"==typeof t?t:$f(+t),f):u},f.paddingRight=function(t){return arguments.length?(a="function"==typeof t?t:$f(+t),f):a},f.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:$f(+t),f):c},f.paddingLeft=function(t){return arguments.length?(s="function"==typeof t?t:$f(+t),f):s},f},t.treemapBinary=function(t,n,e,r,i){var o,u,a=t.children,c=a.length,s=new Array(c+1);for(s[0]=u=o=0;o<c;++o)s[o+1]=u+=a[o].value;!function t(n,e,r,i,o,u,c){if(n>=e-1){var f=a[n];return f.x0=i,f.y0=o,f.x1=u,void(f.y1=c)}for(var l=s[n],h=r/2+l,p=n+1,d=e-1;p<d;){var v=p+d>>>1;s[v]<h?p=v+1:d=v}h-s[p-1]<s[p]-h&&n+1<p&&--p;var g=s[p]-l,_=r-g;if(u-i>c-o){var y=(i*_+u*g)/r;t(n,p,g,i,o,y,c),t(p,e,_,y,o,u,c)}else{var m=(o*_+c*g)/r;t(n,p,g,i,o,u,m),t(p,e,_,i,m,u,c)}}(0,c,t.value,n,e,r,i)},t.treemapDice=Kf,t.treemapSlice=ll,t.treemapSliceDice=function(t,n,e,r,i){(1&t.depth?ll:Kf)(t,n,e,r,i)},t.treemapSquarify=dl,t.treemapResquarify=vl,t.interpolate=_e,t.interpolateArray=fe,t.interpolateBasis=Kn,t.interpolateBasisClosed=te,t.interpolateDate=le,t.interpolateNumber=he,t.interpolateObject=pe,t.interpolateRound=ye,t.interpolateString=ge,t.interpolateTransformCss=Se,t.interpolateTransformSvg=Ee,t.interpolateZoom=Le,t.interpolateRgb=ue,t.interpolateRgbBasis=ce,t.interpolateRgbBasisClosed=se,t.interpolateHsl=De,t.interpolateHslLong=Ue,t.interpolateLab=function(t,n){var e=oe((t=Ln(t)).l,(n=Ln(n)).l),r=oe(t.a,n.a),i=oe(t.b,n.b),o=oe(t.opacity,n.opacity);return function(n){return t.l=e(n),t.a=r(n),t.b=i(n),t.opacity=o(n),t+""}},t.interpolateHcl=Fe,t.interpolateHclLong=Ie,t.interpolateCubehelix=Be,t.interpolateCubehelixLong=He,t.quantize=function(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t(r/(n-1));return e},t.path=Hi,t.polygonArea=function(t){for(var n,e=-1,r=t.length,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2},t.polygonCentroid=function(t){for(var n,e,r=-1,i=t.length,o=0,u=0,a=t[i-1],c=0;++r<i;)n=a,a=t[r],c+=e=n[0]*a[1]-a[0]*n[1],o+=(n[0]+a[0])*e,u+=(n[1]+a[1])*e;return[o/(c*=3),u/c]},t.polygonHull=function(t){if((e=t.length)<3)return null;var n,e,r=new Array(e),i=new Array(e);for(n=0;n<e;++n)r[n]=[+t[n][0],+t[n][1],n];for(r.sort(gl),n=0;n<e;++n)i[n]=[r[n][0],-r[n][1]];var o=_l(r),u=_l(i),a=u[0]===o[0],c=u[u.length-1]===o[o.length-1],s=[];for(n=o.length-1;n>=0;--n)s.push(t[r[o[n]][2]]);for(n=+a;n<u.length-c;++n)s.push(t[r[u[n]][2]]);return s},t.polygonContains=function(t,n){for(var e,r,i=t.length,o=t[i-1],u=n[0],a=n[1],c=o[0],s=o[1],f=!1,l=0;l<i;++l)e=(o=t[l])[0],(r=o[1])>a!=s>a&&u<(c-e)*(a-r)/(s-r)+e&&(f=!f),c=e,s=r;return f},t.polygonLength=function(t){for(var n,e,r=-1,i=t.length,o=t[i-1],u=o[0],a=o[1],c=0;++r<i;)n=u,e=a,n-=u=(o=t[r])[0],e-=a=o[1],c+=Math.sqrt(n*n+e*e);return c},t.quadtree=Eo,t.queue=Nl,t.randomUniform=Sl,t.randomNormal=El,t.randomLogNormal=Al,t.randomBates=zl,t.randomIrwinHall=Cl,t.randomExponential=Pl,t.request=Rl,t.html=ql,t.json=Dl,t.text=Ul,t.xml=Ol,t.csv=Il,t.tsv=Yl,t.scaleBand=$l,t.scalePoint=function(){return function t(n){var e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return t(e())},n}($l().paddingInner(1))},t.scaleIdentity=function t(){var n=[0,1];function e(t){return+t}return e.invert=e,e.domain=e.range=function(t){return arguments.length?(n=Hl.call(t,Zl),e):n.slice()},e.copy=function(){return t().domain(n)},eh(e)},t.scaleLinear=function t(){var n=nh(Ql,he);return n.copy=function(){return th(n,t())},eh(n)},t.scaleLog=function n(){var e=nh(ih,oh).domain([1,10]),r=e.domain,i=10,o=ch(10),u=ah(10);function a(){return o=ch(i),u=ah(i),r()[0]<0&&(o=sh(o),u=sh(u)),e}return e.base=function(t){return arguments.length?(i=+t,a()):i},e.domain=function(t){return arguments.length?(r(t),a()):r()},e.ticks=function(t){var n,e=r(),a=e[0],c=e[e.length-1];(n=c<a)&&(h=a,a=c,c=h);var s,f,l,h=o(a),p=o(c),d=null==t?10:+t,v=[];if(!(i%1)&&p-h<d){if(h=Math.round(h)-1,p=Math.round(p)+1,a>0){for(;h<p;++h)for(f=1,s=u(h);f<i;++f)if(!((l=s*f)<a)){if(l>c)break;v.push(l)}}else for(;h<p;++h)for(f=i-1,s=u(h);f>=1;--f)if(!((l=s*f)<a)){if(l>c)break;v.push(l)}}else v=x(h,p,Math.min(p-h,d)).map(u);return n?v.reverse():v},e.tickFormat=function(n,r){if(null==r&&(r=10===i?".0e":","),"function"!=typeof r&&(r=t.format(r)),n===1/0)return r;null==n&&(n=10);var a=Math.max(1,i*n/e.ticks().length);return function(t){var n=t/u(Math.round(o(t)));return n*i<i-.5&&(n*=i),n<=a?r(t):""}},e.nice=function(){return r(rh(r(),{floor:function(t){return u(Math.floor(o(t)))},ceil:function(t){return u(Math.ceil(o(t)))}}))},e.copy=function(){return th(e,n().base(i))},e},t.scaleOrdinal=Vl,t.scaleImplicit=Xl,t.scalePow=lh,t.scaleSqrt=function(){return lh().exponent(.5)},t.scaleQuantile=function t(){var e=[],r=[],o=[];function u(){var t=0,n=Math.max(1,r.length);for(o=new Array(n-1);++t<n;)o[t-1]=T(e,t/n);return a}function a(t){if(!isNaN(t=+t))return r[i(o,t)]}return a.invertExtent=function(t){var n=r.indexOf(t);return n<0?[NaN,NaN]:[n>0?o[n-1]:e[0],n<o.length?o[n]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var r,i=0,o=t.length;i<o;++i)null==(r=t[i])||isNaN(r=+r)||e.push(r);return e.sort(n),u()},a.range=function(t){return arguments.length?(r=jl.call(t),u()):r.slice()},a.quantiles=function(){return o.slice()},a.copy=function(){return t().domain(e).range(r)},a},t.scaleQuantize=function t(){var n=0,e=1,r=1,o=[.5],u=[0,1];function a(t){if(t<=t)return u[i(o,t,0,r)]}function c(){var t=-1;for(o=new Array(r);++t<r;)o[t]=((t+1)*e-(t-r)*n)/(r+1);return a}return a.domain=function(t){return arguments.length?(n=+t[0],e=+t[1],c()):[n,e]},a.range=function(t){return arguments.length?(r=(u=jl.call(t)).length-1,c()):u.slice()},a.invertExtent=function(t){var i=u.indexOf(t);return i<0?[NaN,NaN]:i<1?[n,o[0]]:i>=r?[o[r-1],e]:[o[i-1],o[i]]},a.copy=function(){return t().domain([n,e]).range(u)},eh(a)},t.scaleThreshold=function t(){var n=[.5],e=[0,1],r=1;function o(t){if(t<=t)return e[i(n,t,0,r)]}return o.domain=function(t){return arguments.length?(n=jl.call(t),r=Math.min(n.length,e.length-1),o):n.slice()},o.range=function(t){return arguments.length?(e=jl.call(t),r=Math.min(n.length,e.length-1),o):e.slice()},o.invertExtent=function(t){var r=e.indexOf(t);return[n[r-1],n[r]]},o.copy=function(){return t().domain(n).range(e)},o},t.scaleTime=function(){return jd(jh,Bh,Eh,Nh,Mh,bh,mh,vh,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},t.scaleUtc=function(){return jd(vp,pp,Kh,Gh,Wh,Vh,mh,vh,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},t.schemeCategory10=Vd,t.schemeCategory20b=$d,t.schemeCategory20c=Wd,t.schemeCategory20=Zd,t.interpolateCubehelixDefault=Gd,t.interpolateRainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return Kd.h=360*t-100,Kd.s=1.5-1.5*n,Kd.l=.8-.9*n,Kd+""},t.interpolateWarm=Qd,t.interpolateCool=Jd,t.interpolateViridis=nv,t.interpolateMagma=ev,t.interpolateInferno=rv,t.interpolatePlasma=iv,t.scaleSequential=function t(n){var e=0,r=1,i=!1;function o(t){var o=(t-e)/(r-e);return n(i?Math.max(0,Math.min(1,o)):o)}return o.domain=function(t){return arguments.length?(e=+t[0],r=+t[1],o):[e,r]},o.clamp=function(t){return arguments.length?(i=!!t,o):i},o.interpolator=function(t){return arguments.length?(n=t,o):n},o.copy=function(){return t(n).domain([e,r]).clamp(i)},eh(o)},t.create=function(t){return Lt(W(t).call(document.documentElement))},t.creator=W,t.local=Dt,t.matcher=et,t.mouse=It,t.namespace=$,t.namespaces=V,t.clientPoint=Ft,t.select=Lt,t.selectAll=function(t){return"string"==typeof t?new Pt([document.querySelectorAll(t)],[document.documentElement]):new Pt([null==t?[]:t],zt)},t.selection=Rt,t.selector=G,t.selectorAll=J,t.style=ft,t.touch=Yt,t.touches=function(t,n){null==n&&(n=Ot().touches);for(var e=0,r=n?n.length:0,i=new Array(r);e<r;++e)i[e]=Ft(t,n[e]);return i},t.window=st,t.customEvent=At,t.arc=function(){var t=yv,n=mv,e=ov(0),r=null,i=xv,o=bv,u=wv,a=null;function c(){var c,s,f,l=+t.apply(this,arguments),h=+n.apply(this,arguments),p=i.apply(this,arguments)-vv,d=o.apply(this,arguments)-vv,v=uv(d-p),g=d>p;if(a||(a=c=Hi()),h<l&&(s=h,h=l,l=s),h>pv)if(v>gv-pv)a.moveTo(h*cv(p),h*lv(p)),a.arc(0,0,h,p,d,!g),l>pv&&(a.moveTo(l*cv(d),l*lv(d)),a.arc(0,0,l,d,p,g));else{var _,y,m=p,x=d,b=p,w=d,M=v,T=v,N=u.apply(this,arguments)/2,k=N>pv&&(r?+r.apply(this,arguments):hv(l*l+h*h)),S=fv(uv(h-l)/2,+e.apply(this,arguments)),E=S,A=S;if(k>pv){var C=_v(k/l*lv(N)),z=_v(k/h*lv(N));(M-=2*C)>pv?(b+=C*=g?1:-1,w-=C):(M=0,b=w=(p+d)/2),(T-=2*z)>pv?(m+=z*=g?1:-1,x-=z):(T=0,m=x=(p+d)/2)}var P=h*cv(m),R=h*lv(m),L=l*cv(w),q=l*lv(w);if(S>pv){var D=h*cv(x),U=h*lv(x),O=l*cv(b),F=l*lv(b);if(v<dv){var I=M>pv?function(t,n,e,r,i,o,u,a){var c=e-t,s=r-n,f=u-i,l=a-o,h=(f*(n-o)-l*(t-i))/(l*c-f*s);return[t+h*c,n+h*s]}(P,R,O,F,D,U,L,q):[L,q],Y=P-I[0],B=R-I[1],H=D-I[0],j=U-I[1],X=1/lv(((f=(Y*H+B*j)/(hv(Y*Y+B*B)*hv(H*H+j*j)))>1?0:f<-1?dv:Math.acos(f))/2),V=hv(I[0]*I[0]+I[1]*I[1]);E=fv(S,(l-V)/(X-1)),A=fv(S,(h-V)/(X+1))}}T>pv?A>pv?(_=Mv(O,F,P,R,h,A,g),y=Mv(D,U,L,q,h,A,g),a.moveTo(_.cx+_.x01,_.cy+_.y01),A<S?a.arc(_.cx,_.cy,A,av(_.y01,_.x01),av(y.y01,y.x01),!g):(a.arc(_.cx,_.cy,A,av(_.y01,_.x01),av(_.y11,_.x11),!g),a.arc(0,0,h,av(_.cy+_.y11,_.cx+_.x11),av(y.cy+y.y11,y.cx+y.x11),!g),a.arc(y.cx,y.cy,A,av(y.y11,y.x11),av(y.y01,y.x01),!g))):(a.moveTo(P,R),a.arc(0,0,h,m,x,!g)):a.moveTo(P,R),l>pv&&M>pv?E>pv?(_=Mv(L,q,D,U,l,-E,g),y=Mv(P,R,O,F,l,-E,g),a.lineTo(_.cx+_.x01,_.cy+_.y01),E<S?a.arc(_.cx,_.cy,E,av(_.y01,_.x01),av(y.y01,y.x01),!g):(a.arc(_.cx,_.cy,E,av(_.y01,_.x01),av(_.y11,_.x11),!g),a.arc(0,0,l,av(_.cy+_.y11,_.cx+_.x11),av(y.cy+y.y11,y.cx+y.x11),g),a.arc(y.cx,y.cy,E,av(y.y11,y.x11),av(y.y01,y.x01),!g))):a.arc(0,0,l,w,b,g):a.lineTo(L,q)}else a.moveTo(0,0);if(a.closePath(),c)return a=null,c+""||null}return c.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-dv/2;return[cv(r)*e,lv(r)*e]},c.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:ov(+n),c):t},c.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:ov(+t),c):n},c.cornerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ov(+t),c):e},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:ov(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:ov(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:ov(+t),c):o},c.padAngle=function(t){return arguments.length?(u="function"==typeof t?t:ov(+t),c):u},c.context=function(t){return arguments.length?(a=null==t?null:t,c):a},c},t.area=Av,t.line=Ev,t.pie=function(){var t=zv,n=Cv,e=null,r=ov(0),i=ov(gv),o=ov(0);function u(u){var a,c,s,f,l,h=u.length,p=0,d=new Array(h),v=new Array(h),g=+r.apply(this,arguments),_=Math.min(gv,Math.max(-gv,i.apply(this,arguments)-g)),y=Math.min(Math.abs(_)/h,o.apply(this,arguments)),m=y*(_<0?-1:1);for(a=0;a<h;++a)(l=v[d[a]=a]=+t(u[a],a,u))>0&&(p+=l);for(null!=n?d.sort(function(t,e){return n(v[t],v[e])}):null!=e&&d.sort(function(t,n){return e(u[t],u[n])}),a=0,s=p?(_-h*m)/p:0;a<h;++a,g=f)c=d[a],f=g+((l=v[c])>0?l*s:0)+m,v[c]={data:u[c],index:a,value:l,startAngle:g,endAngle:f,padAngle:y};return v}return u.value=function(n){return arguments.length?(t="function"==typeof n?n:ov(+n),u):t},u.sortValues=function(t){return arguments.length?(n=t,e=null,u):n},u.sort=function(t){return arguments.length?(e=t,n=null,u):e},u.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:ov(+t),u):r},u.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:ov(+t),u):i},u.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:ov(+t),u):o},u},t.areaRadial=Uv,t.radialArea=Uv,t.lineRadial=Dv,t.radialLine=Dv,t.pointRadial=Ov,t.linkHorizontal=function(){return Bv(Hv)},t.linkVertical=function(){return Bv(jv)},t.linkRadial=function(){var t=Bv(Xv);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.symbol=function(){var t=ov(Vv),n=ov(64),e=null;function r(){var r;if(e||(e=r=Hi()),t.apply(this,arguments).draw(e,+n.apply(this,arguments)),r)return e=null,r+""||null}return r.type=function(n){return arguments.length?(t="function"==typeof n?n:ov(n),r):t},r.size=function(t){return arguments.length?(n="function"==typeof t?t:ov(+t),r):n},r.context=function(t){return arguments.length?(e=null==t?null:t,r):e},r},t.symbols=sg,t.symbolCircle=Vv,t.symbolCross=$v,t.symbolDiamond=Gv,t.symbolSquare=ng,t.symbolStar=tg,t.symbolTriangle=rg,t.symbolWye=cg,t.curveBasisClosed=function(t){return new pg(t)},t.curveBasisOpen=function(t){return new dg(t)},t.curveBasis=function(t){return new hg(t)},t.curveBundle=gg,t.curveCardinalClosed=bg,t.curveCardinalOpen=Mg,t.curveCardinal=mg,t.curveCatmullRomClosed=Eg,t.curveCatmullRomOpen=Cg,t.curveCatmullRom=kg,t.curveLinearClosed=function(t){return new zg(t)},t.curveLinear=Nv,t.curveMonotoneX=function(t){return new Dg(t)},t.curveMonotoneY=function(t){return new Ug(t)},t.curveNatural=function(t){return new Fg(t)},t.curveStep=function(t){return new Yg(t,.5)},t.curveStepAfter=function(t){return new Yg(t,1)},t.curveStepBefore=function(t){return new Yg(t,0)},t.stack=function(){var t=ov([]),n=Hg,e=Bg,r=jg;function i(i){var o,u,a=t.apply(this,arguments),c=i.length,s=a.length,f=new Array(s);for(o=0;o<s;++o){for(var l,h=a[o],p=f[o]=new Array(c),d=0;d<c;++d)p[d]=l=[0,+r(i[d],h,d,i)],l.data=i[d];p.key=h}for(o=0,u=n(f);o<s;++o)f[u[o]].index=o;return e(f,u),f}return i.keys=function(n){return arguments.length?(t="function"==typeof n?n:ov(Fv.call(n)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:ov(+t),i):r},i.order=function(t){return arguments.length?(n=null==t?Hg:"function"==typeof t?t:ov(Fv.call(t)),i):n},i.offset=function(t){return arguments.length?(e=null==t?Bg:t,i):e},i},t.stackOffsetExpand=function(t,n){if((r=t.length)>0){for(var e,r,i,o=0,u=t[0].length;o<u;++o){for(i=e=0;e<r;++e)i+=t[e][o][1]||0;if(i)for(e=0;e<r;++e)t[e][o][1]/=i}Bg(t,n)}},t.stackOffsetDiverging=function(t,n){if((a=t.length)>1)for(var e,r,i,o,u,a,c=0,s=t[n[0]].length;c<s;++c)for(o=u=0,e=0;e<a;++e)(i=(r=t[n[e]][c])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=u,r[0]=u+=i):r[0]=o},t.stackOffsetNone=Bg,t.stackOffsetSilhouette=function(t,n){if((e=t.length)>0){for(var e,r=0,i=t[n[0]],o=i.length;r<o;++r){for(var u=0,a=0;u<e;++u)a+=t[u][r][1]||0;i[r][1]+=i[r][0]=-a/2}Bg(t,n)}},t.stackOffsetWiggle=function(t,n){if((i=t.length)>0&&(r=(e=t[n[0]]).length)>0){for(var e,r,i,o=0,u=1;u<r;++u){for(var a=0,c=0,s=0;a<i;++a){for(var f=t[n[a]],l=f[u][1]||0,h=(l-(f[u-1][1]||0))/2,p=0;p<a;++p){var d=t[n[p]];h+=(d[u][1]||0)-(d[u-1][1]||0)}c+=l,s+=h*l}e[u-1][1]+=e[u-1][0]=o,c&&(o-=s/c)}e[u-1][1]+=e[u-1][0]=o,Bg(t,n)}},t.stackOrderAscending=Xg,t.stackOrderDescending=function(t){return Xg(t).reverse()},t.stackOrderInsideOut=function(t){var n,e,r=t.length,i=t.map(Vg),o=Hg(t).sort(function(t,n){return i[n]-i[t]}),u=0,a=0,c=[],s=[];for(n=0;n<r;++n)e=o[n],u<a?(u+=i[e],c.push(e)):(a+=i[e],s.push(e));return s.reverse().concat(c)},t.stackOrderNone=Hg,t.stackOrderReverse=function(t){return Hg(t).reverse()},t.timeInterval=dh,t.timeMillisecond=vh,t.timeMilliseconds=gh,t.utcMillisecond=vh,t.utcMilliseconds=gh,t.timeSecond=mh,t.timeSeconds=xh,t.utcSecond=mh,t.utcSeconds=xh,t.timeMinute=bh,t.timeMinutes=wh,t.timeHour=Mh,t.timeHours=Th,t.timeDay=Nh,t.timeDays=kh,t.timeWeek=Eh,t.timeWeeks=qh,t.timeSunday=Eh,t.timeSundays=qh,t.timeMonday=Ah,t.timeMondays=Dh,t.timeTuesday=Ch,t.timeTuesdays=Uh,t.timeWednesday=zh,t.timeWednesdays=Oh,t.timeThursday=Ph,t.timeThursdays=Fh,t.timeFriday=Rh,t.timeFridays=Ih,t.timeSaturday=Lh,t.timeSaturdays=Yh,t.timeMonth=Bh,t.timeMonths=Hh,t.timeYear=jh,t.timeYears=Xh,t.utcMinute=Vh,t.utcMinutes=$h,t.utcHour=Wh,t.utcHours=Zh,t.utcDay=Gh,t.utcDays=Qh,t.utcWeek=Kh,t.utcWeeks=up,t.utcSunday=Kh,t.utcSundays=up,t.utcMonday=tp,t.utcMondays=ap,t.utcTuesday=np,t.utcTuesdays=cp,t.utcWednesday=ep,t.utcWednesdays=sp,t.utcThursday=rp,t.utcThursdays=fp,t.utcFriday=ip,t.utcFridays=lp,t.utcSaturday=op,t.utcSaturdays=hp,t.utcMonth=pp,t.utcMonths=dp,t.utcYear=vp,t.utcYears=gp,t.timeFormatDefaultLocale=Pd,t.timeFormatLocale=xp,t.isoFormat=Rd,t.isoParse=Ld,t.now=nr,t.timer=ir,t.timerFlush=or,t.timeout=sr,t.interval=function(t,n,e){var r=new rr,i=n;return null==n?(r.restart(t,n,e),r):(n=+n,e=null==e?nr():+e,r.restart(function o(u){u+=i,r.restart(o,i+=n,e),t(u)},n,e),r)},t.transition=Ar,t.active=function(t,n){var e,r,i=t.__transition;if(i)for(r in n=null==n?null:n+"",i)if((e=i[r]).state>pr&&e.name===n)return new Er([[t]],ci,n,+r);return null},t.interrupt=Mr,t.voronoi=function(){var t=Wg,n=Zg,e=null;function r(r){return new A_(r.map(function(e,i){var o=[Math.round(t(e,i,r)/k_)*k_,Math.round(n(e,i,r)/k_)*k_];return o.index=i,o.data=e,o}),e)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(n){return arguments.length?(t="function"==typeof n?n:$g(+n),r):t},r.y=function(t){return arguments.length?(n="function"==typeof t?t:$g(+t),r):n},r.extent=function(t){return arguments.length?(e=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},r.size=function(t){return arguments.length?(e=null==t?null:[[0,0],[+t[0],+t[1]]],r):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},r},t.zoom=function(){var n,e,r=U_,i=O_,o=B_,u=I_,a=Y_,c=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],f=250,l=Le,h=[],p=Y("start","zoom","end"),d=500,v=150,g=0;function _(t){t.property("__zoom",F_).on("wheel.zoom",T).on("mousedown.zoom",N).on("dblclick.zoom",k).filter(a).on("touchstart.zoom",S).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,n){return(n=Math.max(c[0],Math.min(c[1],n)))===t.k?t:new P_(n,t.x,t.y)}function m(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new P_(t.k,r,i)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,n,e){t.on("start.zoom",function(){w(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).end()}).tween("zoom",function(){var t=arguments,r=w(this,t),o=i.apply(this,t),u=e||x(o),a=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),c=this.__zoom,s="function"==typeof n?n.apply(this,t):n,f=l(c.invert(u).concat(a/c.k),s.invert(u).concat(a/s.k));return function(t){if(1===t)t=s;else{var n=f(t),e=a/n[2];t=new P_(e,u[0]-n[0]*e,u[1]-n[1]*e)}r.zoom(null,t)}})}function w(t,n){for(var e,r=0,i=h.length;r<i;++r)if((e=h[r]).that===t)return e;return new M(t,n)}function M(t,n){this.that=t,this.args=n,this.index=-1,this.active=0,this.extent=i.apply(t,n)}function T(){if(r.apply(this,arguments)){var t=w(this,arguments),n=this.__zoom,e=Math.max(c[0],Math.min(c[1],n.k*Math.pow(2,u.apply(this,arguments)))),i=It(this);if(t.wheel)t.mouse[0][0]===i[0]&&t.mouse[0][1]===i[1]||(t.mouse[1]=n.invert(t.mouse[0]=i)),clearTimeout(t.wheel);else{if(n.k===e)return;t.mouse=[i,n.invert(i)],Mr(this),t.start()}D_(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},v),t.zoom("mouse",o(m(y(n,e),t.mouse[0],t.mouse[1]),t.extent,s))}}function N(){if(!e&&r.apply(this,arguments)){var n=w(this,arguments),i=Lt(t.event.view).on("mousemove.zoom",function(){if(D_(),!n.moved){var e=t.event.clientX-a,r=t.event.clientY-c;n.moved=e*e+r*r>g}n.zoom("mouse",o(m(n.that.__zoom,n.mouse[0]=It(n.that),n.mouse[1]),n.extent,s))},!0).on("mouseup.zoom",function(){i.on("mousemove.zoom mouseup.zoom",null),Xt(t.event.view,n.moved),D_(),n.end()},!0),u=It(this),a=t.event.clientX,c=t.event.clientY;jt(t.event.view),q_(),n.mouse=[u,this.__zoom.invert(u)],Mr(this),n.start()}}function k(){if(r.apply(this,arguments)){var n=this.__zoom,e=It(this),u=n.invert(e),a=n.k*(t.event.shiftKey?.5:2),c=o(m(y(n,a),e,u),i.apply(this,arguments),s);D_(),f>0?Lt(this).transition().duration(f).call(b,c,e):Lt(this).call(_.transform,c)}}function S(){if(r.apply(this,arguments)){var e,i,o,u,a=w(this,arguments),c=t.event.changedTouches,s=c.length;for(q_(),i=0;i<s;++i)u=[u=Yt(this,c,(o=c[i]).identifier),this.__zoom.invert(u),o.identifier],a.touch0?a.touch1||(a.touch1=u):(a.touch0=u,e=!0);if(n&&(n=clearTimeout(n),!a.touch1))return a.end(),void((u=Lt(this).on("dblclick.zoom"))&&u.apply(this,arguments));e&&(n=setTimeout(function(){n=null},d),Mr(this),a.start())}}function E(){var e,r,i,u,a=w(this,arguments),c=t.event.changedTouches,f=c.length;for(D_(),n&&(n=clearTimeout(n)),e=0;e<f;++e)i=Yt(this,c,(r=c[e]).identifier),a.touch0&&a.touch0[2]===r.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===r.identifier&&(a.touch1[0]=i);if(r=a.that.__zoom,a.touch1){var l=a.touch0[0],h=a.touch0[1],p=a.touch1[0],d=a.touch1[1],v=(v=p[0]-l[0])*v+(v=p[1]-l[1])*v,g=(g=d[0]-h[0])*g+(g=d[1]-h[1])*g;r=y(r,Math.sqrt(v/g)),i=[(l[0]+p[0])/2,(l[1]+p[1])/2],u=[(h[0]+d[0])/2,(h[1]+d[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],u=a.touch0[1]}a.zoom("touch",o(m(r,i,u),a.extent,s))}function A(){var n,r,i=w(this,arguments),o=t.event.changedTouches,u=o.length;for(q_(),e&&clearTimeout(e),e=setTimeout(function(){e=null},d),n=0;n<u;++n)r=o[n],i.touch0&&i.touch0[2]===r.identifier?delete i.touch0:i.touch1&&i.touch1[2]===r.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0?i.touch0[1]=this.__zoom.invert(i.touch0[0]):i.end()}return _.transform=function(t,n){var e=t.selection?t.selection():t;e.property("__zoom",F_),t!==e?b(t,n):e.interrupt().each(function(){w(this,arguments).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()})},_.scaleBy=function(t,n){_.scaleTo(t,function(){return this.__zoom.k*("function"==typeof n?n.apply(this,arguments):n)})},_.scaleTo=function(t,n){_.transform(t,function(){var t=i.apply(this,arguments),e=this.__zoom,r=x(t),u=e.invert(r),a="function"==typeof n?n.apply(this,arguments):n;return o(m(y(e,a),r,u),t,s)})},_.translateBy=function(t,n,e){_.transform(t,function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),i.apply(this,arguments),s)})},_.translateTo=function(t,n,e){_.transform(t,function(){var t=i.apply(this,arguments),r=this.__zoom,u=x(t);return o(R_.translate(u[0],u[1]).scale(r.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,s)})},M.prototype={start:function(){return 1==++this.active&&(this.index=h.push(this)-1,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(h.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){At(new z_(_,t,this.that.__zoom),p.apply,p,[t,this.that,this.args])}},_.wheelDelta=function(t){return arguments.length?(u="function"==typeof t?t:C_(+t),_):u},_.filter=function(t){return arguments.length?(r="function"==typeof t?t:C_(!!t),_):r},_.touchable=function(t){return arguments.length?(a="function"==typeof t?t:C_(!!t),_):a},_.extent=function(t){return arguments.length?(i="function"==typeof t?t:C_([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),_):i},_.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],_):[c[0],c[1]]},_.translateExtent=function(t){return arguments.length?(s[0][0]=+t[0][0],s[1][0]=+t[1][0],s[0][1]=+t[0][1],s[1][1]=+t[1][1],_):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},_.constrain=function(t){return arguments.length?(o=t,_):o},_.duration=function(t){return arguments.length?(f=+t,_):f},_.interpolate=function(t){return arguments.length?(l=t,_):l},_.on=function(){var t=p.on.apply(p,arguments);return t===p?_:t},_.clickDistance=function(t){return arguments.length?(g=(t=+t)*t,_):Math.sqrt(g)},_},t.zoomTransform=L_,t.zoomIdentity=R_,Object.defineProperty(t,"__esModule",{value:!0})});
        /**
 * Fuse.js v6.4.6 - Lightweight fuzzy-search (http://fusejs.io)
 *
 * Copyright (c) 2021 Kiro Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var e,t;e=this,t=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){return Array.isArray?Array.isArray(e):"[object Array]"===y(e)}function u(e){return"string"==typeof e}function l(e){return"number"==typeof e}function d(t){return!0===t||!1===t||function(t){return function(t){return"object"===e(t)}(t)&&null!==t}(t)&&"[object Boolean]"==y(t)}function f(e){return null!=e}function v(e){return!e.trim().length}function y(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var g=function(e){return"Pattern length exceeds max of ".concat(e,".")},p=Object.prototype.hasOwnProperty,m=function(){function e(n){var r=this;t(this,e),this._keys=[],this._keyMap={};var i=0;n.forEach((function(e){var t=b(e);i+=t.weight,r._keys.push(t),r._keyMap[t.id]=t,i+=t.weight})),this._keys.forEach((function(e){e.weight/=i}))}return r(e,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),e}();function b(e){var t=null,n=null,r=null,i=1;if(u(e)||h(e))r=e,t=k(e),n=M(e);else{if(!p.call(e,"name"))throw new Error(function(e){return"Missing ".concat(e," property in key")}("name"));var o=e.name;if(r=o,p.call(e,"weight")&&(i=e.weight)<=0)throw new Error(function(e){return"Property 'weight' in key '".concat(e,"' must be a positive integer")}(o));t=k(o),n=M(o)}return{path:t,id:n,weight:i,src:r}}function k(e){return h(e)?e:e.split(".")}function M(e){return h(e)?e.join("."):e}var x=a({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(e,t){return e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1}},{},{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},{},{location:0,threshold:.6,distance:100},{},{useExtendedSearch:!1,getFn:function(e,t){var n=[],r=!1;return function e(t,i,o){if(f(t))if(i[o]){var a=t[i[o]];if(!f(a))return;if(o===i.length-1&&(u(a)||l(a)||d(a)))n.push(function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(a));else if(h(a)){r=!0;for(var c=0,s=a.length;c<s;c+=1)e(a[c],i,o+1)}else i.length&&e(a,i,o+1)}else n.push(t)}(e,u(t)?t.split("."):t,0),r?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1}),w=/[^ ]+/g;function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=new Map,n=Math.pow(10,e);return{get:function(e){var r=e.match(w).length;if(t.has(r))return t.get(r);var i=1/Math.sqrt(r),o=parseFloat(Math.round(i*n)/n);return t.set(r,o),o},clear:function(){t.clear()}}}var _=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.getFn,i=void 0===r?x.getFn:r;t(this,e),this.norm=L(3),this.getFn=i,this.isCreated=!1,this.setIndexRecords()}return r(e,[{key:"setSources",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=e}},{key:"setIndexRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=e}},{key:"setKeys",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=t,this._keysMap={},t.forEach((function(t,n){e._keysMap[t.id]=n}))}},{key:"create",value:function(){var e=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,u(this.docs[0])?this.docs.forEach((function(t,n){e._addString(t,n)})):this.docs.forEach((function(t,n){e._addObject(t,n)})),this.norm.clear())}},{key:"add",value:function(e){var t=this.size();u(e)?this._addString(e,t):this._addObject(e,t)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}},{key:"getValueForItemAtKeyId",value:function(e,t){return e[this._keysMap[t]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,t){if(f(e)&&!v(e)){var n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}}},{key:"_addObject",value:function(e,t){var n=this,r={i:t,$:{}};this.keys.forEach((function(t,i){var o=n.getFn(e,t.path);if(f(o))if(h(o))!function(){for(var e=[],t=[{nestedArrIndex:-1,value:o}];t.length;){var a=t.pop(),c=a.nestedArrIndex,s=a.value;if(f(s))if(u(s)&&!v(s)){var l={v:s,i:c,n:n.norm.get(s)};e.push(l)}else h(s)&&s.forEach((function(e,n){t.push({nestedArrIndex:n,value:e})}))}r.$[i]=e}();else if(!v(o)){var a={v:o,n:n.norm.get(o)};r.$[i]=a}})),this.records.push(r)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),e}();function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.getFn,i=void 0===r?x.getFn:r,o=new _({getFn:i});return o.setKeys(e.map(b)),o.setSources(t),o.create(),o}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.errors,r=void 0===n?0:n,i=t.currentLocation,o=void 0===i?0:i,a=t.expectedLocation,c=void 0===a?0:a,s=t.distance,h=void 0===s?x.distance:s,u=t.ignoreLocation,l=void 0===u?x.ignoreLocation:u,d=r/e.length;if(l)return d;var f=Math.abs(c-o);return h?d+f/h:f?1:d}function A(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.minMatchCharLength,n=[],r=-1,i=-1,o=0,a=e.length;o<a;o+=1){var c=e[o];c&&-1===r?r=o:c||-1===r||((i=o-1)-r+1>=t&&n.push([r,i]),r=-1)}return e[o-1]&&o-r>=t&&n.push([r,o-1]),n}function j(e){for(var t={},n=0,r=e.length;n<r;n+=1){var i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}var E=function(){function e(n){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.location,a=void 0===o?x.location:o,c=i.threshold,s=void 0===c?x.threshold:c,h=i.distance,u=void 0===h?x.distance:h,l=i.includeMatches,d=void 0===l?x.includeMatches:l,f=i.findAllMatches,v=void 0===f?x.findAllMatches:f,y=i.minMatchCharLength,g=void 0===y?x.minMatchCharLength:y,p=i.isCaseSensitive,m=void 0===p?x.isCaseSensitive:p,b=i.ignoreLocation,k=void 0===b?x.ignoreLocation:b;if(t(this,e),this.options={location:a,threshold:s,distance:u,includeMatches:d,findAllMatches:v,minMatchCharLength:g,isCaseSensitive:m,ignoreLocation:k},this.pattern=m?n:n.toLowerCase(),this.chunks=[],this.pattern.length){var M=function(e,t){r.chunks.push({pattern:e,alphabet:j(e),startIndex:t})},w=this.pattern.length;if(w>32){for(var L=0,_=w%32,S=w-_;L<S;)M(this.pattern.substr(L,32),L),L+=32;if(_){var O=w-32;M(this.pattern.substr(O),O)}}else M(this.pattern,0)}}return r(e,[{key:"searchIn",value:function(e){var t=this.options,n=t.isCaseSensitive,r=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var i={isMatch:!0,score:0};return r&&(i.indices=[[0,e.length-1]]),i}var o=this.options,a=o.location,s=o.distance,h=o.threshold,u=o.findAllMatches,l=o.minMatchCharLength,d=o.ignoreLocation,f=[],v=0,y=!1;this.chunks.forEach((function(t){var n=t.pattern,i=t.alphabet,o=t.startIndex,p=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.location,o=void 0===i?x.location:i,a=r.distance,c=void 0===a?x.distance:a,s=r.threshold,h=void 0===s?x.threshold:s,u=r.findAllMatches,l=void 0===u?x.findAllMatches:u,d=r.minMatchCharLength,f=void 0===d?x.minMatchCharLength:d,v=r.includeMatches,y=void 0===v?x.includeMatches:v,p=r.ignoreLocation,m=void 0===p?x.ignoreLocation:p;if(t.length>32)throw new Error(g(32));for(var b,k=t.length,M=e.length,w=Math.max(0,Math.min(o,M)),L=h,_=w,S=f>1||y,j=S?Array(M):[];(b=e.indexOf(t,_))>-1;){var E=O(t,{currentLocation:b,expectedLocation:w,distance:c,ignoreLocation:m});if(L=Math.min(E,L),_=b+k,S)for(var I=0;I<k;)j[b+I]=1,I+=1}_=-1;for(var C=[],F=1,P=k+M,N=1<<k-1,$=0;$<k;$+=1){for(var D=0,K=P;D<K;){var z=O(t,{errors:$,currentLocation:w+K,expectedLocation:w,distance:c,ignoreLocation:m});z<=L?D=K:P=K,K=Math.floor((P-D)/2+D)}P=K;var J=Math.max(1,w-K+1),R=l?M:Math.min(w+K,M)+k,T=Array(R+2);T[R+1]=(1<<$)-1;for(var U=R;U>=J;U-=1){var q=U-1,B=n[e.charAt(q)];if(S&&(j[q]=+!!B),T[U]=(T[U+1]<<1|1)&B,$&&(T[U]|=(C[U+1]|C[U])<<1|1|C[U+1]),T[U]&N&&(F=O(t,{errors:$,currentLocation:q,expectedLocation:w,distance:c,ignoreLocation:m}))<=L){if(L=F,(_=q)<=w)break;J=Math.max(1,2*w-_)}}var V=O(t,{errors:$+1,currentLocation:w,expectedLocation:w,distance:c,ignoreLocation:m});if(V>L)break;C=T}var G={isMatch:_>=0,score:Math.max(.001,F)};if(S){var H=A(j,f);H.length?y&&(G.indices=H):G.isMatch=!1}return G}(e,n,i,{location:a+o,distance:s,threshold:h,findAllMatches:u,minMatchCharLength:l,includeMatches:r,ignoreLocation:d}),m=p.isMatch,b=p.score,k=p.indices;m&&(y=!0),v+=b,m&&k&&(f=[].concat(c(f),c(k)))}));var p={isMatch:y,score:y?v/this.chunks.length:1};return y&&r&&(p.indices=f),p}}]),e}(),I=[];function C(e,t){for(var n=0,r=I.length;n<r;n+=1){var i=I[n];if(i.condition(e,t))return new i(e,t)}return new E(e,t)}function F(e,t){var n=t.ignoreFieldNorm,r=void 0===n?x.ignoreFieldNorm:n;e.forEach((function(e){var t=1;e.matches.forEach((function(e){var n=e.key,i=e.norm,o=e.score,a=n?n.weight:null;t*=Math.pow(0===o&&a?Number.EPSILON:o,(a||1)*(r?1:i))})),e.score=t}))}function P(e,t){var n=e.matches;t.matches=[],f(n)&&n.forEach((function(e){if(f(e.indices)&&e.indices.length){var n={indices:e.indices,value:e.value};e.key&&(n.key=e.key.src),e.idx>-1&&(n.refIndex=e.idx),t.matches.push(n)}}))}function N(e,t){t.score=e.score}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.includeMatches,i=void 0===r?x.includeMatches:r,o=n.includeScore,a=void 0===o?x.includeScore:o,c=[];return i&&c.push(P),a&&c.push(N),e.map((function(e){var n=e.idx,r={item:t[n],refIndex:n};return c.length&&c.forEach((function(t){t(e,r)})),r}))}var D=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if(t(this,e),this.options=a({},x,{},r),this.options.useExtendedSearch)throw new Error("Extended search is not available");this._keyStore=new m(this.options.keys),this.setCollection(n,i)}return r(e,[{key:"setCollection",value:function(e,t){if(this._docs=e,t&&!(t instanceof _))throw new Error("Incorrect 'index' type");this._myIndex=t||S(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function(e){f(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1},t=[],n=0,r=this._docs.length;n<r;n+=1){var i=this._docs[n];e(i,n)&&(this.removeAt(n),n-=1,r-=1,t.push(i))}return t}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.limit,r=void 0===n?-1:n,i=this.options,o=i.includeMatches,a=i.includeScore,c=i.shouldSort,s=i.sortFn,h=i.ignoreFieldNorm,d=u(e)?u(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return F(d,{ignoreFieldNorm:h}),c&&d.sort(s),l(r)&&r>-1&&(d=d.slice(0,r)),$(d,this._docs,{includeMatches:o,includeScore:a})}},{key:"_searchStringList",value:function(e){var t=C(e,this.options),n=this._myIndex.records,r=[];return n.forEach((function(e){var n=e.v,i=e.i,o=e.n;if(f(n)){var a=t.searchIn(n),c=a.isMatch,s=a.score,h=a.indices;c&&r.push({item:n,idx:i,matches:[{score:s,value:n,norm:o,indices:h}]})}})),r}},{key:"_searchLogical",value:function(e){throw new Error("Logical search is not available")}},{key:"_searchObjectList",value:function(e){var t=this,n=C(e,this.options),r=this._myIndex,i=r.keys,o=r.records,a=[];return o.forEach((function(e){var r=e.$,o=e.i;if(f(r)){var s=[];i.forEach((function(e,i){s.push.apply(s,c(t._findMatches({key:e,value:r[i],searcher:n})))})),s.length&&a.push({idx:o,item:r,matches:s})}})),a}},{key:"_findMatches",value:function(e){var t=e.key,n=e.value,r=e.searcher;if(!f(n))return[];var i=[];if(h(n))n.forEach((function(e){var n=e.v,o=e.i,a=e.n;if(f(n)){var c=r.searchIn(n),s=c.isMatch,h=c.score,u=c.indices;s&&i.push({score:h,key:t,value:n,idx:o,norm:a,indices:u})}}));else{var o=n.v,a=n.n,c=r.searchIn(o),s=c.isMatch,u=c.score,l=c.indices;s&&i.push({score:u,key:t,value:o,norm:a,indices:l})}return i}}]),e}();return D.version="6.4.6",D.createIndex=S,D.parseIndex=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.getFn,r=void 0===n?x.getFn:n,i=e.keys,o=e.records,a=new _({getFn:r});return a.setKeys(i),a.setIndexRecords(o),a},D.config=x,D},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Fuse=t();
    </script>
</head>

<body>

    

    <aside class="menu list-content-container">

        <header role="banner">
            

            
            <h1 class="title">Démo de Cosma</h1>
            

            <div class="load-bar" onclick="updateForces()" title="Spatialisation (Espace)">
                <div id="load-bar-value"></div>
            </div>
        </header>

        <section>
            <input class="search-bar" id="search" placeholder="Rechercher… (S)" autocomplete="off" role="search" />
            <ul id="search-result-list"></ul>
        </section>

        <details class="menu-types" open="open">
            <summary class="menu-title">
                Types <span id="types-counter" class="badge">2</span>
            </summary>

            <ul class="menu-types-list">
                
                <li class="filter n_documentation">
                    <label>
                        <input data-filter="20210901134745,20210901145632,20210901133951,20210901131627,20210901133503,20210901140150,20210901141048,20210901133623,20210901142849,20210901143845,20210901143447,20210901133701,20210901142644,20210901134136,20210901143958,20210901132906,20210901134026,20210901133736,20210901143014,20210901143134,20210901144524,20210901132721,20210901144304" name="documentation"
                            type="checkbox" checked onchange="filter(this.checked, this.dataset.filter, this, true)">
                        documentation
                        <span class="badge">23</span>
                    </label>
                </li>
                
                <li class="filter n_important">
                    <label>
                        <input data-filter="20210901150958" name="important"
                            type="checkbox" checked onchange="filter(this.checked, this.dataset.filter, this, true)">
                        important
                        <span class="badge">1</span>
                    </label>
                </li>
                
            </ul>
        </details>

        

        <details class="menu-index" id="index" data-sort="record">
            <summary class="menu-title">
                Index <span id="index-counter" class="badge">24</span>
            </summary>

            <button class="menu-index-btn sort-btn">A-Z</button>

            <ul class="menu-index-list sort-box active">
                
                <li data-index="20210901134745" onclick="openRecord(20210901134745)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Citations et bibliographies</span>
                </li>
                
                <li data-index="20210901145632" onclick="openRecord(20210901145632)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Configuration</span>
                </li>
                
                <li data-index="20210901133951" onclick="openRecord(20210901133951)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Contenu des fichiers</span>
                </li>
                
                <li data-index="20210901131627" onclick="openRecord(20210901131627)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Cosma</span>
                </li>
                
                <li data-index="20210901133503" onclick="openRecord(20210901133503)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Cosmographe</span>
                </li>
                
                <li data-index="20210901140150" onclick="openRecord(20210901140150)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Cosmoscope</span>
                </li>
                
                <li data-index="20210901141048" onclick="openRecord(20210901141048)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Créer un cosmoscope</span>
                </li>
                
                <li data-index="20210901133623" onclick="openRecord(20210901133623)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Créer une fiche</span>
                </li>
                
                <li data-index="20210901150958" onclick="openRecord(20210901150958)">
                    <span class="record-type-point n_important">⬤</span>
                    <span>Effet des modifications d’affichage</span>
                </li>
                
                <li data-index="20210901142849" onclick="openRecord(20210901142849)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Fiches</span>
                </li>
                
                <li data-index="20210901143845" onclick="openRecord(20210901143845)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Filtrer l’affichage par mots-clés</span>
                </li>
                
                <li data-index="20210901143447" onclick="openRecord(20210901143447)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Filtrer l’affichage par types</span>
                </li>
                
                <li data-index="20210901133701" onclick="openRecord(20210901133701)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Format de données</span>
                </li>
                
                <li data-index="20210901142644" onclick="openRecord(20210901142644)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Graphe</span>
                </li>
                
                <li data-index="20210901134136" onclick="openRecord(20210901134136)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Identifiants uniques</span>
                </li>
                
                <li data-index="20210901143958" onclick="openRecord(20210901143958)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Index</span>
                </li>
                
                <li data-index="20210901132906" onclick="openRecord(20210901132906)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Installation</span>
                </li>
                
                <li data-index="20210901134026" onclick="openRecord(20210901134026)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Liens</span>
                </li>
                
                <li data-index="20210901133736" onclick="openRecord(20210901133736)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Métadonnées (fiche)</span>
                </li>
                
                <li data-index="20210901143014" onclick="openRecord(20210901143014)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Mode focus</span>
                </li>
                
                <li data-index="20210901143134" onclick="openRecord(20210901143134)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Moteur de recherche</span>
                </li>
                
                <li data-index="20210901144524" onclick="openRecord(20210901144524)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Partager un cosmoscope</span>
                </li>
                
                <li data-index="20210901132721" onclick="openRecord(20210901132721)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Présentation</span>
                </li>
                
                <li data-index="20210901144304" onclick="openRecord(20210901144304)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Vues</span>
                </li>
                
            </ul>

            <ul class="menu-index-list sort-box">
                
                <li data-index="20210901144304" onclick="openRecord(20210901144304)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Vues</span>
                </li>
                
                <li data-index="20210901132721" onclick="openRecord(20210901132721)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Présentation</span>
                </li>
                
                <li data-index="20210901144524" onclick="openRecord(20210901144524)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Partager un cosmoscope</span>
                </li>
                
                <li data-index="20210901143134" onclick="openRecord(20210901143134)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Moteur de recherche</span>
                </li>
                
                <li data-index="20210901143014" onclick="openRecord(20210901143014)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Mode focus</span>
                </li>
                
                <li data-index="20210901133736" onclick="openRecord(20210901133736)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Métadonnées (fiche)</span>
                </li>
                
                <li data-index="20210901134026" onclick="openRecord(20210901134026)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Liens</span>
                </li>
                
                <li data-index="20210901132906" onclick="openRecord(20210901132906)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Installation</span>
                </li>
                
                <li data-index="20210901143958" onclick="openRecord(20210901143958)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Index</span>
                </li>
                
                <li data-index="20210901134136" onclick="openRecord(20210901134136)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Identifiants uniques</span>
                </li>
                
                <li data-index="20210901142644" onclick="openRecord(20210901142644)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Graphe</span>
                </li>
                
                <li data-index="20210901133701" onclick="openRecord(20210901133701)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Format de données</span>
                </li>
                
                <li data-index="20210901143447" onclick="openRecord(20210901143447)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Filtrer l’affichage par types</span>
                </li>
                
                <li data-index="20210901143845" onclick="openRecord(20210901143845)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Filtrer l’affichage par mots-clés</span>
                </li>
                
                <li data-index="20210901142849" onclick="openRecord(20210901142849)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Fiches</span>
                </li>
                
                <li data-index="20210901150958" onclick="openRecord(20210901150958)">
                    <span class="record-type-point n_important">⬤</span>
                    <span>Effet des modifications d’affichage</span>
                </li>
                
                <li data-index="20210901133623" onclick="openRecord(20210901133623)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Créer une fiche</span>
                </li>
                
                <li data-index="20210901141048" onclick="openRecord(20210901141048)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Créer un cosmoscope</span>
                </li>
                
                <li data-index="20210901140150" onclick="openRecord(20210901140150)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Cosmoscope</span>
                </li>
                
                <li data-index="20210901133503" onclick="openRecord(20210901133503)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Cosmographe</span>
                </li>
                
                <li data-index="20210901131627" onclick="openRecord(20210901131627)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Cosma</span>
                </li>
                
                <li data-index="20210901133951" onclick="openRecord(20210901133951)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Contenu des fichiers</span>
                </li>
                
                <li data-index="20210901145632" onclick="openRecord(20210901145632)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Configuration</span>
                </li>
                
                <li data-index="20210901134745" onclick="openRecord(20210901134745)">
                    <span class="record-type-point n_documentation">⬤</span>
                    <span>Citations et bibliographies</span>
                </li>
                
            </ul>
        </details>

        <details class="menu-view" open="open">
            <summary class="menu-title">
                Vues <span class="badge">0</span>
            </summary>

            <button onclick="resetView()">Réinitialiser la vue actuelle (Alt + R)</button>

            <button id="view-save" onclick="saveView()" hidden>Sauvegarder la vue actuelle</button>

            <span class="tooltip">?
                <span class="tooltiptext">Enregistre l'état actuel de l'interface
                    (types actifs, mots-clés actifs, mode focus) et crée un raccourci vers cet état dans le menu Vues.</span>
            </span>

            <div class="menu-view-container" id="views-container">
            
                
            
            </div>
        </details>

        <details class="menu-controls">
            <summary class="menu-title">Paramètres du graphe</summary>

            <ul class="menu-controls-list">
                <li>
                    <label>
                        <input type="checkbox" checked onchange="linksDisplayToggle(this.checked)">
                        Afficher les liens <span class="badge">29</span>
                    </label>
                </li>
                <li>
                    <label>
                        <input type="checkbox" checked onchange="labelDisplayToggle(this.checked)">
                        Afficher les étiquettes
                    </label>
                </li>
                <li>
                    <label>
                        <input type="checkbox" checked
                            onchange="graphProperties.highlight_on_hover = this.checked">
                        Surbrillance au survol
                    </label>
                </li>
            </ul>

            

            <article class="menu-controls-container">
                <p class="menu-controls-title">
                    Attraction
                    <span class="tooltip">?
                        <span class="tooltiptext">Contrôlez la répartition des nœuds dans l’espace, la force de répulsion,
                                la distance maximum sur laquelle ils se déploient et la pression sur les axes verticaux et horizontaux.</span>
                    </span>
                </p>
                
            <form oninput="graphProperties.attraction.force = range.value; updateForces()">
                <label>force</label>
                <input type="number" value="600" name="number" min="50" max="600" oninput="range.value = number.value"/>
                <input type="range" min="50" max="600" value="600" name="range" step="0.1" oninput="number.value = range.value"/>
            </form>
            
                
            <form oninput="graphProperties.attraction.distance_max = range.value; updateForces()">
                <label>distance max</label>
                <input type="number" value="800" name="number" min="0" max="800" oninput="range.value = number.value"/>
                <input type="range" min="0" max="800" value="800" name="range" step="0.1" oninput="number.value = range.value"/>
            </form>
            
                
            <form oninput="graphProperties.attraction.verticale = range.value; updateForces()">
                <label>verticale</label>
                <input type="number" value="0" name="number" min="0" max="1" oninput="range.value = number.value"/>
                <input type="range" min="0" max="1" value="0" name="range" step="0.01" oninput="number.value = range.value"/>
            </form>
            
                
            <form oninput="graphProperties.attraction.horizontale = range.value; updateForces()">
                <label>horizontale</label>
                <input type="number" value="0" name="number" min="0" max="1" oninput="range.value = number.value"/>
                <input type="range" min="0" max="1" value="0" name="range" step="0.01" oninput="number.value = range.value"/>
            </form>
            
            </article>

            <article class="menu-controls-container">
                <p class="menu-controls-title">Texte</p>
                
            <form oninput="graphProperties.text_size = range.value; updateFontsize()">
                <label>taille</label>
                <input type="number" value="15" name="number" min="5" max="15" oninput="range.value = number.value"/>
                <input type="range" min="5" max="15" value="15" name="range" step="0.5" oninput="number.value = range.value"/>
            </form>
            
            </article>
        </details>

        <footer class="menu-footer">
            
            <button onclick="openRecord('citation-references', false)"
                class="bibliography-open" title="Données bibliographiques">
                Données
            </button>
            

            <button onclick="openRecord('help', false)">
                Aide
            </button>

            <button class="about" onclick="openRecord('credits', false)">
                Fabriqué avec Cosma – À propos
            </button>
        </footer>
    </aside>

    

    <main id="record-container" class="record-container">
        <button class="record-btn-close" onclick="closeRecord()">Fermer (Echap)</button>

        
        <article id="20210901134745" class="record">
            <header>
                <h1 class="record-title">Citations et bibliographies</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901134745</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Cosma intègre une fonctionnalité de traitement des citations qui repose sur le même écosystème que Zettlr : des données et styles bibliographiques respectant la norme CSL, et la syntaxe définie par Pandoc pour insérer des citations dans un texte.</p>
<p>Vous pouvez utiliser le gestionnaire de références bibliographiques <a href="https://www.zotero.org/">Zotero</a> avec l'extension <a href="https://retorque.re/zotero-better-bibtex/">Better BibTeX</a> afin de générer des clés de citation uniques pour chaque référence. Exportez vos données bibliographiques au format CSL JSON et renseignez le fichier dans la configuration de Cosma (voir <a href="#configuration">Configuration</a>).</p>
<p>Vous pouvez ensuite intégrer les clés de citation au sein de vos fiches en utilisant une syntaxe inspirée par <a href="https://pandoc.org/MANUAL.html#extension-citations">celle de Pandoc</a> :</p>
<pre><code>Sur la raison et la déraison graphique [@goody1979; @christin1995, 46-52]…
</code></pre>
<p>Cliquez sur Nouveau cosmoscope avec citations pour générer un cosmoscope avec le traitement des citations activé. Chaque clé de citation est alors remplacée par du texte formaté et une bibliographie est générée en-dessous du corps de chaque fiche contenant des références.</p>
<pre><code>Sur la raison et la déraison graphique (Goody 1979 ; Christin 1995, p. 46-52)…

Bibliographie
-------------

GOODY, Jack, 1979. La Raison graphique : la domestication de la pensée sauvage.
  Paris : Les Editions de Minuit. ISBN 978-2-7073-0240-3.

CHRISTIN, Anne-Marie, 1995. L’image écrite, ou, La déraison graphique.
  Paris : Flammarion. Idées et recherches. ISBN 978-2-08-012635-1. 
</code></pre>
<p>Vous pouvez modifier le style de citation (par défaut : ISO690-author-date-fr) en indiquant un fichier de style CSL dans la configuration. Téléchargez des styles depuis la <a href="https://www.zotero.org/styles">base de données de Zotero</a>.</p>
<p>Vous pouvez modifier la traduction des mots-clés de la notice bibliographique (par défaut : français) en remplaçant le fichier <code>/template/citeproc/locales.xml</code>. Téléchargez une nouvelle traduction depuis la <a href="https://github.com/citation-style-language/locales/tree/6b0cb4689127a69852f48608b6d1a879900f418b">base de donnée CSL</a>.</p>
<p>Les données correspondant aux références citées sont enregistrées dans le cosmoscope au format JSON. Vous pouvez retrouver et télécharger ces données en cliquant sur le lien « Données », au bas du menu latéral gauche. Dans le code source du cosmoscope, elles se situent sous la balise <code>&lt;article id=&quot;citation-references&quot;&gt;</code>.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133701)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Format de données</span>
                            <div class="record-links-context">
                                Cosma inclut également une fonctionnalité optionnelle pour automatiser les <mark>→</mark> citations et bibliographies. Le format adopté est basé sur le standard CSL et sur la syntaxe des citations de Pandoc.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901145632" class="record">
            <header>
                <h1 class="record-title">Configuration</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901145632</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <h2>Paramètres requis</h2>
<ul>
<li>Répertoire des fiches : chemin du répertoire contenant les fichiers Markdown à lire.</li>
<li>Enregistrer automatiquement les cosmoscopes dans l'historique : lorsque cette option est active, Cosma exporte automatiquement chaque cosmoscope dans un sous-répertoire horodaté du répertoire temporaire défini par le système d'exploitation. Cliquez sur Afficher l'historique pour consulter et gérer les entrées de l'historique.</li>
<li>Types de fiches : liste des types de fiches. Chaque type est défini par un nom et une couleur. Ajoutez <code>type: nom</code> à l'en-tête en YAML d'une fiche pour lui attribuer ce type.</li>
<li>Types de liens : liste des types de liens. Chaque type est défini par un nom, une couleur et un type de trait. Les types de traits disponibles sont : continu (<em>simple</em>), double (<em>double</em>), tirets (<em>dash</em>), pointillés (<em>dotted</em>). Pour qualifier un lien dans une fiche, préfixez l'identifiant par le nom d'un type de lien suivi d'un deux-points. Exemple : <code>[[type_de_lien:ID]]</code>.</li>
</ul>
<p><strong>Attention !</strong> Le type par défaut <code>undefined</code> doit obligatoirement être défini, que ce soit pour les types de fiches ou pour les types de liens.</p>
<p><strong>Astuce :</strong> le paramétrage visuel des liens a une incidence sur leur lisibilité au sein du graphe. La capture d'écran ci-dessous montre la configuration d'un utilisateur qui a défini trois types de liens qualifiés à la manière d'un thésaurus (<code>s</code> pour spécifique, <code>g</code> pour générique et <code>a</code> pour associé). Les couleurs et les types de traits ont été choisis de manière à renforcer la visibilité des liens qualifiés : les liens non qualifiés (<code>undefined</code>) sont en pointillés (<code>dotted</code>) gris (<code>grey</code>), tandis que les liens qualifiés sont plus lisibles, grâce à des traits continus (<code>simple</code>) et une couleur plus foncée (<code>black</code>).</p>
<h2>Paramètres du graphe</h2>
<p>Les paramètres du graphe peuvent être modifiés en direct dans le cosmoscope. Vous pouvez ainsi tester différentes valeurs avant de les reporter dans la configuration. Ce sont les valeurs définies dans la configuration qui sont rétablies à chaque rechargement du cosmoscope, et chaque nouvelle génération d'un cosmoscope.</p>
<ul>
<li>Afficher des flèches sur les liens : permet d'obtenir un graphe orienté ou non orienté.</li>
<li>Niveau maximum de focus : le mode focus restreint l'affichage au nœud sélectionné et à ses connexions directes (1 nœud de distance). Il est possible de faire varier la distance d'affichage du mode focus : passer à 2 affiche les connexions à 1 et 2 nœuds de distance ; passer à 3 étend l'affichage à 3 nœuds de distance ; etc. La valeur indiquée dans Niveau maximum de focus définit le seuil maximum pour cette fonctionnalité.</li>
<li>Taille du texte des étiquettes : définit la taille du texte des étiquettes des nœuds du graphe, c'est-à-dire de la place que prend le titre de chaque fiche sous le nœud correspondant. L'unité implicite est le pixel. La valeur minimale est 5 et la valeur maximale est 15.</li>
<li>Couleur de fond : la couleur de fond du graphe.</li>
<li>Couleur de surbrillance : la couleur qui s'applique aux nœuds ainsi qu'aux liens lors du survol et de la sélection.</li>
<li>Force d'attraction : correspond à la puissance globale de l'attraction simulée. Plus la valeur est faible, plus les liens entre les nœuds sont relâchés.</li>
<li>Distance maximum entre les nœuds : correspond au seuil maximal de répulsion entre les nœuds, quelle que soit la force. Au-delà d'une valeur de 1000, ce paramètre n'a pas d'effet mesurable.</li>
<li>Attraction verticale/horizontale : force d'attraction vers l'axe vertical/horizontal, de 0 à 1. Une valeur de <code>0</code> signifie que le paramètre est désactivé. Appliquer une force verticale/horizontale resserre le graphe et permet de ramener plus près du centre les nœuds isolés.</li>
</ul>
<h2>Paramètres additionnels</h2>
<ul>
<li>Métadonnées : ces métadonnées facultatives sont ajoutées au volet À propos des cosmoscopes exportés en cliquant sur Partager.</li>
<li>Bibliographie : indiquez ici les chemins des fichiers de données, style et localisation bibliographique. Les trois fichiers sont requis pour le traitement des citations.</li>
<li>Vues : gérez ici les vues enregistrées dans le cosmoscope.</li>
<li>Symbole de lien : saisissez ici une chaîne de caractères Unicode arbitraire. Elle remplacera l'identifiant entre les crochets dans le rendu HTML des fiches. Ceci permet d'alléger visuellement le texte de vos fiches en remplaçant les longs identifiants numériques par une convention personnelle (par exemple une petite manicule : ☞).</li>
<li>Activer les outils de développement : cette option permet d'afficher le menu Développement dans la barre des menus du système d'exploitation. Cliquez sur Développement › Afficher l'inspecteur web pour afficher les outils de développement du moteur Chromium et inspecter le code de l'interface de Cosma.</li>
<li>CSS personnalisée : indiquez ici le chemin d'un fichier CSS.</li>
<li>Utiliser une CSS personnalisée : applique le contenu du fichier indiqué dans CSS personnalisée aux cosmoscopes générés par Cosma.</li>
</ul>
<p>Pour connaître les sélecteurs à utiliser pour telle ou telle déclaration, vous pouvez :</p>
<ul>
<li>cliquer sur Développement › Afficher l'inspecteur web (nécessite de cliquer sur Préférences › Activer les outils de développement) ;</li>
<li>ouvrir le cosmoscope dans votre navigateur web et utiliser les outils de développement du navigateur ;</li>
<li>consulter le code source de Cosma, spécifiquement <code>/cosmoscope/template.njk</code> (pour connaître la structure HTML du cosmoscope), <code>/cosmoscope/styles.css</code> et <code>/cosmoscope/print.css</code> (pour les styles d'impression activés lors de l'impression d'une fiche).</li>
</ul>
<p><strong>Astuce :</strong> les feuilles de style du cosmoscope utilisent notamment des variables CSS pour définir les couleurs et les polices utilisées. Vous pouvez redéfinir uniquement ces variables pour modifier tous les éléments d'interface auxquels elles s'appliquent. Dans l'exemple ci-dessous, le fichier <code>custom.css</code> contient des déclarations qui modifient les polices utilisées dans le cosmoscope :</p>
<pre><code class="language-css">:root {
  --sans: &quot;IBM Plex Sans&quot;, sans-serif;
  --serif: &quot;IBM Plex Serif&quot;, serif;
  --mono: &quot;IBM Plex Mono&quot;, monospace;
  --condensed: 'Avenir Next Condensed', sans-serif;
}
</code></pre>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901131627)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosma</span>
                            <div class="record-links-context">
                                Cliquez sur Préférences pour modifier la <mark>→</mark> configuration de Cosma.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901133951" class="record">
            <header>
                <h1 class="record-title">Contenu des fichiers</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901133951</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Cosma interprète les fichiers comme étant rédigés en Markdown (syntaxe originelle, pas de variante).</p>
<p><a href="https://www.arthurperret.fr/tutomd/">Référence et tutoriel Markdown</a></p>
<p>Le rendu des fichiers Markdown sous forme de fiche HTML dans le cosmoscope est limité aux éléments textuels. Les images par exemple ne sont pas incluses et seront remplacées par leur texte alternatif le cas échéant.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133701)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Format de données</span>
                            <div class="record-links-context">
                                - YAML pour les [[20210901133736]] métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du <mark>→</mark> contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des [[20210901134026]] liens internes ;
- des [[20210901134136]] identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901131627" class="record">
            <header>
                <h1 class="record-title">Cosma</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901131627</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Bienvenue sur Cosma, le logiciel de visualisation et de partage pour les travailleurs de la connaissance (Perret et al., 2021).</p>
<p>L'application Cosma se divise en deux parties : un <a href="#20210901133503" title="Cosmographe" onclick="openRecord(20210901133503)" class="record-link">→</a> cosmographe et un <a href="#20210901140150" title="Cosmoscope" onclick="openRecord(20210901140150)" class="record-link">→</a> cosmoscope. À partir d’un répertoire de fichiers rédigés en Markdown, le cosmographe génère une collection de fiches au format HTML, rassemblées dans un fichier qui peut être consulté dans l'application mais aussi de manière autonome : le cosmoscope.</p>
<p>Vous parcourez actuellement un cosmoscope qui constitue à la fois une aide au démarrage et une démonstration du fonctionnement de Cosma. <a href="https://cosma.graphlab.fr/docs/">La documentation complète est en ligne.</a></p>
<p>Cliquez sur Préférences pour modifier la <a href="#20210901145632" title="Configuration" onclick="openRecord(20210901145632)" class="record-link">→</a> configuration de Cosma.</p>


                
                <section class="bibliography">
                    <hr/>
                    <h1>Bibliographie</h1>
                      <div class="csl-entry">PERRET, Arthur, BRIOUDES, Guillaume, BOREL, Clément et LE DEUFF, Olivier, 2021. <i>Cosma</i> [en ligne]. Zenodo. Disponible à l’adresse : https://zenodo.org/record/5412315</div>

                </section>
                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">3</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901133503)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmographe</span>
                            <div class="record-links-context">
                                L'application Cosma se divise en deux parties : un <mark>→</mark> cosmographe et un [[20210901140150]] cosmoscope. À partir d’un répertoire de fichiers rédigés en Markdown, le cosmographe génère une collection de fiches au format HTML, rassemblées dans un fichier qui peut être consulté dans l'application mais aussi de manière autonome : le cosmoscope.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                L'application Cosma se divise en deux parties : un [[20210901133503]] cosmographe et un <mark>→</mark> cosmoscope. À partir d’un répertoire de fichiers rédigés en Markdown, le cosmographe génère une collection de fiches au format HTML, rassemblées dans un fichier qui peut être consulté dans l'application mais aussi de manière autonome : le cosmoscope.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901145632)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Configuration</span>
                            <div class="record-links-context">
                                Cliquez sur Préférences pour modifier la <mark>→</mark> configuration de Cosma.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">2</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901132906)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Installation</span>
                            <div class="record-links-context">
                                [Visitez la page Releases du dépôt GitHub](https://github.com/graphlab-fr/cosma/releases/latest) pour accéder à la version la plus récente de <mark>→</mark> Cosma. Vous pouvez y lire les notes de version et télécharger le logiciel dans la version qui correspond à votre système d'exploitation (fichier `.app` pour macOS, `.exe` pour Windows).
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901132721)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Présentation</span>
                            <div class="record-links-context">
                                <mark>→</mark> Cosma est un logiciel de visualisation de graphe documentaire. Il permet de représenter des notes interreliées sous la forme d’un réseau interactif dans une interface web. Le logiciel est conçu pour fonctionner avec des fichiers texte en Markdown et s’adapte aussi bien à une petite collection (centaine de documents) qu’à une vaste documentation (jusqu'à plusieurs milliers de documents).
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901133503" class="record">
            <header>
                <h1 class="record-title">Cosmographe</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901133503</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Le cosmographe est la partie de Cosma qui sert à configurer le fonctionnement de l'application et à faciliter la création de contenus. C'est une application pour ordinateur de bureau, à interface graphique, qui consiste en un ensemble de formulaires, de menus et de panneaux.</p>
<p>Le cosmographe permet de <a href="#20210901133623" title="Créer une fiche" onclick="openRecord(20210901133623)" class="record-link">→</a> créer des fiches ainsi que de <a href="#20210901141048" title="Créer un cosmoscope" onclick="openRecord(20210901141048)" class="record-link">→</a> créer des cosmoscopes et <a href="#20210901144524" title="Partager un cosmoscope" onclick="openRecord(20210901144524)" class="record-link">→</a> partager des cosmoscopes.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">3</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901133623)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Créer une fiche</span>
                            <div class="record-links-context">
                                Le cosmographe permet de <mark>→</mark> créer des fiches ainsi que de [[20210901141048]] créer des cosmoscopes et [[20210901144524]] partager des cosmoscopes.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901141048)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Créer un cosmoscope</span>
                            <div class="record-links-context">
                                Le cosmographe permet de [[20210901133623]] créer des fiches ainsi que de <mark>→</mark> créer des cosmoscopes et [[20210901144524]] partager des cosmoscopes.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901144524)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Partager un cosmoscope</span>
                            <div class="record-links-context">
                                Le cosmographe permet de [[20210901133623]] créer des fiches ainsi que de [[20210901141048]] créer des cosmoscopes et <mark>→</mark> partager des cosmoscopes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901131627)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosma</span>
                            <div class="record-links-context">
                                L'application Cosma se divise en deux parties : un <mark>→</mark> cosmographe et un [[20210901140150]] cosmoscope. À partir d’un répertoire de fichiers rédigés en Markdown, le cosmographe génère une collection de fiches au format HTML, rassemblées dans un fichier qui peut être consulté dans l'application mais aussi de manière autonome : le cosmoscope.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901140150" class="record">
            <header>
                <h1 class="record-title">Cosmoscope</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901140150</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Le cosmoscope est la partie centrale de Cosma. C'est un fichier HTML qui contient à la fois les fiches (mises en forme pour la lecture), une visualisation interactive du relations entre les fiches, et des outils d'exploration. Il peut être utilisé aussi bien dans l'application Cosma qu'en dehors.</p>
<h2>Contenu</h2>
<p>Le cosmoscope est organisée en trois zones.</p>
<p>Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : <a href="#20210901143958" title="Index" onclick="openRecord(20210901143958)" class="record-link">→</a> index, <a href="#20210901143134" title="Moteur de recherche" onclick="openRecord(20210901143134)" class="record-link">→</a> moteur de recherche, filtres <a href="#20210901143447" title="Filtrer l’affichage par types" onclick="openRecord(20210901143447)" class="record-link">→</a> par types et <a href="#20210901143845" title="Filtrer l’affichage par mots-clés" onclick="openRecord(20210901143845)" class="record-link">→</a> par mots-clés, <a href="#20210901144304" title="Vues" onclick="openRecord(20210901144304)" class="record-link">→</a> vues.</p>
<p>La zone centrale du cosmoscope affiche le <a href="#20210901142644" title="Graphe" onclick="openRecord(20210901142644)" class="record-link">→</a> graphe et les contrôles associés (zoom, <a href="#20210901143014" title="Mode focus" onclick="openRecord(20210901143014)" class="record-link">→</a> mode focus).</p>
<p>Le panneau latéral droit du cosmoscope affiche les <a href="#20210901142849" title="Fiches" onclick="openRecord(20210901142849)" class="record-link">→</a> fiches, avec leurs métadonnées, leur contenu et une liste des liens sortants et entrants (rétroliens).</p>
<h2>Utilisation hors de Cosma</h2>
<p>Le cosmoscope peut être ouvert indépendammant de l'application Cosma, via un navigateur web. C'est un fichier qui peut être partagé comme n'importe quel autre fichier informatique : email, transfert de fichiers, messagerie, mise en ligne sur un serveur…</p>
<p>Lorsqu'un cosmoscope est mis en ligne, vous pouvez envoyer un lien vers une fiche en particulier en ajoutant son identifiant précédé d'un croisillon <code>#</code> en fin d'URL. Exemple :</p>
<p><code>https://domaine.fr/cosmoscope.html#20210427185546</code></p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">8</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901143958)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Index</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : <mark>→</mark> index, [[20210901143134]] moteur de recherche, filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143134)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Moteur de recherche</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, <mark>→</mark> moteur de recherche, filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143447)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Filtrer l’affichage par types</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, [[20210901143134]] moteur de recherche, filtres <mark>→</mark> par types et [[20210901143845]] par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143845)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Filtrer l’affichage par mots-clés</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, [[20210901143134]] moteur de recherche, filtres [[20210901143447]] par types et <mark>→</mark> par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901144304)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Vues</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, [[20210901143134]] moteur de recherche, filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, <mark>→</mark> vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901142644)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Graphe</span>
                            <div class="record-links-context">
                                La zone centrale du cosmoscope affiche le <mark>→</mark> graphe et les contrôles associés (zoom, [[20210901143014]] mode focus).
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143014)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Mode focus</span>
                            <div class="record-links-context">
                                La zone centrale du cosmoscope affiche le [[20210901142644]] graphe et les contrôles associés (zoom, <mark>→</mark> mode focus).
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901142849)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Fiches</span>
                            <div class="record-links-context">
                                Le panneau latéral droit du cosmoscope affiche les <mark>→</mark> fiches, avec leurs métadonnées, leur contenu et une liste des liens sortants et entrants (rétroliens).
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">3</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901131627)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosma</span>
                            <div class="record-links-context">
                                L'application Cosma se divise en deux parties : un [[20210901133503]] cosmographe et un <mark>→</mark> cosmoscope. À partir d’un répertoire de fichiers rédigés en Markdown, le cosmographe génère une collection de fiches au format HTML, rassemblées dans un fichier qui peut être consulté dans l'application mais aussi de manière autonome : le cosmoscope.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901141048)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Créer un cosmoscope</span>
                            <div class="record-links-context">
                                La principale fonctionnalité du cosmographe est de créer des <mark>→</mark> cosmoscopes. Après avoir été généré, le cosmoscope le plus récent est affiché dans la fenêtre principale de l'application Cosma.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901144524)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Partager un cosmoscope</span>
                            <div class="record-links-context">
                                Cliquez sur Partager pour lancer la génération d'un <mark>→</mark> cosmoscope destiné à être partagé.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901141048" class="record">
            <header>
                <h1 class="record-title">Créer un cosmoscope</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901141048</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>La principale fonctionnalité du cosmographe est de créer des <a href="#20210901140150" title="Cosmoscope" onclick="openRecord(20210901140150)" class="record-link">→</a> cosmoscopes. Après avoir été généré, le cosmoscope le plus récent est affiché dans la fenêtre principale de l'application Cosma.</p>
<h2>Cosmoscope simple</h2>
<p>Cliquez sur Nouveau cosmoscope (raccourci : <code>Cmd</code>/<code>Ctrl</code> + <code>R</code>) pour lancer la génération d'un nouveau cosmoscope.</p>
<h2>Cosmoscope avec traitement des citations</h2>
<p>Cliquez sur Nouveau cosmoscope avec citations (raccourci : <code>Maj</code> + <code>Cmd</code>/<code>Ctrl</code> + <code>R</code>) pour lancer la génération d'un nouveau cosmoscope en activant le traitement des citations. Ceci nécessite de renseigner au moins un fichier de données bibliographiques dans Préférences › <a href="#parametres-facultatifs">Paramètres facultatifs</a>.</p>
<h2>Gestion des erreurs</h2>
<p>Cosma crée automatiquement un rapport d'erreurs qui décrit les problèmes éventuellement rencontrés durant la génération d'un cosmoscope. Les erreurs peuvent être de deux types :</p>
<ul>
<li>des données empêchent le traitement d'un fichier (titre manquant, identifiant non unique) ;</li>
<li>des données sont inconnues (type de fiche ou de lien non reconnu, lien vers un identifiant non reconnu).</li>
</ul>
<p>Cliquez sur Afficher l'historique pour consulter les rapports d'erreurs associés à chaque cosmoscope généré.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">1</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                La principale fonctionnalité du cosmographe est de créer des <mark>→</mark> cosmoscopes. Après avoir été généré, le cosmoscope le plus récent est affiché dans la fenêtre principale de l'application Cosma.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133503)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmographe</span>
                            <div class="record-links-context">
                                Le cosmographe permet de [[20210901133623]] créer des fiches ainsi que de <mark>→</mark> créer des cosmoscopes et [[20210901144524]] partager des cosmoscopes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901133623" class="record">
            <header>
                <h1 class="record-title">Créer une fiche</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901133623</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Cliquez sur Nouvelle fiche pour ouvrir le formulaire de création de fiche de Cosma.</p>
<p>Le titre est obligatoire. Vous pouvez aussi assigner un type à la fiche, à définir préalablement dans la configuration. Vous pouvez également ajouter des mots-clés arbitraires à la fiche, en les séparant par des virgules.</p>
<p>Cliquez sur OK crée une fiche dans le répertoire indiqué dans Préférences › Répertoire des fiches (ou dans le répertoire par défaut si aucun répertoire n'a été renseigné).</p>
<p>Créer une fiche de cette manière génère un fichier conforme au <a href="#20210901133701" title="Format de données" onclick="openRecord(20210901133701)" class="record-link">→</a> format de données requis par Cosma.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">1</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901133701)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Format de données</span>
                            <div class="record-links-context">
                                Créer une fiche de cette manière génère un fichier conforme au <mark>→</mark> format de données requis par Cosma.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133503)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmographe</span>
                            <div class="record-links-context">
                                Le cosmographe permet de <mark>→</mark> créer des fiches ainsi que de [[20210901141048]] créer des cosmoscopes et [[20210901144524]] partager des cosmoscopes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901150958" class="record">
            <header>
                <h1 class="record-title">Effet des modifications d’affichage</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901150958</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>important</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Les fiches listées dans l’<a href="#20210901143958" title="Index" onclick="openRecord(20210901143958)" class="record-link">→</a> index ainsi que les suggestions affichées par le <a href="#20210901143134" title="Moteur de recherche" onclick="openRecord(20210901143134)" class="record-link">→</a> moteur de recherche sont affectées par les filtres <a href="#20210901143447" title="Filtrer l’affichage par types" onclick="openRecord(20210901143447)" class="record-link">→</a> par types et <a href="#20210901143845" title="Filtrer l’affichage par mots-clés" onclick="openRecord(20210901143845)" class="record-link">→</a> par mots-clés, ainsi que par le <a href="#20210901143014" title="Mode focus" onclick="openRecord(20210901143014)" class="record-link">→</a> mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.</p>
<p>Lorsque vous voulez commencer une nouvelle exploration, vous pouvez cliquer sur Réinitialiser l'affichage (raccourci : <code>Alt</code> + <code>R</code>). Toutes les fiches seront à nouveau listées dans l'index et accessible via le moteur de recherche.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">5</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901143958)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Index</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’<mark>→</mark> index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143134)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Moteur de recherche</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le <mark>→</mark> moteur de recherche sont affectées par les filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143447)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Filtrer l’affichage par types</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres <mark>→</mark> par types et [[20210901143845]] par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143845)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Filtrer l’affichage par mots-clés</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres [[20210901143447]] par types et <mark>→</mark> par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901143014)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Mode focus</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, ainsi que par le <mark>→</mark> mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
            </footer>
        </article>
        
        <article id="20210901142849" class="record">
            <header>
                <h1 class="record-title">Fiches</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901142849</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Les fiches peuvent êtres ouvertes en cliquant sur un nœud, une entrée de l'index, une suggestion du moteur de recherche, ou un lien dans le corps d'une fiche. Ouvrir une fiche affiche son contenu dans le panneau latéral droit. Dans un navigateur, cela met aussi à jour l'URL de la page avec l'identifiant de la fiche : ceci permet de naviguer entre les fiches visitées via les fonctionnalités Précédent / Suivant du navigateur, mais aussi de les retrouver dans l'historique ou encore d'obtenir un lien direct vers la fiche. Par rapport à un navigateur, Cosma inclut seulement la navigation via les boutons Précédent / Suivant (ainsi que les raccourcis correspondants qui utilisent les flèches du clavier).</p>
<p>Cliquer sur le bouton « Fermer » referme le volet et désélectionne le nœud correspondant dans le graphe.</p>
<p>Les liens présents dans les fiches sont cliquables. Vous pouvez ouvrir ces liens dans un nouvel onglet via un clic droit. Le titre du lien (affiché en infobulle après 1-2 secondes de survol) est celui de la fiche correspondante.</p>
<p><strong>Astuce :</strong> cliquez sur Préférences › Symbole de lien pour saisir une chaîne de caractères Unicode arbitraire qui remplacera l'identifiant entre les crochets dans le rendu HTML des fiches. Ceci permet d'alléger visuellement le texte de vos fiches en remplaçant les longs identifiants numériques par une convention personnelle (par exemple une petite manicule : ☞)</p>
<p>En bas de la fiche se trouve une liste des fiches vers lesquelles elle renvoie (liens sortants), ainsi que des fiches qui pointent vers elles (liens entrants ou rétroliens). Les liens et rétroliens sont contextualisés : au survol, une infobulle s'affiche, montrant le paragraphe dans lequel ce lien se trouve dans la fiche correspondante.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Le panneau latéral droit du cosmoscope affiche les <mark>→</mark> fiches, avec leurs métadonnées, leur contenu et une liste des liens sortants et entrants (rétroliens).
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901143845" class="record">
            <header>
                <h1 class="record-title">Filtrer l’affichage par mots-clés</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901143845</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>La liste des mots-clés située dans le panneau latéral gauche permet de mettre en évidence les fiches qui utilisent chaque mot-clé. Sélectionner un mot-clé met en surbrillance l'étiquette des nœuds correspondants dans le graphe et restreint l'index aux fiches correspondantes. Vous pouvez activer simultanément plusieurs mots-clés. Pour désactiver un mot-clé, cliquez à nouveau sur le bouton correspondant.</p>
<p>Pour qu'un mot-clé apparaisse, il suffit qu'il ait été déclaré dans au moins une fiche via le champ <code>tags</code>.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">2</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, [[20210901143134]] moteur de recherche, filtres [[20210901143447]] par types et <mark>→</mark> par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901150958)">
                            <span class="record-type-point n_important">⬤</span>
                            <span>Effet des modifications d’affichage</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres [[20210901143447]] par types et <mark>→</mark> par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901143447" class="record">
            <header>
                <h1 class="record-title">Filtrer l’affichage par types</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901143447</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>La liste des types de fiches située en haut du panneau latéral gauche permet de filtrer l'affichage. Cliquer sur un type permet de masquer et réafficher les fiches du type correspondant dans le graphe, l'index et les suggestions du moteur de recherche. Cliquer sur un type en maintenant la touche <code>Alt</code> enfoncée permet de masquer et réafficher les fiches des autres types.</p>
<p>Pour qu'un type apparaisse, il doit être déclaré dans Préférences › Types de fiches et être attribué à au moins une fiche.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">2</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, [[20210901143134]] moteur de recherche, filtres <mark>→</mark> par types et [[20210901143845]] par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901150958)">
                            <span class="record-type-point n_important">⬤</span>
                            <span>Effet des modifications d’affichage</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres <mark>→</mark> par types et [[20210901143845]] par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901133701" class="record">
            <header>
                <h1 class="record-title">Format de données</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901133701</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Cosma ne prescrit pas l'utilisation d'un logiciel d'écriture particulier. En revanche, créer du contenu pour Cosma passe par l'utilisation du format texte et la mise en pratique de plusieurs normes d'écriture :</p>
<ul>
<li>YAML pour les <a href="#20210901133736" title="Métadonnées (fiche)" onclick="openRecord(20210901133736)" class="record-link">→</a> métadonnées inscrites au début des fichiers ;</li>
<li>Markdown pour le reste du <a href="#20210901133951" title="Contenu des fichiers" onclick="openRecord(20210901133951)" class="record-link">→</a> contenu des fichiers ;</li>
<li>une syntaxe de type wiki (doubles crochets <code>[[ ]]</code>) pour créer des <a href="#20210901134026" title="Liens" onclick="openRecord(20210901134026)" class="record-link">→</a> liens internes ;</li>
<li>des <a href="#20210901134136" title="Identifiants uniques" onclick="openRecord(20210901134136)" class="record-link">→</a> identifiants uniques qui servent de cible aux liens internes.</li>
</ul>
<p>Cosma inclut également une fonctionnalité optionnelle pour automatiser les <a href="#20210901134745" title="Citations et bibliographies" onclick="openRecord(20210901134745)" class="record-link">→</a> citations et bibliographies. Le format adopté est basé sur le standard CSL et sur la syntaxe des citations de Pandoc.</p>
<p>Cette combinaison de normes d'écriture correspond au croisement de plusieurs cultures textuelles : la documentation (enrichir et indexer le contenu avec des métadonnées) ; les wikis (interrelier des connaissances) ; la méthode Zettelkasten (organiser ses notes) ; l'écriture académique avec Pandoc (utiliser le format texte comme source pour plusieurs autres formats). Cosma fonctionne donc particulièrement bien lorsqu'il est utilisé en tandem avec des environnements d'écriture qui adoptent également cette approche, comme <a href="https://zettlr.com">Zettlr</a> ou l'extension <a href="https://foambubble.github.io/foam/">Foam</a> pour Visual Studio Code et VSCodium.</p>
<p>Vous pouvez créer une fiche respectant ce format de données via le formulaire de l'application ou bien en passant directement par votre éditeur de texte préféré. Certains éditeurs de texte peuvent vous faire gagner du temps en vous permettant d'enregistrer des modèles de documents, ce que vous pouvez utiliser pour créer rapidement des fiches à destination de Cosma.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">5</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901133736)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Métadonnées (fiche)</span>
                            <div class="record-links-context">
                                - YAML pour les <mark>→</mark> métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du [[20210901133951]] contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des [[20210901134026]] liens internes ;
- des [[20210901134136]] identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901133951)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Contenu des fichiers</span>
                            <div class="record-links-context">
                                - YAML pour les [[20210901133736]] métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du <mark>→</mark> contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des [[20210901134026]] liens internes ;
- des [[20210901134136]] identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901134026)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Liens</span>
                            <div class="record-links-context">
                                - YAML pour les [[20210901133736]] métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du [[20210901133951]] contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des <mark>→</mark> liens internes ;
- des [[20210901134136]] identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901134136)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Identifiants uniques</span>
                            <div class="record-links-context">
                                - YAML pour les [[20210901133736]] métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du [[20210901133951]] contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des [[20210901134026]] liens internes ;
- des <mark>→</mark> identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901134745)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Citations et bibliographies</span>
                            <div class="record-links-context">
                                Cosma inclut également une fonctionnalité optionnelle pour automatiser les <mark>→</mark> citations et bibliographies. Le format adopté est basé sur le standard CSL et sur la syntaxe des citations de Pandoc.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133623)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Créer une fiche</span>
                            <div class="record-links-context">
                                Créer une fiche de cette manière génère un fichier conforme au <mark>→</mark> format de données requis par Cosma.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901142644" class="record">
            <header>
                <h1 class="record-title">Graphe</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901142644</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Le graphe située dans la zone centrale de l'interface affiche des nœuds étiquetés et interreliés. Chaque nœud correspond à une fiche ; l'étiquette correspond au titre de la fiche. Les liens correspondent aux liens établis entre les fiches via leur identifiant entre doubles crochets.</p>
<p>Survoler un nœud le met temporairement en surbrillance lui et ses connexions. Cliquer sur un nœud le met en surbrillance, ainsi que ses connexions, et ouvre la fiche correspondante.</p>
<p>Vous pouvez zoomer librement dans le graphe à la souris, au pavé tactile, en double cliquant sur le fond du graphe ou bien avec les boutons dédiés situés en bas à gauche. Appuyez sur la touche <code>C</code> pour zoomer sur un nœud sélectionné. Le bouton Recentrer (raccourci : touche <code>R</code>) réinitialise le zoom.</p>
<p>Les nœuds sont organisés dans l'espace par un algorithme de simulation de forces. Une barre colorée sous le logo Cosma témoigne de l'état de la simulation. Cliquez dessus (raccourci : touche <code>Espace</code>) pour lancer un cycle de simulation supplémentaire.</p>
<p><strong>Astuce :</strong> quelques pressions sur la touche <code>Espace</code> permettent de « déplier » progressivement un graphe emmêlé.</p>
<p>Le graphe n'est pas figé, les nœuds peuvent donc être déplacés par cliquer-glisser. Ils restent soumis en permanence à la simulation, donc il n'est pas possible de les disposer manuellement de manière arbitraire.</p>
<p>L'affichage du graphe peut être modifié de manière temporaire via les contrôles placés sous Paramètres du graphe dans le panneau latéral gauche. Pour modifier l'affichage de manière permanente, modifiez les valeurs par défaut des paramètres correspondants dans Préférences › <a href="#parametres-du-graphe">Paramètres du graphe</a>.</p>
<p><strong>Astuce :</strong> modifiez la force et la distance maximale entre les nœuds pour adapter l'affichage à la résolution et la taille de votre écran. Ajoutez une force d'attraction vers l'axe vertical/horizontal pour resserrer le graphe et ramener les nœuds isolés plus près du centre.</p>
<p>L'affichage est possible sur tous types d'écrans mais n'est pas optimisé pour les terminaux mobiles : le tactile ne donne pas accès à certaines interactions comme le survol, et les petits écrans restreignent l'utilité du graphe.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                La zone centrale du cosmoscope affiche le <mark>→</mark> graphe et les contrôles associés (zoom, [[20210901143014]] mode focus).
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901134136" class="record">
            <header>
                <h1 class="record-title">Identifiants uniques</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901134136</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>De nombreux logiciels de prise de notes interreliées proposent d'établir les liens entre fichiers via leurs noms, et de gérer automatiquement la maintenance des liens lorsque les noms de fichiers sont modifiés.</p>
<p>Cosma adopte un fonctionnement plus classique, proche de celui du Web. Chaque fiche possède un identifiant unique qui sert de cible aux liens. Par ailleurs Cosma n'intervient pas sur le contenu des fiches après leur création : il n'y a pas de maintenance automatique des liens susceptible de dysfonctionner. Ceci diminue le risque de <a href="https://fr.wikipedia.org/wiki/Lien_mort">lien mort</a> quel que soit le devenir des données.</p>
<p>Par défaut, Cosma génère des identifiants à 14 chiffres par horodatage (année, mois, jour, heures, minutes et secondes) sur le modèle de certains logiciels de prise de notes type Zettelkasten comme <a href="https://zettelkasten.de/the-archive/">The Archive</a> ou <a href="https://www.zettlr.com">Zettlr</a>.</p>
<p><strong>Astuce :</strong> L'inconvénient d'un lien basé sur un identifiant unique, c'est qu'il peut gêner la lecture du contenu, notamment lorsque l'identifiant est une longue série de chiffres. Utilisez Configuration › Symbole de lien pour alléger visuellement le texte de vos fiches en remplaçant les identifiants par une convention personnelle (par exemple une petite manicule : ☞).</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133701)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Format de données</span>
                            <div class="record-links-context">
                                - YAML pour les [[20210901133736]] métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du [[20210901133951]] contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des [[20210901134026]] liens internes ;
- des <mark>→</mark> identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901143958" class="record">
            <header>
                <h1 class="record-title">Index</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901143958</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>L'index alphabétique des fiches situé dans le panneau latéral gauche permet d'accéder directement à une fiche sans passer par le graphe. Cliquer sur un titre sélectionne le nœud correspondant dans le graphe et ouvre la fiche correspondante. L'index peut être trié par ordre alphabétique croissant ou décroissant.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">2</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : <mark>→</mark> index, [[20210901143134]] moteur de recherche, filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901150958)">
                            <span class="record-type-point n_important">⬤</span>
                            <span>Effet des modifications d’affichage</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’<mark>→</mark> index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901132906" class="record">
            <header>
                <h1 class="record-title">Installation</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901132906</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <h2>Installation</h2>
<p><a href="https://github.com/graphlab-fr/cosma/releases/latest">Visitez la page Releases du dépôt GitHub</a> pour accéder à la version la plus récente de <a href="#20210901131627" title="Cosma" onclick="openRecord(20210901131627)" class="record-link">→</a> Cosma. Vous pouvez y lire les notes de version et télécharger le logiciel dans la version qui correspond à votre système d'exploitation (fichier <code>.app</code> pour macOS, <code>.exe</code> pour Windows).</p>
<p>Lors du premier démarrage, Cosma affiche une documentation utilisateur sous forme de graphe. Cliquez sur Cosma › Préférences › Répertoire des fiches pour sélectionner un autre répertoire.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">1</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901131627)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosma</span>
                            <div class="record-links-context">
                                [Visitez la page Releases du dépôt GitHub](https://github.com/graphlab-fr/cosma/releases/latest) pour accéder à la version la plus récente de <mark>→</mark> Cosma. Vous pouvez y lire les notes de version et télécharger le logiciel dans la version qui correspond à votre système d'exploitation (fichier `.app` pour macOS, `.exe` pour Windows).
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
            </footer>
        </article>
        
        <article id="20210901134026" class="record">
            <header>
                <h1 class="record-title">Liens</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901134026</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>À l'intérieur des fiches, vous pouvez créer des liens avec l'identifiant de la fiche cible entre double crochets. Cosma reconnaît ces liens et les utilise pour modéliser le graphe des fiches.</p>
<p>Exemple :</p>
<pre><code>Un lien vers [[20201209111625]] une fiche.
</code></pre>
<p>Vous pouvez également paramétrer Cosma avec des types de liens ayant une couleur et un type de trait particuliers (voir <a href="#configuration">Configuration</a>). Pour qualifier un lien dans une fiche, préfixez l'identifiant par le nom d'un type de lien suivi d'un deux-points.</p>
<p>Exemple :</p>
<pre><code>Le concept B dérive du [[générique:20201209111625]] concept A.

La personne D a écrit contre [[opposant:20201209111625]] la personne C.
</code></pre>
<p><strong>Astuce :</strong> Cosma inclut également une option pour personnaliser l'apparence des liens dans le texte des fiches. Dans Configuration › Symbole de lien, entrez n'importe quelle chaîne de caractères Unicode qui remplacera l'identifiant entre les crochets dans le rendu HTML des fiches.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133701)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Format de données</span>
                            <div class="record-links-context">
                                - YAML pour les [[20210901133736]] métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du [[20210901133951]] contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des <mark>→</mark> liens internes ;
- des [[20210901134136]] identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901133736" class="record">
            <header>
                <h1 class="record-title">Métadonnées (fiche)</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901133736</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Pour être correctement interprétés par Cosma, les fichiers Markdown doivent respecter une certaine structure, et notamment la présence d'un en-tête en <a href="http://yaml.org">YAML</a> au début du fichier.</p>
<p>Exemple :</p>
<pre><code class="language-yaml">---
title: Titre du document
id: 20201209111625
type: undefined
tags:
- mot-clé 1
- mot-clé 2
---
</code></pre>
<p>L'en-tête YAML est délimité par deux séries de trois tirets seuls sur une ligne (<code>---</code>).</p>
<p>Un champ en YAML est composé d'un nom et d'une valeur séparés par un deux-points. Cosma reconnaît et utilise les quatre champs suivants :</p>
<p><code>title</code>
: Titre de la fiche. Obligatoire.</p>
<p><code>id</code>
: Identifiant unique de la fiche. Obligatoire. Par défaut, Cosma génère des identifiants à 14 chiffres par horodatage (année, mois, jour, heures, minutes et secondes) sur le modèle de certains logiciels de prise de notes type Zettelkasten comme <a href="https://zettelkasten.de/the-archive/">The Archive</a> ou <a href="https://www.zettlr.com">Zettlr</a>.</p>
<p><code>type</code>
: Type de la fiche. Facultatif. Un seul type peut être assigné à une fiche. Si le champ <code>type</code> n'est pas spécifié ou bien que sa valeur ne correspond à l'un des types enregistrés dans la configuration sous le paramètre <code>record_types</code>, Cosma interprètera le type de la fiche comme non défini (<code>undefined</code>).</p>
<p><code>tags</code>
: Mots-clés de la fiche. Facultatif. La valeur doit être une liste. Une fiche peut disposer d'autant de mot-clés que vous souhaitez.</p>
<p>Conformément à la spécification YAML, la liste des mots-clés peut être inscrite en mode <em>block</em> :</p>
<pre><code class="language-yaml">tags:
- mot-clé 1
- mot-clé 2
</code></pre>
<p>Ou bien en mode <em>flow</em> :</p>
<pre><code class="language-yaml">tags: [mot-clé 1, mot-clé 2]
</code></pre>
<p>Vous pouvez ajouter des champs supplémentaires de manière arbitraire, par exemple un champ <code>description</code>.</p>
<p><strong>Note :</strong> Certains logiciels établissent une série de présupposés qui servent à identifier les métadonnées d'un fichier de manière <strong>heuristique</strong>. Par exemple, si la première ligne du fichier est un titre de niveau 1, alors il s'agit du titre du fichier ; si la seconde ligne contient des mots préfixés par un croisillon <code>#</code>, alors il s'agit de mots-clés.</p>
<p>L'inconvénient de ce fonctionnement est qu'il n'est pas interopérable : chaque logiciel a ses propres conventions, ce qui limite la capacité de l'utilisateur à changer d'outil.</p>
<p>Utiliser un en-tête en YAML permet de déclarer des métadonnées comme le titre et l'identifiant unique d'une fiche de manière <strong>explicite</strong>. Ceci présente l'avantage de rendre triviale la détection et la manipulation de ces métadonnées, aussi bien par une machine que par un humain. L'utilisation d'un format commun (comme YAML) augmente le nombre d'outils compatibles avec un même ensemble de fichiers. Et des outils informatiques très répandus comme les expressions régulières et les scripts <em>shell</em> permettent aux utilisateurs de convertir eux-mêmes leurs données de manière relativement simple si besoin.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133701)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Format de données</span>
                            <div class="record-links-context">
                                - YAML pour les <mark>→</mark> métadonnées inscrites au début des fichiers ;
- Markdown pour le reste du [[20210901133951]] contenu des fichiers ;
- une syntaxe de type wiki (doubles crochets `[[ ]]`) pour créer des [[20210901134026]] liens internes ;
- des [[20210901134136]] identifiants uniques qui servent de cible aux liens internes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901143014" class="record">
            <header>
                <h1 class="record-title">Mode focus</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901143014</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Le bouton Activer le focus (raccourci : touche <code>F</code>) situé en bas à gauche du graphe permet de restreindre l'affichage au nœud sélectionné : en mode focus, seules les connexions directes à la fiche sélectionnée sont affichées dans l'interface. Le mode focus ne fonctionne que si vous avez sélectionné une fiche.</p>
<p>Une fois le mode focus activé, vous zoomez automatiquement sur le nœud sélectionné.</p>
<p>Le curseur qui apparaît sous le bouton Activer le focus permet de faire varier la distance d'affichage, jusqu'au maximum indiqué dans Préférences › Niveau maximum de focus.</p>
<p><strong>Astuce :</strong> le curseur du niveau de focus est contrôlable via les flèches du clavier. Vous pouvez enchaîner les raccourcis : <code>F</code> pour activer le focus, puis les flèches pour augmenter le niveau de focus.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">2</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                La zone centrale du cosmoscope affiche le [[20210901142644]] graphe et les contrôles associés (zoom, <mark>→</mark> mode focus).
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901150958)">
                            <span class="record-type-point n_important">⬤</span>
                            <span>Effet des modifications d’affichage</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le [[20210901143134]] moteur de recherche sont affectées par les filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, ainsi que par le <mark>→</mark> mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901143134" class="record">
            <header>
                <h1 class="record-title">Moteur de recherche</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901143134</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Le champ de texte situé en haut du panneau latéral gauche est un moteur de recherche qui fonctionne sur les titres de fiches. Il suggère une liste de fiches dont le titre est le plus proche de ce que vous saisissez dans la barre de recherche (<em>fuzzy search</em>). Cliquer sur une suggestion sélectionne le nœud correspondant dans le graphe et ouvre la fiche correspondante dans le panneau latéral de droite.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">2</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, <mark>→</mark> moteur de recherche, filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, [[20210901144304]] vues.
                            </div>
                        </li>
                        
                        <li onclick="openRecord(20210901150958)">
                            <span class="record-type-point n_important">⬤</span>
                            <span>Effet des modifications d’affichage</span>
                            <div class="record-links-context">
                                Les fiches listées dans l’[[20210901143958]] index ainsi que les suggestions affichées par le <mark>→</mark> moteur de recherche sont affectées par les filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, ainsi que par le [[20210901143014]] mode focus. Une fiche masquée par l'une l'autre de ces fonctionnalités ne sera pas accessible via le moteur de recherche et ne sera pas visible dans l'index.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901144524" class="record">
            <header>
                <h1 class="record-title">Partager un cosmoscope</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901144524</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>Cliquez sur Partager pour lancer la génération d'un <a href="#20210901140150" title="Cosmoscope" onclick="openRecord(20210901140150)" class="record-link">→</a> cosmoscope destiné à être partagé.</p>
<p>Cochez Traiter les citations si vous souhaitez activer le traitement des citations.</p>
<h2>Spécificités des cosmoscopes générés via la fonction Partager</h2>
<p>Le volet À propos du cosmoscope intègre automatiquement les métadonnées (titre, auteur, description, mots-clés) éventuellement renseignées dans Préférences › <a href="#parametres-facultatifs">Paramètres facultatifs</a>.</p>
<p>La barre d'outils présente au sommet du menu latéral gauche ne fonctionne que dans l'application Cosma. Elle est donc masquée dans les cosmoscopes exportés via Partager. Si un titre a été renseigné dans Préférences › Métadonnées, il s'affiche à l'emplacement qu'occupe habituellement la barre d'outils.</p>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">1</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Cliquez sur Partager pour lancer la génération d'un <mark>→</mark> cosmoscope destiné à être partagé.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901133503)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmographe</span>
                            <div class="record-links-context">
                                Le cosmographe permet de [[20210901133623]] créer des fiches ainsi que de [[20210901141048]] créer des cosmoscopes et <mark>→</mark> partager des cosmoscopes.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        <article id="20210901132721" class="record">
            <header>
                <h1 class="record-title">Présentation</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901132721</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p><a href="#20210901131627" title="Cosma" onclick="openRecord(20210901131627)" class="record-link">→</a> Cosma est un logiciel de visualisation de graphe documentaire. Il permet de représenter des notes interreliées sous la forme d’un réseau interactif dans une interface web. Le logiciel est conçu pour fonctionner avec des fichiers texte en Markdown et s’adapte aussi bien à une petite collection (centaine de documents) qu’à une vaste documentation (jusqu'à plusieurs milliers de documents).</p>
<p>Cosma est développé dans le cadre du programme de recherche ANR <a href="https://hyperotlet.hypotheses.org/">HyperOtlet</a>.</p>
<h2>Spécificités de Cosma</h2>
<p>Dans le vaste champ des outils qui servent à penser (<em>tools for thought</em>), Cosma se démarque par <strong>trois originalités</strong> :</p>
<p>D'abord, <strong>Cosma n'est pas lui-même un logiciel de prise de notes</strong>. Il est pensé pour fonctionner en complémentarité avec ces logiciels. Nous nous sommes inspirés ici du fonctionnement de logiciels comme <a href="https://www.deckset.com">Deckset</a>, qui applique ce principe aux présentations.</p>
<p>Ensuite, <strong>Cosma repose sur des normes d'écriture interopérables, ouvertes et standardisées</strong>. Ceci accroît la pérennité des données, facilite l'utilisation combinée avec des outils qui partagent ces normes (comme <a href="https://www.zettlr.com">Zettlr</a>), tout en laissant la possibilité de changer d'outil à tout moment.</p>
<p>Enfin, <strong>Cosma permet de partager simultanément les données et les outils pour les explorer</strong>. La plupart des outils de visualisation concentrent leurs fonctionnalités dans une application à interface graphique, à partir de laquelle il est possible d'exporter des données structurées ou des images statiques. Cosma inverse cette logique : l'application installée, surnommée <strong>cosmographe</strong>, est un simple outil de création et d'affichage qui accueille un fichier HTML surnommé <strong>cosmoscope</strong> ; c'est ce dernier qui constitue la véritable interface de visualisation, avec un graphe interactif, des outils de navigation interne (index, moteur de recherche, filtres) et le texte intégral des fiches. Or il s'agit d'un fichier autonome, qui inclut aussi les données sources au format JSON et peut être utilisé hors connexion. Ainsi dans Cosma, l'export est aussi puissant que l'application : <strong>en partageant un cosmoscope vous ne transmettez pas seulement des données mais des capacités heuristiques</strong>.</p>
<h2>Un degré élevé de contrôle utilisateur</h2>
<p>Cosma est conçu pour laisser un degré élevé de contrôle à ses utilisateurs.</p>
<p>Premièrement, le logiciel fonctionne avec un répertoire de fichiers au format texte qu'il se contente de lire : utiliser ou désinstaller le logiciel n'altérera pas vos fichiers et vous permet donc de mettre en œuvre les pratiques de stockage, de versionnement et d'édition de votre choix. De cette manière, <strong>si le logiciel s'envole les données restent</strong>.</p>
<p>Deuxièmement, <strong>de nombreux éléments d'interface sont personnalisables</strong> : algorithme de dessin de réseau, couleurs des nœuds, tracé des liens, raccourcis vers des vues particulières, etc.</p>
<p>Troisièmement, <strong>des enrichissements documentaires (métadonnées) et sémantiques (qualification des liens) sont possibles</strong> et se font par des mécanismes génériques : l'utilisateur est libre d'appliquer les typologies et ontologies de son choix.</p>
<p>Quatrièmement, Cosma est un logiciel modulaire, interopérable et portable mais surtout, <strong>c'est un logiciel libre</strong> : le code est public, son développement est documenté, il est accessible et réutilisable gratuitement sous licence MIT. Le travail peut ainsi être évalué, archivé et continué par d'autres.</p>
<h2>Un logiciel expérimental</h2>
<p>Enfin, Cosma est un logiciel expérimental, développé dans le cadre d'une démarche de recherche-conception.</p>
<p>L'idée de Cosma est née dans le cadre d'une recherche doctorale conduite par Arthur Perret sous la direction d'Olivier Le Deuff. Ce logiciel reste donc un travail expérimental, son utilisation est soumise à caution et aucune garantie de suivi ou de maintenance ne peut être donnée à ce jour.</p>
<p>Néanmoins, des efforts importants ont été entrepris dès le prototype pour concevoir soigneusement les différents aspects de l'outil, qu'il s'agisse de la visualisation de données ou de l'interaction humain-machine, notamment grâce à la participation de chercheurs spécialistes de ces domaines. Et Cosma est au cœur d'une dynamique de recherche que nous espérons inscrire dans la durée.</p>
<p>La version actuelle de Cosma est encore en bêta. Elle sera citable via DOI prochainement.</p>
<p>La première version de Cosma, rétroactivement libellée alpha, est archivée sur Zenodo. Elle peut être citée dans une bibliographie de la manière suivante :</p>
<blockquote>
<p>Arthur Perret, Guillaume Brioudes, Clément Borel, &amp; Olivier Le Deuff. (2021). Cosma (alpha). Zenodo. <a href="https://doi.org/10.5281/zenodo.4734377">https://doi.org/10.5281/zenodo.4734377</a></p>
</blockquote>


                
            </main>

            <footer class="list-content-container">
                
                <details class="record-links" open="open">
                    <summary class="menu-title">
                        Liens <span class="badge">1</span>
                    </summary>

                    <ul class="record-links-list">
                        
                        <li onclick="openRecord(20210901131627)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosma</span>
                            <div class="record-links-context">
                                <mark>→</mark> Cosma est un logiciel de visualisation de graphe documentaire. Il permet de représenter des notes interreliées sous la forme d’un réseau interactif dans une interface web. Le logiciel est conçu pour fonctionner avec des fichiers texte en Markdown et s’adapte aussi bien à une petite collection (centaine de documents) qu’à une vaste documentation (jusqu'à plusieurs milliers de documents).
                            </div>
                        </li>
                        
                    </ul>
                </details>
                

                
            </footer>
        </article>
        
        <article id="20210901144304" class="record">
            <header>
                <h1 class="record-title">Vues</h1>

                <div class="record-id">
                    <span>id :</span>
                    <span>20210901144304</span>
                </div>

                <div class="record-last-edit">
                    <span>dernière édition :</span>
                    <time class="record-date" datetime=""></time>
                </div>

                <div class="record-type">
                    <span>type :</span>
                    <span>documentation</span>
                </div>

                
            </header>

            <main class="record-content">
                <p>À tout moment, l'état de l'interface (fiche sélectionnée, filtres actifs, mode focus) peut être sauvegardé pour un accès rapide. Ceci fonctionne comme un marque-page. Cliquez sur le bouton Sauvegarder la vue et indiquez un nom. Ceci ajoute un bouton éponyme dans la section Vues du panneau latéral gauche. Cliquer sur ce bouton applique tous les paramètres qui étaient actifs au moment de l'enregistrement de la vue. Cliquer à nouveau sur le bouton rétablit l'affichage normal.</p>


                
            </main>

            <footer class="list-content-container">
                

                
                <details class="record-backlinks" open="open">
                    <summary class="menu-title">
                        Rétroliens <span class="badge">1</span>
                    </summary>

                    <ul class="record-backlinks-list">
                        
                        <li onclick="openRecord(20210901140150)">
                            <span class="record-type-point n_documentation">⬤</span>
                            <span>Cosmoscope</span>
                            <div class="record-links-context">
                                Le menu latéral gauche du cosmoscope regroupe les fonctionnalités permettant de chercher de l'information et de modifier l'affichage de manière globale : [[20210901143958]] index, [[20210901143134]] moteur de recherche, filtres [[20210901143447]] par types et [[20210901143845]] par mots-clés, <mark>→</mark> vues.
                            </div>
                        </li>
                        
                    </ul>
                </details>
                
            </footer>
        </article>
        
        
        
        
        <article id="help" class="record">
            <main>
                <h1>Aide</h1>
                
                <p><a href="https://hyperotlet.github.io/cosma/fr.html#utilisation-du-cosmoscope" target="_blank">Cliquez ici pour accéder à la documentation de Cosma</a></p>
                
                <h2>Raccourcis</h2>
                
                    <table>
                        <tbody>
                            <tr>
                                <td>Espace</td>
                                <td>Réactiver l'algorithme de dessin du graphe</td>
                            </tr>
                            <tr>
                                <td>S</td>
                                <td>Déplacer le curseur dans le champ Recherche</td>
                            </tr>
                            <tr>
                                <td>Alt + clic</td>
                                <td>(sur un type de fiche) Désélectionner les autres types</td>
                            </tr>
                            <tr>
                                <td>R</td>
                                <td>Réinitialiser le zoom</td>
                            </tr>
                            <tr>
                                <td>Alt + R</td>
                                <td>Réinitialiser tous les paramètres visuels</td>
                            </tr>
                            <tr>
                                <td>C</td>
                                <td>Zoomer sur le nœud de la fiche active</td>
                            </tr>
                            <tr>
                                <td>F</td>
                                <td>Passer en mode Focus</td>
                            </tr>
                            <tr>
                                <td>Echap</td>
                                <td>Fermer la fiche</td>
                            </tr>
                        </tbody>
                    </table>
            </main>
        </article>

        

        <article id="credits" class="record">
            <main>
                
                    
                    <p class="metas-description">Cosma est un logiciel de visualisation et de partage pour les travailleurs de la connaissance. À partir d’un répertoire de fichiers rédigés en Markdown, Cosma génère une collection de fiches au format HTML, rassemblées dans un fichier unique : le cosmoscope. Ce cosmoscope de démonstration a été exporté avec Cosma. <a href="https://cosma.graphlab.fr/docs/">La documentation complète est en ligne.</a></p>
                    
                    
                    <hr>
                

                
                <div class="logo" title="Logo de Cosma">
                    <?xml version="1.0" encoding="UTF-8"?>
<svg enable-background="new 0 0 283.46 68" version="1.1" viewBox="0 0 283.46 68" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">
<style type="text/css">
	.st0{fill:#147899;}
	.st1{fill:#02385C;}
	.st2{fill:#001A37;}
</style>
	<path class="st0" d="m227.63 41.56v0.68-0.35-0.33m-15.62-15.3c-6.32 0-12.02 3.81-14.44 9.65s-1.08 12.56 3.39 17.03c2.99 2.99 6.98 4.58 11.05 4.58 2.01 0 4.04-0.39 5.98-1.19 0.26-0.11 0.52-0.22 0.77-0.34v-12.1c-0.86 2.91-3.56 5.03-6.75 5.03-2.85 0-5.41-1.71-6.5-4.34s-0.49-5.66 1.53-7.67c1.35-1.35 3.15-2.06 4.98-2.06 0.91 0 1.82 0.18 2.69 0.54 1.99 0.83 3.46 2.5 4.05 4.5v-12.09c-2.05-0.98-4.33-1.53-6.75-1.54"/>
	<path class="st0" d="m67.32 26.18c-4 0-8 1.53-11.05 4.58-6.1 6.1-6.1 16 0 22.1 3.05 3.05 7.05 4.58 11.05 4.58s8-1.53 11.05-4.58l-6.07-6.07c-1.31 1.32-3.1 2.06-4.96 2.06h-0.02c-3.19 0-5.97-2.14-6.8-5.22-0.82-3.08 0.52-6.32 3.28-7.92 1.1-0.63 2.31-0.94 3.52-0.94 1.82 0 3.62 0.71 4.98 2.06l6.07-6.07c-3.05-3.05-7.05-4.58-11.05-4.58"/>
	<path class="st0" d="m137.46 26.26h-12.18c-5.5 0-9.96 4.46-9.96 9.96s4.46 9.96 9.96 9.96h5.13c0.76 0 1.37 0.61 1.37 1.37s-0.61 1.37-1.37 1.37h-12.18v8.59h12.32c4-0.05 7.58-2.5 9.09-6.21s0.65-7.96-2.18-10.79c-1.86-1.87-4.38-2.92-7.01-2.92h-0.03-5.13c-0.76 0-1.37-0.62-1.37-1.38s0.62-1.37 1.37-1.37h12.18v-8.58"/>
	<path class="st0" d="m227.63 42.24c-0.13 5.9-3.58 11.21-8.88 13.74v1.49h8.88v-15.23m-8.87-2.36v4.01c0.19-0.64 0.29-1.31 0.29-2s-0.1-1.37-0.29-2.01m8.87-13.65h-8.88v1.57c5.15 2.48 8.74 7.69 8.88 13.76v-15.33"/>
	<path class="st1" d="m218.76 27.8v12.08c0.19 0.64 0.29 1.31 0.29 2 0 0.7-0.1 1.37-0.29 2v12.09c5.3-2.53 8.74-7.84 8.88-13.74v-0.68c-0.14-6.06-3.73-11.28-8.88-13.75"/>
	<path class="st0" d="m153.79 26.23h-8.52v31.24h8.52-8.52v-17.57-0.18c0.07-5.65 3.57-10.48 8.52-12.49v-1"/>
	<path class="st0" d="m177.75 26.23c-3.65 0-6.96 1.43-9.41 3.75 2.58 2.45 4.21 5.91 4.26 9.74v0.18c0-2.84 2.3-5.15 5.15-5.15 2.84 0 5.15 2.3 5.15 5.15v17.57h8.52v-17.57-0.18c-0.1-7.47-6.18-13.49-13.67-13.49"/>
	<path class="st0" d="m158.93 26.23c-1.82 0-3.56 0.36-5.15 1v30.24-17.57c0-2.84 2.3-5.15 5.15-5.15s5.15 2.3 5.15 5.15v-0.18c0.05-3.83 1.67-7.28 4.26-9.74-2.45-2.32-5.76-3.75-9.41-3.75"/>
	<path class="st1" d="m153.79 27.23c-4.94 2.01-8.45 6.84-8.52 12.49v0.18 17.57h8.52v-30.24"/>
	<path class="st1" d="m168.34 29.98c-2.58 2.45-4.21 5.91-4.26 9.74v0.18 17.57h8.52v-17.57-0.18c-0.05-3.83-1.68-7.28-4.26-9.74"/>
	<g id="cosma-roll">
		<path class="st0" d="m95.49 46.43-4.08 2.36v8.55h8.17v-8.55l-4.09-2.36m4.08-20.34h-8.17v8.55l4.09 2.36 4.08-2.36v-8.55"/>
		<path class="st0" d="m103.65 41.71-4.08 2.36v4.71l7.4 4.27 4.08-7.07-7.4-4.27m-19.65-11.34-4.08 7.07 7.4 4.27 4.08-2.36v-4.71l-7.4-4.27"/>
		<path class="st1" d="m99.57 44.07-4.08 2.36 4.08 2.36v-4.72m-8.17-9.43v4.71l4.09-2.35-4.09-2.36"/>
		<path class="st0" d="m87.32 41.71-7.4 4.27 4.08 7.08 7.4-4.27v-4.71l-4.08-2.37m19.65-11.34-7.4 4.27v4.71l4.08 2.36 7.4-4.27-4.08-7.07"/>
		<path class="st1" d="m91.4 44.07v4.71l4.08-2.36-4.08-2.35m8.17-9.43-4.08 2.36 4.08 2.36v-4.72"/>
		<path class="st1" d="m91.4 39.36-4.08 2.36 4.08 2.36v-4.72m8.17 0v4.71l4.08-2.36-4.08-2.35"/>
		<polyline class="st2" points="95.49 37 91.4 39.36 91.4 44.07 95.49 46.43 99.57 44.07 99.57 39.36 95.49 37"/>
	</g>
	<path class="st0" d="m50.43 16.17h-15c-0.69 0-1.25 0.56-1.25 1.25v48.56c0 0.69 0.56 1.25 1.25 1.25h15v-9.9h-5.09c-0.69 0-1.25-0.56-1.25-1.25v-28.74c0-0.69 0.56-1.25 1.25-1.25h5.09v-9.92"/>
	<path class="st0" d="m32.53 16.17h-15c-0.69 0-1.25 0.56-1.25 1.25v48.56c0 0.69 0.56 1.25 1.25 1.25h15v-9.9h-5.09c-0.69 0-1.25-0.56-1.25-1.25v-28.73c0-0.69 0.56-1.25 1.25-1.25h5.09v-9.93"/>
	<path class="st0" d="m247.89 16.17h-15v9.92h5.09c0.69 0 1.25 0.56 1.25 1.25v28.74c0 0.69-0.56 1.25-1.25 1.25h-5.09v9.9h15c0.69 0 1.25-0.56 1.25-1.25v-48.56c0.01-0.68-0.56-1.25-1.25-1.25"/>
	<path class="st0" d="m265.82 16.17h-15v9.92h5.09c0.69 0 1.25 0.56 1.25 1.25v28.74c0 0.69-0.56 1.25-1.25 1.25h-5.09v9.9h15c0.69 0 1.25-0.56 1.25-1.25v-48.55c0-0.69-0.56-1.26-1.25-1.26"/>
</svg>
                </div>
                

                <p>Version 1.0 • Licence GNU GPL 3.0</p>

                <ul>
                    <li>Arthur Perret</li>
                    <li>Guillaume Brioudes</li>
                    <li>Olivier Le Deuff</li>
                    <li>Clément Borel</li>
                    <li>Programme ANR <a href="https://hyperotlet.hypotheses.org/">HyperOtlet</a></li>
                </ul>

                <dl>
                    <dt><a href="https://d3js.org/" target="_blank">D3 <span class="badge">v4.13.0</span></a></dt>
                    <dd>Mike Bostock (BSD 3-Clause)</dd>
                    <dt><a href="https://mozilla.github.io/nunjucks/" target="_blank">Nunjucks <span class="badge">v3.2.3</span></a></dt>
                    <dd>James Long (BSD 2-Clause)</dd>
                    <dt><a href="https://github.com/nodeca/js-yaml" target="_blank">Js-yaml <span class="badge">v3.14.0</span></a></dt>
                    <dd>Vitaly Puzrin (MIT License)</dd>
                    <dt><a href="https://github.com/dworthen/js-yaml-front-matter" target="_blank">Js-yaml-front-matter <span class="badge">v4.1.0</span></a></dt>
                    <dd>Derek Worthen (MIT License)</dd>
                    <dt><a href="https://github.com/markdown-it/markdown-it" target="_blank">Markdown-it <span class="badge">v12.0.2</span></a></dt>
                    <dd>Vitaly Puzrin, Alex Kocharin (MIT License)</dd>
                    <dt><a href="https://github.com/wilsonzlin/minify-html" target="_blank">Minify-html <span class="badge">v0.4.3</span></a></dt>
                    <dd>Wilson Lin (MIT License)</dd>
                    <dt><a href="https://fusejs.io/" target="_blank">Fuse-js <span class="badge">v6.4.6</span></a></dt>
                    <dd>Kiro Risk (Apache License 2.0)</dd>
                    <dt><a href="https://momentjs.com/" target="_blank">Moment <span class="badge">v2.29.1</span></a></dt>
                    <dd>Iskren Ivov Chernev (MIT License)</dd>
                </dl>
            </main>
        </article>

        
        <article id="citation-references" class="record">
            <main>
                <h1>Données bibliographiques</h1>
    
                <p>
                    Les données ci-dessous correspondent aux références citées dans ce cosmoscope. Elles sont en Citation Style Language, exprimé en JSON. Ce format est reconnu notamment par Zotero, Mendeley et Papers. Cliquez sur le bouton ci-dessous pour télécharger les données.
                </p>
    
                <button>Télécharger</button>
    
                <code>[{&quot;id&quot;:&quot;perret2021&quot;,&quot;author&quot;:[{&quot;family&quot;:&quot;Perret&quot;,&quot;given&quot;:&quot;Arthur&quot;},{&quot;family&quot;:&quot;Brioudes&quot;,&quot;given&quot;:&quot;Guillaume&quot;},{&quot;family&quot;:&quot;Borel&quot;,&quot;given&quot;:&quot;Clément&quot;},{&quot;family&quot;:&quot;Le Deuff&quot;,&quot;given&quot;:&quot;Olivier&quot;}],&quot;DOI&quot;:&quot;10.5281/ZENODO.5412315&quot;,&quot;issued&quot;:{&quot;date-parts&quot;:[[2021,9,3]]},&quot;language&quot;:&quot;fr&quot;,&quot;publisher&quot;:&quot;Zenodo&quot;,&quot;title&quot;:&quot;Cosma&quot;,&quot;type&quot;:&quot;book&quot;,&quot;URL&quot;:&quot;https://zenodo.org/record/5412315&quot;,&quot;version&quot;:&quot;1.0&quot;,&quot;used&quot;:true}]</code>
            </main>
        </article>
        

    </main>

    

    <div class="graph-wrapper" style="background-color: #ffffff">
        <svg id="graph-canvas">
            <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="22" refY="5" markerUnits="strokeWidth" markerWidth="5" markerHeight="5" orient="auto">
                    <path d="M 0 0 L 10 5 L 0 10 z"></path>
                </marker>
                <filter id="double">
                    <feMorphology in="SourceGraphic" result="a" operator="dilate" radius="0.2"></feMorphology>
                    <feComposite in="SourceGraphic" in2="a" result="xx" operator="xor"></feComposite>
                </filter>
            </defs>
        </svg>

        <div class="graph-controls">
            <div class="graph-controls-zoom">
                <button onclick="zoomLess()">-</button>
                <button onclick="zoomReset()">Recentrer (R)</button>
                <button onclick="zoomMore()">+</button>
            </div>

            
            <div class="graph-controls-focus">
                <label>
                    <input id="focus-check" type="checkbox" name="checkbox">
                    Focus (F)
                </label>

                <input id="focus-range" type="range" min="0" max="6" value="1" name="range" step="1" />
            </div>
            
        </div>
    </div>

    

    <script>
        const data = {"nodes":[{"id":20210901134745,"label":"Citations et bibliographies","type":"documentation","size":1,"focus":[[20210901133701],[20210901133623,20210901133736,20210901133951,20210901134026,20210901134136]]},{"id":20210901145632,"label":"Configuration","type":"documentation","size":1,"focus":[[20210901131627],[20210901132906,20210901132721,20210901133503,20210901140150]]},{"id":20210901133951,"label":"Contenu des fichiers","type":"documentation","size":1,"focus":[[20210901133701],[20210901133623,20210901133736,20210901134026,20210901134136,20210901134745]]},{"id":20210901131627,"label":"Cosma","type":"documentation","size":3,"focus":[[20210901132906,20210901132721,20210901133503,20210901140150,20210901145632],[20210901133623,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901133503,"label":"Cosmographe","type":"documentation","size":2,"focus":[[20210901131627,20210901133623,20210901141048,20210901144524],[20210901132906,20210901132721,20210901140150,20210901145632,20210901133701]]},{"id":20210901140150,"label":"Cosmoscope","type":"documentation","size":6,"focus":[[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849],[20210901132906,20210901132721,20210901133503,20210901145632,20210901150958]]},{"id":20210901141048,"label":"Créer un cosmoscope","type":"documentation","size":1,"focus":[[20210901133503,20210901140150],[20210901131627,20210901133623,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901133623,"label":"Créer une fiche","type":"documentation","size":1,"focus":[[20210901133503,20210901133701],[20210901131627,20210901141048,20210901144524,20210901133736,20210901133951,20210901134026,20210901134136,20210901134745]]},{"id":20210901150958,"label":"Effet des modifications d’affichage","type":"important","size":3,"focus":[[20210901143958,20210901143134,20210901143447,20210901143845,20210901143014],[20210901140150]]},{"id":20210901142849,"label":"Fiches","type":"documentation","size":1,"focus":[[20210901140150],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014]]},{"id":20210901143845,"label":"Filtrer l’affichage par mots-clés","type":"documentation","size":2,"focus":[[20210901140150,20210901150958],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901143447,"label":"Filtrer l’affichage par types","type":"documentation","size":2,"focus":[[20210901140150,20210901150958],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901133701,"label":"Format de données","type":"documentation","size":3,"focus":[[20210901133623,20210901133736,20210901133951,20210901134026,20210901134136,20210901134745],[20210901133503]]},{"id":20210901142644,"label":"Graphe","type":"documentation","size":1,"focus":[[20210901140150],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901143014,20210901142849]]},{"id":20210901134136,"label":"Identifiants uniques","type":"documentation","size":1,"focus":[[20210901133701],[20210901133623,20210901133736,20210901133951,20210901134026,20210901134745]]},{"id":20210901143958,"label":"Index","type":"documentation","size":2,"focus":[[20210901140150,20210901150958],[20210901131627,20210901141048,20210901144524,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901132906,"label":"Installation","type":"documentation","size":1,"focus":[[20210901131627],[20210901132721,20210901133503,20210901140150,20210901145632]]},{"id":20210901134026,"label":"Liens","type":"documentation","size":1,"focus":[[20210901133701],[20210901133623,20210901133736,20210901133951,20210901134136,20210901134745]]},{"id":20210901133736,"label":"Métadonnées (fiche)","type":"documentation","size":1,"focus":[[20210901133701],[20210901133623,20210901133951,20210901134026,20210901134136,20210901134745]]},{"id":20210901143014,"label":"Mode focus","type":"documentation","size":2,"focus":[[20210901140150,20210901150958],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901142849]]},{"id":20210901143134,"label":"Moteur de recherche","type":"documentation","size":2,"focus":[[20210901140150,20210901150958],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901144524,"label":"Partager un cosmoscope","type":"documentation","size":1,"focus":[[20210901133503,20210901140150],[20210901131627,20210901133623,20210901141048,20210901143958,20210901143134,20210901143447,20210901143845,20210901144304,20210901142644,20210901143014,20210901142849]]},{"id":20210901132721,"label":"Présentation","type":"documentation","size":1,"focus":[[20210901131627],[20210901132906,20210901133503,20210901140150,20210901145632]]},{"id":20210901144304,"label":"Vues","type":"documentation","size":1,"focus":[[20210901140150],[20210901131627,20210901141048,20210901144524,20210901143958,20210901143134,20210901143447,20210901143845,20210901142644,20210901143014,20210901142849]]}],"links":[{"id":0,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901131627,"target":20210901133503},{"id":1,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901131627,"target":20210901140150},{"id":2,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901131627,"target":20210901145632},{"id":3,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133503,"target":20210901133623},{"id":4,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133503,"target":20210901141048},{"id":5,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133503,"target":20210901144524},{"id":6,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901143958},{"id":7,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901143134},{"id":8,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901143447},{"id":9,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901143845},{"id":10,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901144304},{"id":11,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901142644},{"id":12,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901143014},{"id":13,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901140150,"target":20210901142849},{"id":14,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901141048,"target":20210901140150},{"id":15,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133623,"target":20210901133701},{"id":16,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901150958,"target":20210901143958},{"id":17,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901150958,"target":20210901143134},{"id":18,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901150958,"target":20210901143447},{"id":19,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901150958,"target":20210901143845},{"id":20,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901150958,"target":20210901143014},{"id":21,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133701,"target":20210901133736},{"id":22,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133701,"target":20210901133951},{"id":23,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133701,"target":20210901134026},{"id":24,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133701,"target":20210901134136},{"id":25,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901133701,"target":20210901134745},{"id":26,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901132906,"target":20210901131627},{"id":27,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901144524,"target":20210901140150},{"id":28,"type":"undefined","shape":{"stroke":"simple","dashInterval":null},"color":"#e1e1e1","source":20210901132721,"target":20210901131627}]};
        const graphProperties = {"attraction":{"force":"600","distance_max":"800","verticale":"0","horizontale":"0"},"background_color":"#ffffff","highlight_color":"#ff6a6a","highlight_on_hover":true,"text_size":"15","arrows":true};
        const tagList = [];
    </script>

    

    <script>
        /**
 * @file Global vars about nodes, record & graph displaying. Logo animation.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

/** @namespace */
const view = {
        /**
         * List of ids from highlighted nodes
         * @type {array}
         * @default
         */
        highlightedNodes: [],
        /**
         * If the focus mode is activated
         * @type {boolean}
         * @default
         */
        focusMode: false,
        /**
         * Id from the current diplayed record
         * @type {array}
         * @default
         */
        openedRecordId: undefined,
        /**
         * Name 'data-tag' from the activated tag
         * @type {string}
         * @default
         */
        activeTag: undefined,
        /**
         * Zoom and position on the graph
         * @type {object}
         * @default
         */
        position: {x: 0, y: 0, zoom: 1}
    };

function resetView() {
    if (view.openedRecordId) { closeRecord(); }
    zoomReset();
    activeAllFilters();
    if (focus.isActive) { focus.disable(); }
    unactiveAllTags();
    displayAllFromIndex();
    unactiveLastView();
}

/**
 * Cosma logo animation onclick
 */

(function (){
    const roll = document.getElementById('cosma-roll');

    if (!roll) { return; }

    roll.parentElement.addEventListener('click', () => {
        roll.classList.add('anim');
        roll.addEventListener('animationend', () => { roll.classList.remove('anim'); })
    });
})();
        /**
 * @file History of navigation between records.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

/**
 * Navigation history entries managment
 * @namespace
*/
const historique = {
    /**
     * Add a new entry into history and change page title
     * @param {number} recordId - 
     * @param {string} recordTitle - 
     */
    actualiser: function(recordId, recordTitle) {
        // url as <filePath>/cosmoscope.html#<recordId>
        const url = new URL('#' + recordId, window.location);

        // add record to history
        if (history.state == null) {
            // if it is the first entry, we must init history
            this.init(recordId, recordTitle, url);
        }
        else {
            const timeline = history.state.hist; // past history
            timeline.push(recordId);
            history.pushState({hist : timeline}, recordTitle, url);
        }

        // change page title
        document.title = 'Cosma — ' + recordTitle;
    },
    /**
     * Add first entry into history
     * @param {number} recordId - 
     * @param {string} recordTitle - 
     * @param {string} url - File URL + #hash
     */
    init: function(recordId, recordTitle, url) {
        history.pushState({hist : [recordId]}, recordTitle, url);
    }
}

// At navigation travel, with forward/backward webbrowser's buttons
window.onpopstate = function(e) {
    if (e.state === null) { return; }
    // open record from a history entry
    const timeline = e.state.hist
        , recordId = timeline[timeline.length - 1];

    openRecord(recordId, false);
};
        /**
 * @file Generate nodes, labels & links for graph. Highlight, hide & display nodes & links. Set mouse graph events.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

(function() {

/** Data serialization
------------------------------------------------------------*/

data.nodes = data.nodes.map(function (node) {
    node.hidden = false;
    node.isolated = false;
    node.highlighted = false;
    return node;
});

/** Box sizing
------------------------------------------------------------*/

window.svg = d3.select("#graph-canvas");

let svgSize = svg.node().getBoundingClientRect();

const width = svgSize.width;
const height = svgSize.height;

svg
    .attr("viewBox", [0, 0, width, height])
    .attr("preserveAspectRatio", "xMinYMin meet");

/** Force simulation
------------------------------------------------------------*/

const simulation = d3.forceSimulation(data.nodes)
    .force("link", d3.forceLink(data.links).id(d => d.id))
    .force("charge", d3.forceManyBody())
    .force("center", d3.forceCenter())
    .force("forceX", d3.forceX())
    .force("forceY", d3.forceY());

simulation.force("center")
    .x(width * 0.5)
    .y(height * 0.5);

window.updateForces = function () {
    // get each force by name and update the properties

    simulation.force("charge")
        // turn force value to negative number
        .strength(-Math.abs(graphProperties.attraction.force))
        .distanceMax(graphProperties.attraction.distance_max);

    simulation.force("forceX")
        .strength(graphProperties.attraction.horizontale)

    simulation.force("forceY")
        .strength(graphProperties.attraction.verticale)

    // restarts the simulation
    simulation.alpha(1).restart();
}

updateForces();

simulation
    .on("tick", function() {
        elts.links
            .attr("x1", d => d.source.x)
            .attr("y1", d => d.source.y)
            .attr("x2", d => d.target.x)
            .attr("y2", d => d.target.y);

        elts.nodes.attr("transform", function(d) {
            d.x = Math.max(d.size, Math.min(width - d.size, d.x));
            d.y = Math.max(d.size, Math.min(height - d.size, d.y));
    
            return "translate(" + d.x + "," + d.y + ")";
        });

        d3.select('#load-bar-value')
            .style('flex-basis', (simulation.alpha() * 100) + '%');
    });

/** Elements
------------------------------------------------------------*/

const elts = {};

elts.links = svg.append("g")
    .selectAll("line")
    .data(data.links)
    .enter().append("line")
    .attr("class", (d) => 'l_' + d.type)
    .attr("title", (d) => d.title)
    .attr("data-source", (d) => d.source)
    .attr("data-target", (d) => d.target)
    .attr("stroke-dasharray", function(d) {
        if (d.shape.stroke === 'dash' || d.shape.stroke === 'dotted') {
            return d.shape.dashInterval }
        return false;
    })
    .attr("filter", function(d) {
        if (d.shape.stroke === 'double') {
            return 'url(#double)' }
        return false;
    });

if (graphProperties.arrows === true) {
    elts.links
        .attr("marker-end", 'url(#arrow)');
}

elts.nodes = svg.append("g")
    .selectAll("g")
    .data(data.nodes)
    .enter().append("g")
    .attr("data-node", (d) => d.id)
    .on('click', function(d) {
        openRecord(d.id);
    });

elts.circles = elts.nodes.append("circle")
    .attr("r", (d) => d.size)
    .attr("class", (d) => "n_" + d.type)
    .call(d3.drag()
        .on("start", function(d) {
            if (!d3.event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y; })
        .on("drag", function(d) {
            d.fx = d3.event.x;
            d.fy = d3.event.y; })
        .on("end", function(d) {
            if (!d3.event.active) simulation.alphaTarget(0.0001);
            d.fx = null;
            d.fy = null; })
        )
    .on('mouseenter', function(nodeMetas) {
        if (!graphProperties.highlight_on_hover) { return; }

        let nodesIdsHovered = [nodeMetas.id];

        const linksToModif = elts.links.filter(function(link) {
            if (link.source.id === nodeMetas.id || link.target.id === nodeMetas.id) {
                nodesIdsHovered.push(link.source.id, link.target.id);
                return false;
            }
            return true;
        })

        const nodesToModif = elts.nodes.filter(function(node) {
            if (nodesIdsHovered.includes(node.id)) {
                return false;
            }
            return true;
        })

        const linksHovered = elts.links.filter(function(link) {
            if (link.source.id !== nodeMetas.id && link.target.id !== nodeMetas.id) {
                return false;
            }
            return true;
        })

        const nodesHovered = elts.nodes.filter(function(node) {
            if (!nodesIdsHovered.includes(node.id)) {
                return false;
            }
            return true;
        })

        nodesHovered.classed('hover', true);
        linksHovered.classed('hover', true);
        nodesToModif.classed('translucent', true);
        linksToModif.classed('translucent', true);
    })
    .on('mouseout', function() {
        if (!graphProperties.highlight_on_hover) { return; }

        elts.nodes.classed('hover', false);
        elts.nodes.classed('translucent', false);
        elts.links.classed('hover', false);
        elts.links.classed('translucent', false);
    });

elts.labels = elts.nodes.append("text")
    .each(function(d) {
        const words = d.label.split(' ')
            , max = 25
            , text = d3.select(this);
        let label = '';

        for (let i = 0; i < words.length; i++) {
            // combine words and seperate them by a space caracter into label
            label += words[i] + ' ';

            // if label (words combination) is longer than max & not the single iteration
            if (label.length < max && i !== words.length - 1) { continue; }

            text.append("tspan")
                .attr('x', 0)
                .attr('dy', '1.2em')
                .text(label.slice(0, -1)); // remove last space caracter

            label = '';
        }
    })
    .attr('font-size', graphProperties.text_size)
    .attr('x', 0)
    .attr('y', (d) => d.size)
    .attr('dominant-baseline', 'middle')
    .attr('text-anchor', 'middle');

/** Functions
------------------------------------------------------------*/

/**
 * Get nodes and their links
 * @param {array} nodeIds - List of nodes ids
 * @returns {array} - DOM elts : nodes and their links
 */

function getNodeNetwork(nodeIds) {
    const diplayedNodes = elts.nodes
        .filter(item => item.hidden === false)
        .data()
        .map(item => item.id);

    const nodes = elts.nodes.filter(node => nodeIds.includes(node.id));

    const links = elts.links.filter(function(link) {
        if (!nodeIds.includes(link.source.id) && !nodeIds.includes(link.target.id)) {
            return false; }
        if (!diplayedNodes.includes(link.source.id) || !diplayedNodes.includes(link.target.id)) {
            return false; }

        return true;
    });

    return {
        nodes: nodes,
        links: links
    }
}

/**
 * Hide some nodes & their links, by their id
 * @param {array} nodeIds - List of nodes ids
 */

window.hideNodes = function (nodeIds) {
    let nodesToHideIds;

    nodesToHideIds = data.nodes.filter(function(item) {
        if (nodeIds.includes(item.id) && item.hidden === false) {
            return true;
        }
    });

    if (view.focusMode) {
        nodesToHideIds = nodesToHideIds.filter(function(item) {
            if (item.isolated === true) {
                return true;
            }
        })
    }

    nodesToHideIds = nodesToHideIds
        .map(node => node.id);

    hideNodeNetwork(nodesToHideIds);
    hideFromIndex(nodesToHideIds);

    elts.nodes.data(
        elts.nodes
            .data()
            .map(function(node) {
                if (nodesToHideIds.includes(node.id)) {
                    node.hidden = true; }

                return node;
            })
    );
}

/**
 * Display some nodes & their links, by their id
 * @param {array} nodeIds - List of nodes ids
 */

window.displayNodes = function (nodeIds) {
    let nodesToDisplayIds;

    nodesToDisplayIds = data.nodes.filter(function(item) {
        if (nodeIds.includes(item.id) && item.hidden === true) {
            return true;
        }
    });

    if (view.focusMode) {
        nodesToDisplayIds = nodesToDisplayIds.filter(function(item) {
            if (item.isolated === true) {
                return true;
            }
        })
    }

    nodesToDisplayIds = nodesToDisplayIds
        .map(node => node.id);

    elts.nodes.data(
        elts.nodes
            .data()
            .map(function(node) {
                if (nodesToDisplayIds.includes(node.id)) {
                    node.hidden = false; }

                return node;
            })
    );

    displayNodeNetwork(nodesToDisplayIds);
    displayFromIndex(nodesToDisplayIds);
}

/**
 * Zoom to a node from its coordinates
 * @param {number} nodeId
 */

window.zoomToNode = function (nodeId) {
    const nodeToZoomMetas = elts.nodes.filter(node => node.id === nodeId).datum()
        , zoom = 2
        , recordWidth = recordContainer.offsetWidth;

    let x = nodeToZoomMetas.x
        , y = nodeToZoomMetas.y

    // coordonates to put the node at the graph top-left corner
    x = width / 2 - zoom * x;
    y = height / 2 - zoom * y;

    // add px to put the node to the graph center
    x += (window.innerWidth - recordWidth) / 2;
    y += window.innerHeight / 2;

    view.position = {
        zoom: zoom,
        x: x,
        y: y
    };

    translate();
}

/**
 * Display none nodes and their link
 * @param {array} nodeIds - List of nodes ids
 */

window.hideNodeNetwork = function (nodeIds) {
    const ntw = getNodeNetwork(nodeIds);

    ntw.nodes.style('display', 'none');
    ntw.links.style('display', 'none');
}

/**
 * Reset display nodes and their link
 * @param {array} nodeIds - List of nodes ids
 */

window.displayNodeNetwork = function (nodeIds) {
    const ntw = getNodeNetwork(nodeIds);

    ntw.nodes.style('display', null);
    ntw.links.style('display', null);
}

/**
 * Apply highlightColor (from config) to somes nodes and their links
 * @param {array} nodeIds - List of nodes ids
 */

window.highlightNodes = function (nodeIds) {
    const ntw = getNodeNetwork(nodeIds);

    ntw.nodes.classed('highlight', true);
    ntw.links.classed('highlight', true);

    view.highlightedNodes = view.highlightedNodes.concat(nodeIds);
}

/**
 * remove highlightColor from all highlighted nodes and their links
 */

window.unlightNodes = function() {
    if (view.highlightedNodes.length === 0) { return; }

    const ntw = getNodeNetwork(view.highlightedNodes);

    ntw.nodes.classed('highlight', false);
    ntw.links.classed('highlight', false);

    view.highlightedNodes = [];
}

/**
 * Toggle display/hide nodes links
 * @param {bool} isChecked - 'checked' value send by a checkbox input
 */

window.linksDisplayToggle = function (isChecked) {
    if (isChecked) {
        elts.links.style('display', null);
    } else {
        elts.links.style('display', 'none');
    }
}

/**
 * Toggle display/hide nodes label
 * @param {bool} isChecked - 'checked' value send by a checkbox input
 */

window.labelDisplayToggle = function (isChecked) {
    if (isChecked) {
        elts.labels.style('display', null);
    } else {
        elts.labels.style('display', 'none');
    }
}

/**
 * Add 'highlight' class to texts linked to nodes ids
 * @param {array} nodeIds - List of node ids
 */

window.labelHighlight = function (nodeIds) {
    const labelsToHighlight = elts.nodes
        .filter(node => nodeIds.includes(node.id)).select('text');

    data.nodes = data.nodes.map(function(node) {
        if (nodeIds.includes(node.id)) {
            node.highlighted = true; }
        return node;
    });

    labelsToHighlight.classed('highlight', true);
}

/**
 * Change the font size of graph labels
 */

window.updateFontsize = function () {
    elts.labels.attr('font-size', graphProperties.text_size);
}

/**
 * Remove 'highlight' class from texts linked to nodes ids
 * @param {array} nodeIds - List of node ids
 */

window.labelUnlight = function (nodeIds) {
    const labelsToHighlight = elts.nodes
        .filter(node => nodeIds.includes(node.id)).select('text');

    data.nodes = data.nodes.map(function(node) {
        if (nodeIds.includes(node.id)) {
            node.highlighted = false; }
        return node;
    });

    labelsToHighlight.classed('highlight', false);
}

/**
 * Remove 'highlight' class from all texts
 */

window.labelUnlightAll = function () {
    data.nodes = data.nodes.map(function(node) {
        node.highlighted = false;
        return node;
    });

    elts.labels.classed('highlight', false);
}

})();
        /**
 * @file Controls & apply zoom from graph.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

(function () {

    const zoomInterval = 0.3 // interval between two (de)zoom
        , zoomMax = 3
        , zoomMin = 1;
    
    svg.call(d3.zoom().on('zoom', function () {
        // for each move one the SVG

        if (d3.event.sourceEvent === null) {
            zoomMore();
            return;
        }

        switch (d3.event.sourceEvent.type) {
            case 'wheel':
                // by mouse wheel
                if (d3.event.sourceEvent.deltaY >= 0) {
                    zoomLess();
                } else {
                    zoomMore();
                }
                break;

            case 'mousemove':
                // by drag and move with mouse
                view.position.x += d3.event.sourceEvent.movementX;
                view.position.y += d3.event.sourceEvent.movementY;
        
                translate();
                break;
        }
    }));

    function zoomMore() {
        view.position.zoom += zoomInterval;
    
        if (view.position.zoom >= zoomMax) {
            view.position.zoom = zoomMax; }
    
        translate();
    }
    
    function zoomLess() {
        view.position.zoom -= zoomInterval;
    
        if (view.position.zoom <= zoomMin) {
            view.position.zoom = zoomMin; }
    
        translate();
    }
    
    function zoomReset() {
        view.position.zoom = 1;
        view.position.x = 0;
        view.position.y = 0;
    
        translate();
    }
    
    // export functions on global namespace
    window.zoomMore = zoomMore;
    window.zoomLess = zoomLess;
    window.zoomReset = zoomReset;
    
})();

/**
 * Change 'style' attribute of SVG to change view
 */
    
function translate() {
    svg.attr('style', `transform:translate(${view.position.x}px, ${view.position.y}px) scale(${view.position.zoom});`);
}
        /**
 * @file Activate search engine and its keyboard shortcuts.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

let searchInput = document.querySelector('#search');

(function() {

let resultContainer = document.querySelector('#search-result-list')
    , maxResultNb = 5
    , resultList = []
    , selectedResult = 0;

searchInput.value = ''; // reset at page loading

searchInput.addEventListener('focus', () => {
    keyboardShortcutsAreWorking = false; // unactive all letters shortcuts

    // initialize search engine with no hidden nodes
    const fuse = new Fuse(data.nodes.filter(item => item.hidden === false), {
        includeScore: false,
        keys: ['label'] // search field from nodes metas
    });

    searchInput.addEventListener('input', () => {
        // reset search results for each input value modification
        resultContainer.innerHTML = ''; selectedResult = 0; resultList = [];

        if (searchInput.value === '') { return; }
        
        resultList = fuse.search(searchInput.value);

        for (let i = 0; i < maxResultNb; i++) {
            let result = resultList[i];

            if (result === undefined) { break; }
            // include search result element on DOM
            var resultElement = document.createElement('li');
            resultElement.classList.add('search-result-item');
            resultElement.innerHTML =
            `<span class="record-type-point n_${result.item.type}">⬤</span>
            <span>${result.item.label}</span>`;
            resultContainer.appendChild(resultElement);

            if (i === 0) { activeOutline(resultElement); }
        
            resultElement.addEventListener('click', () => {
                openRecord(result.item.id); });
        }
    });

    // switch between results by arrows from keyboard. key Enter to validate
    document.addEventListener('keydown', keyboardResultNavigation)
});

searchInput.addEventListener('blur', () => {
    keyboardShortcutsAreWorking = true;
})

function keyboardResultNavigation(e) {
    if (resultList.length === 0) { return; }

    switch (e.key) {
        case 'ArrowUp':
            e.preventDefault();

            if (selectedResult === 0) {
                searchInput.focus();
                return;
            }

            removeOutlineElt();
            selectedResult--;
            activeOutline();

            break;
        case 'ArrowDown':
            e.preventDefault();

            if (selectedResult === maxResultNb - 1 || selectedResult === resultList.length - 1) { return; }

            removeOutlineElt();
            selectedResult++;
            activeOutline();

            if (selectedResult === 1) {
                searchInput.blur();
            }

            break;
        case 'Enter':
            e.preventDefault();
            openRecord(resultList[selectedResult].item.id);
            searchInput.blur();
            break;
    }
}

function activeOutline() {
    resultContainer.childNodes[selectedResult]
        .classList.add('outline');
}

function removeOutlineElt() {
    resultContainer.childNodes[selectedResult]
        .classList.remove('outline');
}

})();
        /**
 * @file Select filters elts and activate them by the ids them contain.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

let filterAltMode = false;

/**
 * Toggle a filter from his checkbox
 * @param {bool} isChecked - Checkbox boolean : checked or not
 * @param {string} nodeIdsList - List of nodes id to filter, separeted by comas
 * @param {HTMLElement} input - The filter element from DOM
 * @param {bool} fromElt - If function is activeted from a 'onchange' attribute
 */

function filter(isChecked, nodeIdsList, input, fromElt = false) {

    nodeIdsList = parseIdsString(nodeIdsList);

    if (isChecked === true) {
        displayNodes(nodeIdsList);
        input.checked = true;
    } else {
        hideNodes(nodeIdsList);
        input.checked = false;
    }
    
    if (fromElt && pressedKeys.Alt) {
        if (filterAltMode && isChecked == false) {
            setFilters(getFilterNames()); // active all types
            filterAltMode = false;
            return;
        }
        setFilters([input.name]); // first time alt+click
        filterAltMode = true; // active alt+click mode
    } else {
        filterAltMode = false; // after last time alt+click
    }
}

/**
 * Activate filters by their name and if their are not already activated
 * Unactive others filters if their are not already unactivated
 * @param {array} filtersNameToActivate - List of filter names
 */

function setFilters(filtersNameToActivate) {
    let filtersNames = Array.from(document.querySelectorAll('[data-filter]'))
        .map(filter => filter.name);

    let filtersToUnactivate = filtersNames.filter(function(filterName) {
        if (filtersNameToActivate.includes(filterName)) {
            return false; }
        if (getUnactiveFilterNames().includes(filterName)) {
            return false; }

        return true;
    });

    filtersNameToActivate = filtersNameToActivate.filter(function(filterName) {
        if (getActiveFilterNames().includes(filterName)) {
            return false; }

        return true;
    });

    for (const filterName of filtersToUnactivate) {
        let filterElt = document.querySelector('[data-filter][name="' + filterName + '"]')
            , data = filterElt.dataset.filter;

        filter(false, data, filterElt);
    }

    for (const filterName of filtersNameToActivate) {
        let filterElt = document.querySelector('[data-filter][name="' + filterName + '"]')
            , data = filterElt.dataset.filter;

        filter(true, data, filterElt);
    }
}

/**
 * Get all filters name from the page
 * @returns {array} - Filter names list
 */

function getFilterNames() {
    return filterElts = Array.from(document.querySelectorAll('[data-filter]'))
        .map(filterElt => filterElt.name);
}

/**
 * Get active filters name
 * @returns {array} - Filter names list
 */

function getActiveFilterNames() {
    let filterElts = Array.from(document.querySelectorAll('[data-filter]'))
        .filter(filterElt => filterElt.checked === true)

    return filterElts.map(filterElt => filterElt.name);
}

/**
 * Get unactive filters name
 * @returns {array} - Filter names list
 */

function getUnactiveFilterNames() {
    let filterElts = Array.from(document.querySelectorAll('[data-filter]'))
        .filter(filterElt => filterElt.checked === false)

    return filterElts.map(filterElt => filterElt.name);
}

function activeAllFilters() {
    Array.from(document.querySelectorAll('[data-filter]'))
        .filter(filterElt => filterElt.checked === false)
        .forEach(filterElt => {
            filter(true, filterElt.dataset.filter, filterElt);
        });
}

/**
 * Get nodes id hidden by filters into an array
 * @returns {array} - Nodes id list
 */

function getNodesHideByFilter() {
    const unactiveFilters = Array.from(document.querySelectorAll('[data-filter]'))
        .filter(filterElt => filterElt.checked === false);

    return filtersIds = unactiveFilters
        .map(filterElt => parseIdsString(filterElt.dataset.filter)).flat();
}

/**
 * Get nodes id list (array of numbers) from a string
 * @returns {array} - Ids array
 */

function parseIdsString(idsString) {
    return idsString.split(',').map(id => Number(id));
}
        /**
 * @file Activate/disable focus on a node and focus controls.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

/**
 * Display some nodes, hide all others
 * Turn on the 'focusMode'
 * @param {string} nodeIdsList - List of ids from nodes to keep displayed
 */

function nodeFocus(nodeIdsList) {
    view.focusMode = false; // for reset display

    let idsToHide = [];

    data.nodes = data.nodes.map(function(item) {
        if (nodeIdsList.includes(item.id)) {
            // if item comes from the nodeIdsList
            item.isolated = true;
        } else {
            item.isolated = false;
            idsToHide.push(item.id);
        }
        return item;
    });

    // display nodeIds if their are not filtered
    const filteredNodes = getNodesHideByFilter();
    let idsToDisplay = nodeIdsList
        .filter(id => !filteredNodes.includes(id));

    hideNodes(idsToHide);
    view.focusMode = true;
    displayNodes(idsToDisplay);
}

/** @namespace */

const focus = {
    checkbox: document.getElementById('focus-check'),
    range: document.getElementById('focus-range'),
    isActive: false,
    focusedNodeId: undefined,
    focusedNode: undefined,
    levels: [],

    /**
     * Get focus levels from the active record and lauche first one
     * @param {string | number} focusedNodeId - Id of the current activated record
     */
    init : function(focusedNodeId = view.openedRecordId) {
        if (!this.checkbox) { return; }
        if (focusedNodeId === undefined) { this.hide(); return; }

        this.focusedNodeId = Number(focusedNodeId);
        zoomToNode(this.focusedNodeId);

        // get infos about the focused node
        this.focusedNode = document.querySelector('[data-node="' + this.focusedNodeId + '"]');
        this.focusedNode.classList.add('focus');
        highlightNodes([focusedNodeId]);
        // get focus levels and limit it
        this.levels = data.nodes.find(i => i.id === this.focusedNodeId).focus;
        this.range.setAttribute('max', this.levels.length)
        // launch use
        this.display();
        this.range.focus(); // to control range with keyboard arrows
        this.set(1);
    },

    /**
     * Reset and display and active focus inputs
     */
    display: function() {
        this.checkbox.checked = true;
        this.range.classList.add('active');
        this.range.value = 1;
    },

    /**
     * Reset and hide focus inputs
     */
    hide : function() {
        this.checkbox.checked = false;
        this.range.classList.remove('active');
        this.range.value = 1;
    },

    /**
     * Lauch a focus level
     * @param {number} level - Level number
     */
    set: function(level) {
        this.isActive = true;

        // cut the levels array to keep the targeted level and others before
        level = this.levels.slice(0, level);
        level.push([this.focusedNodeId]); // add the node id as a level
        level = level.flat(); // merge all levels as one focus

        nodeFocus(level);
    },

    /**
     * Unset focus parameters and focus
     * @param {number} level - Level number
     */
    disable : function() {
        if (this.isActive === false) { return; }

        // throw infos about the focus
        this.isActive = false;
        this.focusedNode.classList.remove('focus');
        this.focusedNode = undefined;
        this.focusedNodeId = undefined;
        this.levels = [];

        this.hide();
        resetFocus();
    }
}

if (focus.checkbox) {
    focus.checkbox.addEventListener('change', () => {
        if (focus.checkbox.checked == true) {
            focus.init();
        } else {
            focus.disable();
        }
    });

    focus.range.addEventListener('change', () => {
        if (focus.range.value <= 1) {
            focus.range.value = 1; }
    
        focus.set(focus.range.value);
    });
}


/**
 * Display nodes hidden by nodeFocus(),
 * if their are not filtered
 */

function resetFocus() {
    view.focus = undefined;

    const filteredNodes = getNodesHideByFilter();

    const idsToDisplay = data.nodes
        .filter(item => item.isolated === false && !filteredNodes.includes(item.id))
        .map(item => item.id);

    data.nodes = data.nodes.map(function(item) {
        item.isolated = false;
        return item;
    });

    view.focusMode = false;
    displayNodes(idsToDisplay);
}
        /**
 * @file Activate/disable tag buttons.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

const primTagsContainer = document.querySelector('.menu-tags-container-prim');

/**
 * Update the index with clicked tags
 * @param {HTMLElement} tagElt - Clicked tag button
 */

function tag(tagElt) {
    const isActive = tagElt.dataset.active
        // tag brothers from sort div's
        , tagBtns = document.querySelectorAll('[data-tag="' + tagElt.dataset.tag + '"]');

    if (isActive === 'true') {
        tagBtns.forEach(tagBtn => { tagBtn.dataset.active = false; });
    } else {
        tagBtns.forEach(tagBtn => { tagBtn.dataset.active = true; });
    }

    const activeTags = Array.from(primTagsContainer.querySelectorAll('[data-tag][data-active="true"]'));
    let nodeIds = activeTags.map(function(activeTagBtn) {
        return tagList[activeTagBtn.dataset.tag - 1].nodes; // 'tagList' is global var, set from template.njk
    }).flat();

    // delete duplicated elements
    nodeIds = nodeIds.filter((item, index) => { return nodeIds.indexOf(item) === index });

    labelUnlightAll();
    if (nodeIds.length !== 0) { hideAllFromIndex(); }
    else { displayAllFromIndex(); }
    labelHighlight(nodeIds); displayFromIndex(nodeIds);
    
    setCounter(counters.tag, activeTags.length);
}

/**
 * Unactive all tags buttons
 */

function unactiveAllTags() {
    const activeTags = Array.from(primTagsContainer.querySelectorAll('[data-tag][data-active="true"]'));
    activeTags.forEach(tagBtn => { tagBtn.dataset.active = false; });

    labelUnlightAll();

    setCounter(counters.tag, 0);
}
        /**
 * @file Display/hide elts from the index of all records.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

const indexContainer = document.getElementById('index');

/**
 * Switch between two lists from 'data-sort' containers
 * Two lists : increasing and decreasing
 */

(function () {
    const sortContainer = document.querySelectorAll('[data-sort]');
    for (const container of sortContainer) {
        const box = container.querySelectorAll('.sort-box')
            , increasing = box[0]
            , decreasing = box[1]
            , btn = container.querySelector('.sort-btn');

        let isIncreasing = true;

        btn.addEventListener('click', () => {
            if (isIncreasing) {
                btn.textContent = 'Z-A';
                increasing.classList.remove('active'); decreasing.classList.add('active');
                isIncreasing = false;
            } else {
                btn.textContent = 'A-Z';
                increasing.classList.add('active'); decreasing.classList.remove('active');
                isIncreasing = true;
            }
        });
    }
})();

/**
 * Hide items from the index list that correspond to the nodes ids
 * @param {array} nodeIds - List of nodes ids
 */

function hideFromIndex(nodesIds) {
    for (const indexItem of nodesIds) {
        const indexItems = indexContainer.querySelectorAll('[data-index="' + indexItem + '"]')
        indexItems.forEach(elt => {
            elt.style.display = 'none';
        });
    }

    iterateCounter(counters.index, -Math.abs(nodesIds.length));
}

/**
 * Hide all items from the index list
 */

function hideAllFromIndex() {
    indexContainer.querySelectorAll('[data-index]')
        .forEach(elt => {
            elt.style.display = 'none';
        });

    setCounter(counters.index, 0);
}

/**
 * Display items from the index list that correspond to the nodes ids
 * @param {array} nodeIds - List of nodes ids
 */

function displayFromIndex(nodesIds) {

    nodesIds = nodesIds.filter(function(nodeId) {
        // hidden nodes can not be displayed
        const nodeIsHidden = data.nodes.find(i => i.id === nodeId).hidden;
        if (nodeIsHidden === false) { return true; }
    })

    for (const indexItem of nodesIds) {
        const indexItems = indexContainer.querySelectorAll('[data-index="' + indexItem + '"]')
        indexItems.forEach(elt => {
            elt.style.display = null;
        });
    }

    iterateCounter(counters.index, nodesIds.length);
}

/**
 * Display all items from the index list
 */

 function displayAllFromIndex() {
    const indexItems = indexContainer.querySelectorAll('[data-index]');
    indexItems.forEach(elt => {
        elt.style.display = null;
    });
    
    setCounter(counters.index, indexItems.length / 2);
}
        /**
 * @file Open/close the records container on call and page loading.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

const recordContainer = document.getElementById('record-container');

/**
 * Open the record reading panel & show one
 * @param {array} id - Record/node id
 * @param {boolean} history - If history must be actualised, true by default
 */

function openRecord(id, history = true) {

    const recordContent = document.getElementById(id);

    if (!recordContent) { return; }

    if (view.openedRecordId !== undefined) {
        // hide last record
        document.getElementById(view.openedRecordId)
            .classList.remove('active');
    }

    // open records container
    recordContainer.classList.add('active');
    // adjust record view
    recordContainer.scrollTo({ top: 0 });

    // show record
    recordContent.classList.add('active')

    view.openedRecordId = id;
    id = Number(id);

    // reset nodes highlighting
    unlightNodes();
    highlightNodes([id]);

    if (history) {
        // page's <title> become record's name
        const recordTitle = recordContent.querySelector('h1').textContent;
        historique.actualiser(id, recordTitle);
    }

}

/**
 * Close the record reading panel & the opended one
 */

function closeRecord() {
    recordContainer.classList.remove('active');
    document.getElementById(view.openedRecordId).classList.remove('active');
    view.openedRecordId = undefined;

    unlightNodes();
}

/**
 * Open a record at page load if his id follow a '#' as '#20200801210302'
 */

window.addEventListener("DOMContentLoaded", () => {
    const hash = window.location.hash.substr(1);
    if (hash) { openRecord(hash); }
});
        /**
 * @file Manage the view saving & loading.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

/**
 * Take 'view' object values & encode them on base64
 * (no ACSII caracters are allowed)
 * @returns {string} - base64 string
 */

function registerView() {
    const activeFiltersNames = getActiveFilterNames();

    const viewObj = {
        recordId: view.openedRecordId,
        filters: ((activeFiltersNames.length === 0) ? undefined : activeFiltersNames)
    }

    if (focus.focusedNodeId) {
        viewObj.focus = {
            fromRecordId: focus.focusedNodeId,
            level: focus.range.value
        };
    }

    let key = JSON.stringify(viewObj);
    key = window.btoa(key);
    key = encodeURIComponent(key);
    return key;
}

/**
 * Copy registerView() output on clipboard
 */

function saveView() {
    const tempInput = document.createElement('input');
    document.body.appendChild(tempInput);
    tempInput.value = registerView();
    tempInput.select();
    document.execCommand('copy');
    document.body.removeChild(tempInput);
}

/**
 * Update 'view' object values from a encoded base64 string
 * @param {HTMLElement} viewBtn - The HTML button, container of the view data
 */

function changeView(viewBtn) {
    if (viewBtn.dataset.active === "true") {
        // if click on a current active view button to unactivate it
        viewBtn.dataset.active = false;
        resetView();
        return;
    }

    // if click on another view buttonto activate it
    unactiveLastView();

    viewBtn.dataset.active = true;

    let key = viewBtn.dataset.view;
    // base64 string contain an encoded image from the 'view' object
    key = decodeURIComponent(key);
    key = window.atob(key);
    key = JSON.parse(key);

    if (key.filters) {
        setFilters(key.filters); }
    
    if (key.focus) {
        // console.log(key.focus);
        openRecord(key.focus.fromRecordId, false);
        focus.init(key.focus.fromRecordId);
        focus.set(key.focus.level);

        return;
    }

    if (key.recordId) {
        openRecord(key.recordId, false); }
}

/**
 * Remove the border of the last activated view button
 * and its effect
 */

function unactiveLastView() {
    const lastBtn = document.querySelector('[data-view][data-active="true"]');

    if (!lastBtn) { return; }

    lastBtn.dataset.active = false;
    resetView();
}
        /**
 * @file Set keyboard shortcuts. Global var if keyboard shortcuts are activated and which ones.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

let keyboardShortcutsAreWorking = true;

/**
 * Keyboard shortcuts
 * @type {object}
 * @default
 */

const pressedKeys = {
    Control: false,
    Alt: false,
    Shift: false
};

document.onkeydown = (e) => {

    console.log(e.key);
 
    if (keyboardShortcutsAreWorking) {
 
        switch (e.key) {
            case 's':
                if (pressedKeys['Control'] === true) { return; }
                e.preventDefault();

                searchInput.focus();
                return;

            case 'r':
                if (pressedKeys['Control'] === true) { return; }
                e.preventDefault();

                zoomReset();

                if (pressedKeys.Alt) {
                    resetView();
                }

                return;

            case '®': // [Alt + R] on Mac OS
                if (pressedKeys['Control'] === true) { return; }
                e.preventDefault();

                resetView();

                return;

            case 'c':
                console.log(pressedKeys['Control']);
                if (pressedKeys['Control'] === true) { return; }
                e.preventDefault();

                if (view.openedRecordId !== undefined && Number(view.openedRecordId) !== NaN) {
                    zoomToNode(Number(view.openedRecordId)); }
                return;

            case 'f':
                if (pressedKeys['Control'] === true) { return; }
                e.preventDefault();

                if (focus.isActive) {
                    focus.disable();
                } else {
                    focus.init();
                }
                return;

            case ' ':
                if (pressedKeys['Control'] === true) { return; }
                e.preventDefault();

                document.querySelector('.load-bar').click();
                return;
        }
    }
 
    switch (e.key) {
        case 'Escape':
            closeRecord();
            return;

        case 'Control':
            pressedKeys[e.key] = true;
            return;

        case 'Meta':
            pressedKeys['Control'] = true;
            return;

        case 'Alt':
            pressedKeys[e.key] = true;
            return;

        case 'Shift':
            pressedKeys[e.key] = true;
            return;
    }
 };
 
window.onkeyup = function(e) {
    switch (e.key) {
        case 'Control':
            pressedKeys[e.key] = false;
            return;

        case 'Meta':
            pressedKeys['Control'] = false;
            return;

        case 'Alt':
            pressedKeys[e.key] = false;
            return;

        case 'Shift':
            pressedKeys[e.key] = false;
            return;
    }
}
        /**
 * @file Counters elts and functions to change values.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

const counters = {
    index: document.getElementById('index-counter'),
    tag: document.getElementById('tag-counter')
}

/**
 * Change counter display
 * @param {HTMLElement} counterElt - Elt with the original number
 * @param {number} value - Number neg. or pos. addition to original number to get the new count
 * @return {boolean} True if the counter number is max
 */

function iterateCounter(counterElt, value) {
    let counterNumber = counterElt.textContent.split('/', 2);

    if (counterNumber.length === 1) { // if there is NOT a '/' into counter text content
        counterElt.textContent = (Number(counterNumber[0]) + value) + '/' + counterNumber[0];
        return false;
    }

    if (Number(counterNumber[0]) + value === Number(counterNumber[1])) {
        counterElt.textContent = counterNumber[1];
        return true;
    }

    counterElt.textContent = (Number(counterNumber[0]) + value) + '/' + counterNumber[1]
    return false;
}

function setCounter(counterElt, value) {
    let counterNumber = counterElt.textContent.split('/', 2);

    if (counterNumber.length === 1) { // if there is NOT a '/' into counter text content
        counterElt.textContent = value + '/' + counterNumber[0];
        return false;
    }

    counterElt.textContent = value + '/' + counterNumber[1]
    return false;
}

/**
 * For each types in list, find the counter and addition his value
 * @param {object} types - List of types to change with the value to add
 */

 function setTypesCounter(types) {
    for (const typeName in types) {
        const number = types[typeName];
        const filterLabel = document.querySelector('[data-filter][name="' + typeName +'"]').parentElement;
        iterateCounter(filterLabel.querySelector('.badge'), number);
    }
}

        
            /**
 * @file Download data from the cosmoscope.
 * @author Guillaume Brioudes
 * @copyright MIT License ANR HyperOtlet
 */

/**
 * Download data of the bibliography
 */

(function() {
    const bibliographyContainer = document.getElementById('citation-references')
        , btn = bibliographyContainer.querySelector('button')
        , code = bibliographyContainer.querySelector('code');

    btn.addEventListener('click', () => {
        const virtualLink = document.createElement('a');
        virtualLink.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(code.textContent));
        virtualLink.setAttribute('download', 'bibliography.json');
        virtualLink.style.display = 'none';
        document.body.appendChild(virtualLink);
    
        virtualLink.click();
        virtualLink.remove();
    });

})();
        
    </script>
</body>

</html>